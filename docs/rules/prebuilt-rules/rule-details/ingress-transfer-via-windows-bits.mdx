---
id: enSecurityIngressTransferViaWindowsBits
slug: /en/security/ingress-transfer-via-windows-bits
title: Ingress Transfer via Windows BITS
description: Description to be written
tags: []
---

<div id="ingress-transfer-via-windows-bits"></div>

Identifies downloads of executable and archive files via the Windows Background Intelligent Transfer Service (BITS). Adversaries could leverage Windows BITS transfer jobs to download remote payloads.

**Rule type**: eql

**Rule indices**: 

* logs-endpoint.events.*

**Severity**: low

**Risk score**: 21

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="enSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://attack.mitre.org/techniques/T1197/

**Tags**: 

* Domain: Endpoint
* OS: Windows
* Use Case: Threat Detection
* Tactic: Defense Evasion
* Tactic: Command and Control

**Version**: 3

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
file where host.os.type == "windows" and event.action == "rename" and

process.name : "svchost.exe" and file.Ext.original.name : "BIT*.tmp" and 
 (file.extension :("exe", "zip", "rar", "bat", "dll", "ps1", "vbs", "wsh", "js", "vbe", "pif", "scr", "cmd", "cpl") or file.Ext.header_bytes : "4d5a*") and 
 
 /* noisy paths, for hunting purposes you can use the same query without the following exclusions */
 not file.path : ("?:\\Program Files\\*", "?:\\Program Files (x86)\\*", "?:\\Windows\\*", "?:\\ProgramData\\*\\*") and 
 
 /* lot of third party SW use BITS to download executables with a long file name */
 not length(file.name) > 30

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Command and Control
    * ID: TA0011
    * Reference URL: https://attack.mitre.org/tactics/TA0011/
* Technique:
    * Name: Ingress Tool Transfer
    * ID: T1105
    * Reference URL: https://attack.mitre.org/techniques/T1105/
* Tactic:
    * Name: Defense Evasion
    * ID: TA0005
    * Reference URL: https://attack.mitre.org/tactics/TA0005/
* Technique:
    * Name: BITS Jobs
    * ID: T1197
    * Reference URL: https://attack.mitre.org/techniques/T1197/

