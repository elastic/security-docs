---
id: serverlessSecurityPotentialPrivilegeEscalationViaSudoersFileModification
slug: /serverless/security/potential-privilege-escalation-via-sudoers-file-modification
title: Potential Privilege Escalation via Sudoers File Modification
description: Description to be written
tags: []
---

<div id="potential-privilege-escalation-via-sudoers-file-modification"></div>

A sudoers file specifies the commands users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.

**Rule type**: query

**Rule indices**: 

* auditbeat-*
* logs-endpoint.events.*

**Severity**: high

**Risk score**: 73

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="serverlessSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: None

**Tags**: 

* Domain: Endpoint
* OS: Linux
* OS: macOS
* Use Case: Threat Detection
* Tactic: Privilege Escalation

**Version**: 102

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
event.category:process and event.type:start and process.args:(echo and *NOPASSWD*ALL*)

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Privilege Escalation
    * ID: TA0004
    * Reference URL: https://attack.mitre.org/tactics/TA0004/
* Technique:
    * Name: Abuse Elevation Control Mechanism
    * ID: T1548
    * Reference URL: https://attack.mitre.org/techniques/T1548/
* Sub-technique:
    * Name: Sudo and Sudo Caching
    * ID: T1548.003
    * Reference URL: https://attack.mitre.org/techniques/T1548/003/

