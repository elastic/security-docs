[[sensor-full-disk-access]]
= Enable full disk access

Elastic Endpoint Security requires full disk access to protect you from malware and other cybersecurity threats. Full Disk Access permissions is a new privacy feature introduced in macOS Mojave (10.14) that prevents some applications from accessing your data. This means you need to manually grant permission for Elastic Endpoint Security to access these protected areas of your Mac.

This article describes how to enable full disk access for the required security system extensions, the Elastic Endpoint sensor, and the legacy Endgame sensor.


== System extensions
In order to fully protect endpoints from malware and other cybersecurity threats when using Elastic Endpoint with system extensions, Full Disk Access must be enabled for the system extension during installation time on macOS Catalina (10.15) and above. During <install-endpoint,installation>>, you'll be prompted to enable Full Disk Access for the system extension. 

--
image::images/system-extension-prompt.png[System Extension Prompt]
--

If you select **Ok** and continue installation, you'll still need to enable Full Disk Access for the system extension.

1. Open the **System Preferences** application.
+
2. Click **Security and Privacy**. On the Security and Privacy panel, select the **Privacy** tab. 
+
3. In the left pane, select **Full Disk Access**.
+
--
image::images/select-fda.png[Select Full Disk Access]
--
+
4. In the lower-left corner of the panel, click the **Lock button** and enter your username and password. 
+
5. Click the + button to view Finder. Find the system extension `com.endgame.systemextension` and select the system extension.

The system extension now has full disk access. However, for both the {agent} and Elastic Endgame sector to detect events from a macOS host, you must enable full disk access for the file most relevant to your security set up.

== Elastic Endpoint and Endgame sensor

The `elastic-endpoint` files appear after you've downloaded and installed the {agent} with <<install-endpoint,Endpoint Security Integration>>. Similarly, the `esensor` file for Elastic Endgame appears once you've downloaded the sensor on your host. 


1. Open the **System Preferences** application.
+
2. Click **Security and Privacy**. On the Security and Privacy panel, select the **Privacy** tab.
+
3. In the left pane, select **Full Disk Access**. Find the system extension `com.endgame.systemextension` 
+
--
image::images/select-fda.png[Select Full Disk Access]
--
+
4. In the lower-left corner of the panel, click the **Lock button** and enter your username and password. You can now add the `elastic-endpoint` or `esensor` file.

5. Click the + button to view Finder. Select the file that pertains most to your Endpoint configuration: 
+
- Endpoint Security: Navigate to `/Library/Elastic/Endpoint/` and select the `elastic-endpoint` file.
+
- Elastic Endgame: Navigate to `/Library/Endgame` and select the `esensor` file.

6. After you've selected the applicable file, click **Open**. 

7. In the **Privacy** tab, confirm that the `elastic-agent` or `esensor` file appears in the list of applications that have full access permission.


Elastic Endpoint now has the access required to fully protect your system.

