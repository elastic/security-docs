[[sensor-full-disk-access]]
= Enable full disk access

Elastic Endpoint Security requires full disk access to protect you from malware and other cybersecurity threats. Full Disk Access permissions is a new privacy feature introduced in macOS Mojave (10.14) that prevents some applications from accessing your data. This means you need to manually grant permission for Elastic Endpoint Security to access these protected areas of your Mac.

This article describes how to enable full disk access for the required Security system extensions, the Elastic Agent, required in order to enable Elastic Endpoint Security, and the legacy Endgame sensor.


== System extensions
In order to fully protect endpoints from malware and other cybersecurity threats when using Elastic Endpoint Security with system extensions, Full Disk Access must be enabled for the system extension during installation time on macOS Catalina (10.15) and above. During <install-endpoint,installation>>, you'll be prompted to enable Full Disk Access for the system extension. 

```
=========================================================
Please enable Full Disk Access for com.endgame.systemextension.

For Catalina (10.15) and Big Sur (11.0), you may need to check System Preferences -> Security & Privacy -> Full Disk Access to enable Full Disk Access for com.endgame.systemextension.

```

To enable Full Disk Access for system extensions:

1. Open the **System Preferences** application.
+
2. Click **Security and Privacy**. On the Security and Privacy panel, select the **Privacy** tab. 
+
3. In the left pane, select **Full Disk Access**.
+
--
image::images/select-fda.png[Select Full Disk Access]
--
+
4. In the lower-left corner of the panel, click the **Lock button** and enter your username and password. 
+
5. Click the + button to view Finder. Find the system extension `com.endgame.systemextension` and select the system extension.

The system extension now has Full Disk Access. Installation of Elastic Endpoint Security can continue. 

== Elastic Endpoint and Endgame sensor

The `elastic-endpoint` files appear after you've downloaded either the {agent} with <<install-endpoint,Endpoint Security Integration>>. Similarly, the `esensor` file foor Elastic Endgame appears once you've downloaded the sensor on your host. In order for either application to send data to Elastic Security from a macOS host, you must enable Full Disk Access for the file most relevant to your security set up.


1. Open the **System Preferences** application.
+
2. Click **Security and Privacy**. On the Security and Privacy panel, select the **Privacy** tab.
+
3. In the left pane, select **Full Disk Access**. Find the system extension `com.endgame.systemextension` 
+
--
image::images/select-fda.png[Select Full Disk Access]
--
+
4. In the lower-left corner of the panel, click the **Lock button** and enter your username and password. You can now add the `elastic-endpoint` or `esensor` file.

5. Click the + button to view Finder. Select the file that pertains most to your Endpoint configuration: 
+
- Endpoint Security: Navigate to `/Library/Elastic/Endpoint/` and select the `elastic-endpoint` file.
+
- Elastic Endgame: Navigate to `/Library/Endgame` and select the `esensor` file.

6. After you've selected the applicable file, click **Open**. This gives Elastic Security full disk access. 

7. In the **Privacy** tab, confirm that the `elastic-agent` or `esensor` file appears in the list of applications that have full access permission.


Elastic Endpoint Security now has the access required to fully protect your system.

