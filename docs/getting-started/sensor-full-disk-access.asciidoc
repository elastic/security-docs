[[sensor-full-disk-access]]
= Enable full disk access

Elastic Endpoint Security requires full disk access to protect you from malware and other cybersecurity threats. Full Disk Access permissions is a new privacy feature introduced in macOS Mojave (10.14) that prevents some applications from accessing your data. This means you need to manually grant permission for Elastic Endpoint Security to access these protected areas of your Mac.

This article describes how to enable full disk access for the required security system extensions, the Elastic Endpoint sensor, and the legacy Endgame sensor.

[discrete]
[[macos-permissions]]
== macOS permissions

The behavior of the Endgame Sensor and Elastic Endpoint differs based on your macOS version. MDM/JAMF users can pre-approve all full disk access without granting permission to the sensors. However, non-MDM/JAMF users will be prompted or not prompted to enable full disk access for required security files depending on the macOS version and sensor type:

**Endgame Sensor**

- `10.13, 10.14, 10.15`: Users cannot proceed with installation without first granting the sensor the ability to load a <<enable-kernel-extension,kernel extension>>. During installation, you will be prompted to go to **System preferences** and approve loading the kernel. Upon approval, installation proceeds. 

- `11.0` (Big Sur): Users cannot proceed with installation without first granting the sensor the ability to load <<system-extension>>. During installation, you will be prompted to go to **System preferences** and approve loading the system extension. Upon approval, a second prompt appears to enable **Network Filtering**. Approve this final prompt for installation to proceed.
+
You also must grant full disk access to `com.endgame.systemextension`

- `10.14.6+, 10.15, 11.0`: Grant the <<endpoint-endgame-sensor,esensor>> full disk access.


**Elastic Endpoint**

No prompts to approve the <<enable-kernel-extension,kernel extension>>, <<system-extension>>, or the <<endpoint-endgame-sensor,elastic-endgame>>, due to installation happening through the {agent}. After installation, Endpoint policies **will fail** to detect events until you approve and enable kernel or system extension loading and full disk access for each version, as reflected in the **Administration > Endpoints** page of the security application.

- `10.13, 10.14, 10.15`: <<enable-kernel-extension,kernel extension>>.

- `11.0` (Big Sur): <<system-extension>>, as well as `co.elastic.systemextension`.

- - `10.14.6+, 10.15, 11.0`: <<endpoint-endgame-sensor,elastic-endgame>>

[discrete]
[[system-extension]]
== System extension

To fully protect endpoints from malware and other cybersecurity threats when using Elastic Endpoint with system extensions, full-disk access must be enabled for the system extension during <<install-endpoint,installation>> on macOS Big Sur (11.0) and later.  

--
image::images/system-extension-prompt.png[System Extension Prompt]
--

If you select **Ok** and continue installation, you'll still need to enable Full Disk Access for the system extension.

1. Open the **System Preferences** application.
+
2. Click **Security and Privacy**. On the Security and Privacy panel, select the **Privacy** tab. 
+
3. In the left pane, select **Full Disk Access**.
+
--
image::images/select-fda.png[Select Full Disk Access]
--
+
4. In the lower-left corner of the panel, click the **Lock button** and enter your username and password. 
+
5. Click the + button to view Finder. Find the system extension `com.endgame.systemextension` (Endgame Sensor) or `co.elastic.systemextension` and select. 

The system extension now has full disk access. However, for both the {agent} and Elastic Endgame sector to detect events from a macOS host, you must enable full disk access for the file most relevant to your security set up.

[discrete]
[[endpoint-endgame-sensor]]
== Elastic Endpoint and Endgame sensor

The `elastic-endpoint` files appear after you've downloaded and installed the {agent} with <<install-endpoint,Endpoint Security Integration>>. Similarly, the `esensor` file for Elastic Endgame appears once you've downloaded the sensor on your host. 


1. Open the **System Preferences** application.
+
2. Click **Security and Privacy**. On the Security and Privacy panel, select the **Privacy** tab.
+
3. In the left pane, select **Full Disk Access**. 
+
--
image::images/select-fda.png[Select Full Disk Access]
--
+
4. In the lower-left corner of the panel, click the **Lock button** and enter your username and password. You can now add the `elastic-endpoint` or `esensor` file.

5. Click the + button to view Finder. Select the file that pertains most to your Endpoint configuration: 
+
- Endpoint Security: Navigate to `/Library/Elastic/Endpoint/` and select the `elastic-endpoint` file.
+
- Elastic Endgame: Navigate to `/Library/Endgame` and select the `esensor` file.

6. After you've selected the applicable file, click **Open**. 

7. In the **Privacy** tab, confirm that the `elastic-agent` or `esensor` file appears in the list of applications that have full access permission.


Elastic Endpoint now has the access required to protect your system thoroughly.
