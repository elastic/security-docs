[[agent-tamper-protection]]
= Prevent {agent} uninstallation

For hosts enrolled in {elastic-defend}, you can prevent unauthorized attempts to uninstall {agent} and {elastic-endpoint} by enabling *Agent tamper protection* on the Agent policy. This offers an additional layer of security by preventing users from bypassing or disabling {elastic-defend}'s endpoint protections. 

When enabled, {agent} and {elastic-endpoint} can only be uninstalled on the host by including an uninstall token in the uninstall CLI command. One unique uninstall token is generated per Agent policy, and you can retrieve uninstall tokens in an Agent policy's settings or in the {fleet} UI.

.Requirements
[sidebar]
--
* Agent tamper protection requires a https://www.elastic.co/pricing[Platinum or higher subscription]. 

* Hosts must be enrolled in the {elastic-defend} integration.

* {agent}s must be version 8.11.0 or later.

* This feature is supported for all operating systems.
--

[role="screenshot"]
image::images/agent-tamper-protection.png[Agent tamper protection setting highlighted on Agent policy settings page]

[discrete]
[[enable-agent-tamper-protection]]
== Enable Agent tamper protection

You can enable Agent tamper protection by configuring the {agent} policy.

. Go to *{fleet}* -> *Agent policies*, then select the Agent policy you want to configure.
. Select the *Settings* tab on the policy details page.
. In the *Agent tamper protection* section, turn on the *Prevent agent tampering* setting.
+
This makes the *Get uninstall command* link available, which you can follow to get the uninstall token and CLI command if you need to <<uninstall-agent,uninstall an Agent>> on this policy.
+
TIP: You can also access an Agent policy's uninstall tokens on the *Uninstall tokens* tab on the *{fleet}* page. Refer to <<fleet-uninstall-tokens>> for more information.
. Select *Save changes*.

[discrete]
[[fleet-uninstall-tokens]]
== Access uninstall tokens

If you need the uninstall token to remove {agent} from an endpoint, you can find it in several ways:

* *On the Agent policy* — Go to the Agent policy's *Settings* tab, then click the *Get uninstall command* link. The *Uninstall agent* flyout opens, containing the full uninstall command with the token.

* *On the {fleet} page* — Go to *{fleet}* -> *Uninstall tokens* for a list of the uninstall tokens generated for your Agent policies. You can:

** Click the *Show token* icon in the *Token* column to reveal a specific token.
** Click the *View uninstall command* icon in the *Actions* column to open the *Uninstall agent* flyout, containing the full uninstall command with the token.
