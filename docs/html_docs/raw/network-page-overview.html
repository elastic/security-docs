<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Network page overview | Elastic Security Solution | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution"/>
<link rel="up" href="es-ui-overview.html" title="Elastic Security UI"/>
<link rel="prev" href="es-ui-overview.html" title="Elastic Security UI"/>
<link rel="next" href="sensor-full-disk-access.html" title="Enable full disk access"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution</a></span>
»
<span class="breadcrumb-link"><a href="getting-started.html">Get started with Elastic Security</a></span>
»
<span class="breadcrumb-link"><a href="es-ui-overview.html">Elastic Security UI</a></span>
»
<span class="breadcrumb-node">Network page overview</span>
</div>
<div class="navheader">
<span class="prev">
<a href="es-ui-overview.html">« Elastic Security UI</a>
</span>
<span class="next">
<a href="sensor-full-disk-access.html">Enable full disk access »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="network-page-overview"></a>Network page overview<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/getting-started/network-page-overview.asciidoc">edit</a></h2>
</div></div></div>
<p>The Network view provides key network activity metrics via an interactive map and provides network event tables that enable interaction with the Timeline. You can drag and drop items of interest from the Network view to Timeline for further investigation.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/network-ui.png" alt="network ui">
</div>
</div>
<p>Interactive widgets let you drill down for deeper insights:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Network events
</li>
<li class="listitem">
DNS queries
</li>
<li class="listitem">
Unique flow IDs
</li>
<li class="listitem">
TLS handshakes
</li>
<li class="listitem">
Unique private IPs
</li>
</ul>
</div>
<p>There are also tabs for viewing and investigating specific types of data:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Flows: source and destination IP addresses and countries
</li>
<li class="listitem">
DNS: DNS network queries
</li>
<li class="listitem">
HTTP: received HTTP requests (HTTP requests for applications using
<a href="https://www.elastic.co/guide/en/kibana/7.9/apm-getting-started.html" class="ulink" target="_top">Elastic APM</a> are monitored by default)
</li>
<li class="listitem">
TLS: handshake details
</li>
<li class="listitem">
Anomalies: anomalies discovered by <a class="xref" href="machine-learning.html" title="Anomaly Detection with Machine Learning">machine learning jobs</a>
</li>
<li class="listitem">
<a class="xref" href="detection-engine-overview.html#det-engine-terminology" title="Terminology">External alerts</a>: alerts received from
external monitoring tools, such as Suricata
</li>
</ul>
</div>
<p><span class="strong strong"><strong>IP detail</strong></span> pages show information for the selected IP address, including links to external sites for verifying the IP address&#8217;s reputation. By default,
the external sites are <a href="https://talosintelligence.com/" class="ulink" target="_top">TALOS</a> and <a href="https://www.virustotal.com/" class="ulink" target="_top">VIRUSTOTAL</a>. You can change the displayed
reputation links in <span class="strong strong"><strong>Kibana</strong></span> &#8594; <span class="strong strong"><strong>Management</strong></span> &#8594; <span class="strong strong"><strong>Advanced Settings</strong></span> &#8594;
<span class="strong strong"><strong><code class="literal">siem:ipReputationLinks</code></strong></span>. The <code class="literal">siem:ipReputationLinks</code> setting contains a
JSON array with these fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">name</code>: UI display name.
</li>
<li class="listitem">
<code class="literal">url_template</code>: URL of the link. It can include <code class="literal">{{ip}}</code>, which is placeholder for the IP address you are viewing on the details page.
</li>
</ul>
</div>
<p>For example:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  { "name": "virustotal.com", "url_template": "https://www.virustotal.com/gui/search/{{ip}}" },
  { "name": "dnschecker.org", "url_template": "https://www.dnschecker.org/ip-location.php?ip={{ip}}" },
  { "name": "talosIntelligence.com", "url_template": "https://talosintelligence.com/reputation_center/lookup?search={{ip}}" }
]</pre>
</div>
<h4><a id="map-ui"></a>Map<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/getting-started/network-page-overview.asciidoc">edit</a></h4>
<p>The map provides a visual overview of your network traffic. It is interactive, so you can start exploring data directly from the map. Hover over source and destination points to see more information, such as hostnames and IP addresses.
To drill down, click a point and use the filter icon to add a field to the filter bar or drag a field to the Timeline. You can also click a hostname to jump to the Hosts page, or an IP address to open the relevant network details.</p>
<p>Just as you can start an investigation using the map, the map refreshes to show relevant data when you run a query or update the time frame.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To add and remove layers, click on the more options icon in the top right
corner of the map.</p>
</div>
</div>
<p>Continue reading to see how to add map data and set up interactions.</p>
<h5><a id="conf-map-ui"></a>Configuring map data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/getting-started/network-page-overview.asciidoc">edit</a></h5>
<p>Depending on your Kibana setup, to display and interact with data on the map you
might need to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="network-page-overview.html#kibana-index-pattern" title="Create Kibana index patterns">Create Kibana index patterns</a>
</li>
<li class="listitem">
<a class="xref" href="network-page-overview.html#geoip-data" title="Add geoIP data">Add geographical IP data to events</a>
</li>
<li class="listitem">
<a class="xref" href="network-page-overview.html#private-network" title="Map your internal network">Map your internal network</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To see source and destination connections lines on the map, you must
configure <code class="literal">source.geo</code> and <code class="literal">destination.geo</code> ECS fields for your indices.</p>
</div>
</div>
<h5><a id="kibana-index-pattern"></a>Create Kibana index patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/getting-started/network-page-overview.asciidoc">edit</a></h5>
<p>To display map data, you must define Kibana
<a href="https://www.elastic.co/guide/en/kibana/7.9/tutorial-define-index.html" class="ulink" target="_top">index patterns</a> (<span class="strong strong"><strong>Management</strong></span> &#8594;
<span class="strong strong"><strong>Index Patterns</strong></span>) that match the names or glob patterns used to define
Elastic Security Elasticsearch indices.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The Elastic Security Elasticsearch indices are defined in the <code class="literal">securitysolution:defaultIndex</code> field
(<span class="strong strong"><strong>Kibana</strong></span> &#8594; <span class="strong strong"><strong>Management</strong></span> &#8594; <span class="strong strong"><strong>Advanced Settings</strong></span> &#8594; <span class="strong strong"><strong><code class="literal">:defaultIndex</code></strong></span>).</p>
</div>
</div>
<p>For example, if you define an Elastic Security Elasticsearch <code class="literal">servers-europe-*</code> glob pattern,
to display map data for the matching indices you must also define a Kibana index
pattern that matches <code class="literal">servers-europe-*</code>, such as <code class="literal">servers-*</code>.</p>
<h5><a id="geoip-data"></a>Add geoIP data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/getting-started/network-page-overview.asciidoc">edit</a></h5>
<p>When the ECS <a href="https://www.elastic.co/guide/en/ecs/1.5/ecs-geo.html" class="ulink" target="_top">source.geo.location and
destination.geo.location</a> fields are mapped, network data is displayed on
the map.</p>
<p>If you use Beats, configure a geoIP processor to add data to the relevant
fields:</p>
<div id="geo-pipeleine" class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Define an ingest node pipeline that uses one or more <code class="literal">geoIP</code> processors to add
location information to events. For example, use the Console in Kibana to create
the following pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip-info
{
  "description": "Add geoip info",
  "processors": [
    {
      "geoip": {
        "field": "client.ip",
        "target_field": "client.geo",
        "ignore_missing": true
      }
    },
    {
      "geoip": {
        "field": "source.ip",
        "target_field": "source.geo",
        "ignore_missing": true
      }
    },
    {
      "geoip": {
        "field": "destination.ip",
        "target_field": "destination.geo",
        "ignore_missing": true
      }
    },
    {
      "geoip": {
        "field": "server.ip",
        "target_field": "server.geo",
        "ignore_missing": true
      }
    },
    {
      "geoip": {
        "field": "host.ip",
        "target_field": "host.geo",
        "ignore_missing": true
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1.console"></div>
<p>In this example, the pipeline ID is <code class="literal">geoip-info</code>. <code class="literal">field</code> specifies the field
that contains the IP address to use for the geographical lookup, and
<code class="literal">target_field</code> is the field that will hold the geographical information.
<code class="literal">"ignore_missing": true</code> configures the pipeline to continue processing when
it encounters an event that doesn&#8217;t have the specified field.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>An example ingest pipeline that uses the GeoLite2-ASN.mmdb database to add
autonomous system number (ASN) fields can be found <a href="https://github.com/elastic/examples/blob/master/Security%20Analytics/SIEM-examples/Packetbeat/geoip-info.json" class="ulink" target="_top">here</a>.</p>
</div>
</div>
</li>
<li class="listitem">
<p>In your Beats configuration files, add the pipeline to the
`output.elasticsearch`tag:</p>
<div class="pre_wrapper lang-yml">
<pre class="programlisting prettyprint lang-yml">  output.elasticsearch:
    hosts: ["localhost:9200"]
    pipeline: geoip-info <a id="CO1-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The value of this field must be the same as the ingest pipeline name in
<a class="xref" href="network-page-overview.html#geo-pipeleine">step 1</a> (<code class="literal">geoip-info</code> in this example).</p>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<h5><a id="private-network"></a>Map your internal network<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/getting-started/network-page-overview.asciidoc">edit</a></h5>
<p>If you want to add your network’s internal IP addresses to the map, define geo
location fields under the <code class="literal">processors</code> tag in the Beats configuration files
on your hosts:</p>
<div class="pre_wrapper lang-yml">
<pre class="programlisting prettyprint lang-yml">  processors:
   - add_host_metadata:
   - add_cloud_metadata: ~
   - add_fields:
       when.network.source.ip: &lt;private/IP address&gt; <a id="CO2-1"></a><i class="conum" data-value="1"></i>
       fields:
         source.geo.location:
           lat: &lt;latitude coordinate&gt;
           lon: &lt;longitude coordinate&gt;
       target: ''
   - add_fields:
       when.network.destination.ip: &lt;private/IP address&gt;
       fields:
         destination.geo.location:
           lat: &lt;latitude coordinate&gt;
           lon: &lt;longitude coordinate&gt;
       target: ''</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>For the IP address, you can use either <code class="literal">private</code> or CIDR notation.</p>
</td>
</tr>
</table>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also enrich your data with other
<a href="https://www.elastic.co/guide/en/beats/packetbeat/7.9/add-host-metadata.html" class="ulink" target="_top">host fields</a>.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="es-ui-overview.html">« Elastic Security UI</a>
</span>
<span class="next">
<a href="sensor-full-disk-access.html">Enable full disk access »</a>
</span>
</div>
</div>
</body>
</html>
