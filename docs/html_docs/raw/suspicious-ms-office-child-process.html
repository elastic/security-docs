<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Suspicious MS Office Child Process | Elastic Security Solution | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="suspicious-activity-reported-by-okta-user.html" title="Suspicious Activity Reported by Okta User"/>
<link rel="next" href="suspicious-ms-outlook-child-process.html" title="Suspicious MS Outlook Child Process"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and Alerts (beta)</a></span>
»
<span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
»
<span class="breadcrumb-node">Suspicious MS Office Child Process</span>
</div>
<div class="navheader">
<span class="prev">
<a href="suspicious-activity-reported-by-okta-user.html">« Suspicious Activity Reported by Okta User</a>
</span>
<span class="next">
<a href="suspicious-ms-outlook-child-process.html">Suspicious MS Outlook Child Process »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="suspicious-ms-office-child-process"></a>Suspicious MS Office Child Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h2>
</div></div></div>
<p>Identifies suspicious child processes of frequently targeted Microsoft Office
applications (Word, PowerPoint, Excel). These child processes are often launched
during exploitation of Office applications or from documents with malicious
macros.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.9/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="suspicious-ms-office-child-process.html#suspicious-ms-office-child-process-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.9.0</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>: Elastic</p>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_146"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.category:process and event.type:(start or process_started) and
process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or
msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and
process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or
atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe
or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or
dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or
gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or
installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or
nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or
nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe
or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or
regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or
systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or
wmic.exe or wscript.exe or xwizard.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_threat_mapping_115"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Spearphishing Attachment
</li>
<li class="listitem">
ID: T1193
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1193/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1193/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="suspicious-ms-office-child-process-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.9/docs/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.9.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or
msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and
process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or
atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe
or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or
dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or
gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or
installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or
nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or
nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe
or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or
regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or
systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or
wmic.exe or wscript.exe or xwizard.exe)</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:("winword.exe" or "excel.exe" or "powerpnt.exe" or
"eqnedt32.exe" or "fltldr.exe" or "mspub.exe" or "msaccess.exe") and
process.name:("arp.exe" or "dsquery.exe" or "dsget.exe" or
"gpresult.exe" or "hostname.exe" or "ipconfig.exe" or "nbtstat.exe" or
"net.exe" or "net1.exe" or "netsh.exe" or "netstat.exe" or
"nltest.exe" or "ping.exe" or "qprocess.exe" or "quser.exe" or
"qwinsta.exe" or "reg.exe" or "sc.exe" or "systeminfo.exe" or
"tasklist.exe" or "tracert.exe" or "whoami.exe" or "bginfo.exe" or
"cdb.exe" or "cmstp.exe" or "csi.exe" or "dnx.exe" or "fsi.exe" or
"ieexec.exe" or "iexpress.exe" or "installutil.exe" or
"Microsoft.Workflow.Compiler.exe" or "msbuild.exe" or "mshta.exe" or
"msxsl.exe" or "odbcconf.exe" or "rcsi.exe" or "regsvr32.exe" or
"xwizard.exe" or "atbroker.exe" or "forfiles.exe" or "schtasks.exe" or
"regasm.exe" or "regsvcs.exe" or "cmd.exe" or "cscript.exe" or
"powershell.exe" or "pwsh.exe" or "wmic.exe" or "wscript.exe" or
"bitsadmin.exe" or "certutil.exe" or "ftp.exe")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="suspicious-activity-reported-by-okta-user.html">« Suspicious Activity Reported by Okta User</a>
</span>
<span class="next">
<a href="suspicious-ms-outlook-child-process.html">Suspicious MS Outlook Child Process »</a>
</span>
</div>
</div>
</body>
</html>
