---
id: attackDiscovery
slug: /serverless/security/attack-discovery
title: Attack discovery
description: Accelerate threat identification by triaging alerts with a large language model.
tags: [ 'serverless', 'security', 'overview', 'LLM', 'artificial intelligence' ]
status: in review
---

<DocBadge template="technical preview" />

<DocCallOut title="Technical preview" color="warning">
This feature is in technical preview. It may change in the future, and you should exercise caution when using it in production environments. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of GA features.
</DocCallOut>

Attack discovery leverages large language models (LLMs) to analyze alerts in your environment and identify threats. Each "discovery" represents a potential attack and describes relationships among multiple alerts to tell you which users and hosts are involved, how alerts correspond to the MITRE ATT&CK matrix, and which threat actor might be responsible. This can help make the most of each security analyst's time, fight alert fatigue, and reduce your mean time to respond.

This page describes:

- <DocLink id="attackDiscovery" section="generate-discoveries">How to start generating discoveries</DocLink>
- <DocLink id="attackDiscovery" section="discovery-info">What information each discovery includes</DocLink>
- <DocLink id="attackDiscovery" section="workflows">How you can interact with discoveries to enhance ((elastic-sec)) workflows</DocLink>


<div id="generate-discoveries"></div>
## Generate discoveries

When you access Attack discovery for the first time, you'll need to select an LLM connector before you can analyze alerts. Attack discovery uses the same LLM connectors as <DocLink id="serverlessSecurityAIAssistant">Elastic AI Assistant</DocLink>. To get started:

1. Click the **Attack discovery** page from ((elastic-sec))'s navigation menu. 

2. Select an existing connector from the dropdown menu, or add a new one. 

<DocCallOut title="Recommended models">
While Attack discovery is compatible with many different models, our testing found increased performance with Claude 3 Sonnet and Claude 3 Opus. In general, models with larger context windows are more effective for Attack discovery.
</DocCallOut>

![Attack discovery empty state](../images/attack-discovery/select-model-empty-state.png)

3. Once you've selected a connector, click **Generate** to start the analysis. 

It may take from a few seconds up to several minutes to generate discoveries, depending on the number of alerts and the model you selected. Note that Attack discovery only analyzes alerts from the past 24 hours.


<DocCallOut title="Important">
Attack discovery uses the same data anonymization settings as <DocLink id="serverlessSecurityAIAssistant">Elastic AI Assistant</DocLink>. To configure which alert fields are sent to the LLM and which of those fields are obfuscated, use the Elastic AI Assistant settings. Consider the privacy policies of third-party LLMs before sending them sensitive data. 
</DocCallOut>

Once the analysis is complete, any threats it identifies appear as discoveries. Click each one's title to expand or collapse it. Click **Generate** at any time to start the Attack discovery process again with the most current alerts.

<div id="discovery-info"></div>
## What information does each discovery include?

Each discovery includes the following information describing the potential threat, generated by the connected LLM:

- A descriptive title and a summary of the potential threat.
- The number of associated alerts and which parts of the [MITRE ATT&CK matrix](https://attack.mitre.org/) they correspond to.
- The implicated entities (users and hosts), and what suspicious activity was observed for each.

![Attack discovery detail view](../images/attack-discovery/attack-discovery-full-card.png)

<div id="workflows"></div>
## Incorporate discoveries with other workflows

There are several ways you can incorporate discoveries into your ((elastic-sec)) workflows:

- Click an entity's name to open the user or host details flyout and view more details that may be relevant to your investigation.
- Hover over an entity's name to either add the entity to Timeline (<DocIcon type="timeline" title="Timeline" />) or copy its field name and value to the clipboard (<DocIcon type="copyClipboard" title="Copy to clipboard"/>). 
- Click **Take action**, then select **Add to new case** or **Add to existing case** to add a discovery to a case. This makes it easy to share the information with your team and other stakeholders.
- Click **Investigate in timeline** to explore the discovery in Timeline.
- Click **View in AI Assistant** to attach the discovery to a conversation with AI Assistant. You can then ask follow up questions about the discovery or associated alerts. 

![Attack discovery view in AI Assistant](../images/attack-discovery/add-discovery-to-conversation.gif)
