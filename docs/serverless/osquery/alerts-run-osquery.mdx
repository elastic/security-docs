---
slug: /serverless/security/alerts-run-osquery
title: Run Osquery from alerts
description: Run live queries against an alert's host to investigate potential security threats and system compromises.
tags: [ 'serverless', 'security', 'how-to', 'analyze' ]
status: in review
---

<DocBadge template="technical preview" />
<div id="alerts-run-osquery"></div>

Run live queries on hosts associated with alerts to learn more about your infrastructure and operating systems. For example, with Osquery, you can search your system for indicators of compromise that might have contributed to the alert. You can then use this data to inform your investigation and alert triage efforts.

<DocCallOut title="Requirements">

* The [Osquery manager integration](((kibana-ref))/manage-osquery-integration.html) must be installed.
* ((agent))'s [status](((fleet-guide))/monitor-elastic-agent.html) must be `Healthy`. Refer to [((fleet)) Troubleshooting](((fleet-guide))/fleet-troubleshooting.html) if it isn't.
* You must have the appropriate user role to use this feature.

</DocCallOut>

To run Osquery from an alert:

1. Do one of the following from the Alerts table:
    * Click the **View details** button to open the Alert details flyout, then click **Take action â†’ Run Osquery**.
    * Select the **More actions** menu (<DocIcon type="boxesHorizontal" title="Actions menu icon" />), then select **Run Osquery**.
1. Choose to run a single query or a query pack.
1. Select one or more ((agent))s or groups to query. Start typing in the search field to get suggestions for ((agent))s by name, ID, platform, and policy.

    <DocCallOut title="Note">
    The host associated with the alert is automatically selected. You can specify additional hosts to query.
    </DocCallOut>

1. Specify the query or pack to run:
    * **Query**: Select a saved query or enter a new one in the text box. After you enter the query, you can expand the **Advanced** section to set a timeout period for the query, and view or set [mapped ECS fields](((kibana-ref))/osquery.html#osquery-map-fields) included in the results from the live query (optional). 

        <DocCallOut title="Note">
        Overwriting the query's default timeout period allows you to support queries that take longer to run. The default and minimum supported value for the **Timeout** field is `60`. The maximum supported value is `900`. 
        </DocCallOut>

        <DocCallOut title="Tip">
        Use <DocLink slug="/serverless/security/osquery-placeholder-fields">placeholder fields</DocLink> to dynamically add existing alert data to your query. 
        </DocCallOut>

    * **Pack**: Select from available query packs. After you select a pack, all of the queries in the pack are displayed.

        <DocCallOut title="Tip">
        Refer to [prebuilt packs](((kibana-ref))/osquery.html#osquery-prebuilt-packs-queries) to learn about using and managing Elastic prebuilt packs.
        </DocCallOut>

        <DocImage size="xl" url="../images/alerts-run-osquery/-osquery-setup-query.png" alt="Shows how to set up a single query" />
        

1. Click **Submit**. Query results will display within the flyout.

    <DocCallOut title="Note">
    Refer to <DocLink slug="/serverless/security/examine-osquery-results">Examine Osquery results</DocLink> for more information about query results.
    </DocCallOut>

1. Click **Save for later** to save the query for future use (optional).

