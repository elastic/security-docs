[[prebuilt-rules-update-modified-unmodified]]
== Update modified and unmodified Elastic prebuilt rules

.Requirements
[sidebar]
--
You must have an https://www.elastic.co/subscriptions/cloud[Enterprise] subscription to access this feature. If you have a Platinum subscription or lower, follow the guidelines in <<update-prebuilt-rules>> instead.
--

. Find *Detection rules (SIEM)* in the navigation menu or by using the {kibana-ref}/introduction.html#kibana-navigation-search[global search field].
. In the *Rules* table, select the *Rule Updates* tab.
+
NOTE: The *Rule Updates* tab doesn't appear if all your installed prebuilt rules are up to date.
+
[role="screenshot"]
image::images/prebuilt-rules-update.png[The Rule Updates tab on the Rules page]

. (Optional) To examine the details of a rule's latest version before you update it, select the rule name. This opens the rule details flyout, where you can: 

** Preview incoming updates: Select the *Elastic update overview* tab to view rule changes field by field, or the *JSON view* tab to view changes for the entire rule in JSON format. 
+
Both tabs display side-by-side comparisons of the *Current rule* (what you currently have installed) and the *Elastic update* version (what you can choose to install). Deleted characters are highlighted in red; added characters are highlighted in green.
+
** Compare different versions of a rule field: In the **Diff view** section, Use the **Diff view** drop-down menu to compare different versions of a rule field. For example, compare the changes that you made to the current version of the field with changes that will be applied from the incoming Elastic update.
+
NOTE: If you haven't updated the rule in a while, its original version might be unavailable for comparison. Instead, you will only have access to the rule's current version and the incoming Elastic update. You can avoid this by updating prebuilt rules frequently. 

** Check the update status: View the status of the entire rule update and for <<rule-update-statuses,each field that's being changed>>. 

** Address update conflicts: Find and address conflicts that <<resolve-reduce-rule-conflicts, need additional attention>>. 

** Edit the final update: Change the update that will be applied to the field when you update the rule. To change the update, go to the *Final update* section, make your changes, and then save them.
+
IMPORTANT: Elastic updates containing a rule type change cannot be edited. Before updating the rule, duplicate it if you need to record changes that you made to other rule fields. 
+
[role="screenshot"]
image::images/prebuilt-rules-update-diff-advanced.png[Prebuilt rule comparison,85%]
+

. From the *Rule Updates* tab, do one of the following to update prebuilt rules:

IMPORTANT: Although you can still update rules with auto-resolved, we strongly recommend reviewing them beforehand to avoid overwriting intentional changes or breaking the rules. 

* Update all available rules: Click *Update all* to update rules without conflicts and rules with auto-resolved conflicts.
* Update a single rule without conflicts: Click *Update rule* for that rule. 
* Update multiple rules: Select the rules and click *Update _x_ selected rule(s)* to update without conflicts and with auto-resolved conflicts. 
+
TIP: Use the search bar and *Tags* filter to find the rules you want to update. For example, filter by `OS: Windows` if your environment only includes Windows endpoints. For more on tag categories, refer to <<prebuilt-rule-tags>>.

[float]
[[rule-update-statuses]]
=== Rule update statuses

This table describes statuses that might appear for rule fields being updated.  

[cols="2"]
|===

| *Ready for update*
a| Displays when there are no conflicts to resolve. 

Further action is not required for the field. It is ready to be updated.

| *No update*
a| Displays when the field is not being updated by Elastic, but the current field value differs from the original one. This typically happens when the field's value was changed after the prebuilt rule was initially installed.

Further action is not required for the field. It is ready to be updated.

TIP: You can still change the final field update, if needed. To do so, make your changes in the *Final update* section and save them.

| *Review required*
a| Displays when Elastic auto-resolves a conflict between the current field value and the value from the incoming Elastic update. 

You must accept or edit the field's final update and save the changes. Refer to <<resolve-reduce-rule-conflicts>> to learn more about auto-resolved conflicts and how to reduce future conflicts.

| *Action required*
a| Displays when Elastic could not auto-resolve the conflict between the current field value and the value from the incoming Elastic update. 

You must manually set and save the field's final update. Refer to <<resolve-reduce-rule-conflicts>> to learn more about conflicts that need manual fixes and how to reduce future conflicts.

|===


[float]
[[resolve-reduce-rule-conflicts]]
=== Resolve and reduce update conflicts

Keeping prebuilt rules up to date might help you minimize the frequency and complexity of conflicts that occur during rule updates.  

When a conflict does happen, Elastic attempts to resolve it and will suggest a fix for your review. In these cases, you can still update the rule, but we strongly recommend reviewing it beforehand to avoid overwriting intentional changes or breaking the rule. 

If Elastic can't resolve the conflict, you must manually fix it before updating the rule. To manually fix a conflict go to the **Rule update** tab, then:

. Click on the rule name or click **Review**. 
. From the update flyout, find rule fields with unresolved conflicts. They will have the `Action required` badge next to their names.
. Go to the *Final update* section and do any of the following:
** Keep the current value instead of accepting the Elastic update.
** Accept the Elastic update and overwrite your changes.
** Edit the final field value by combining your changes with the Elastic update or making the appropriate changes.
. Click **Save and accept** to apply your changes. The field's status changes to `Ready for update`. 

After you've resolved the remaining conflicts, click *Update rule* to accept the changes and install the updated version.