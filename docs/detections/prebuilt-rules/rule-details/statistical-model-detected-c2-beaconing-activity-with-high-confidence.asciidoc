[[statistical-model-detected-c2-beaconing-activity-with-high-confidence]]
=== Statistical Model Detected C2 Beaconing Activity with High Confidence

A statistical model has identified command-and-control (C2) beaconing activity with high confidence. Beaconing can help attackers maintain stealthy communication with their C2 servers, receive instructions and payloads, exfiltrate data and maintain persistence in a network.

*Rule type*: query

*Rule indices*: 

* ml_beaconing.all

*Severity*: low

*Risk score*: 21

*Runs every*: 5m

*Searches indices from*: now-1h ({ref}/common-options.html#date-math[Date Math format], see also <<rule-schedule, `Additional look-back time`>>)

*Maximum alerts per execution*: 100

*References*: 

* https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html
* https://docs.elastic.co/en/integrations/beaconing
* https://www.elastic.co/security-labs/identifying-beaconing-malware-using-elastic

*Tags*: 

* Domain: Network
* Use Case: C2 Beaconing Detection
* Tactic: Command and Control

*Version*: 4

*Rule authors*: 

* Elastic

*Rule license*: Elastic License v2


==== Setup



*Setup*


The rule requires the Network Beaconing Identification integration assets to be installed, as well as network logs collected by the Elastic Defend or Network Packet Capture integrations.


*Network Beaconing Identification Setup*

The Network Beaconing Identification integration consists of a statistical framework to identify C2 beaconing activity in network logs.


*Prerequisite Requirements:*

- Fleet is required for Network Beaconing Identification.
- To configure Fleet Server refer to the https://www.elastic.co/guide/en/fleet/current/fleet-server.html[documentation].
- Network events collected by the https://docs.elastic.co/en/integrations/endpoint[Elastic Defend] or https://docs.elastic.co/integrations/network_traffic[Network Packet Capture] integration.
- To install Elastic Defend, refer to the https://www.elastic.co/guide/en/security/current/install-endpoint.html[documentation].
- To add the Network Packet Capture integration to an Elastic Agent policy, refer to https://www.elastic.co/guide/en/fleet/current/add-integration-to-policy.html[this] guide.


*The following steps should be executed to install assets associated with the Network Beaconing Identification integration:*

- Go to the Kibana homepage. Under Management, click Integrations.
- In the query bar, search for Network Beaconing Identification and select the integration to see more details about it.
- Under Settings, click "Install Network Beaconing Identification assets" and follow the prompts to install the assets.


==== Rule query


[source, js]
----------------------------------
beacon_stats.beaconing_score: 3

----------------------------------

*Framework*: MITRE ATT&CK^TM^

* Tactic:
** Name: Command and Control
** ID: TA0011
** Reference URL: https://attack.mitre.org/tactics/TA0011/
* Technique:
** Name: Web Service
** ID: T1102
** Reference URL: https://attack.mitre.org/techniques/T1102/
* Sub-technique:
** Name: Bidirectional Communication
** ID: T1102.002
** Reference URL: https://attack.mitre.org/techniques/T1102/002/
