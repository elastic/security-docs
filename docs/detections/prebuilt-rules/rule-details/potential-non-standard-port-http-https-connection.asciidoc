[[potential-non-standard-port-http-https-connection]]
=== Potential Non-Standard Port HTTP/HTTPS connection

Identifies potentially malicious processes communicating via a port paring typically not associated with HTTP/HTTPS. For example, HTTP over port 8443 or port 440 as opposed to the traditional port 80 , 443. Adversaries may make changes to the standard port a protocol uses to bypass filtering or muddle analysis/parsing of network data.

*Rule type*: eql

*Rule indices*: 

* logs-endpoint.events.*

*Severity*: low

*Risk score*: 21

*Runs every*: 60m

*Searches indices from*: now-119m ({ref}/common-options.html#date-math[Date Math format], see also <<rule-schedule, `Additional look-back time`>>)

*Maximum alerts per execution*: 100

*References*: None

*Tags*: 

* Domain: Endpoint
* OS: Linux
* OS: macOS
* Use Case: Threat Detection
* Tactic: Command and Control
* Rule Type: BBR
* Data Source: Elastic Defend

*Version*: 2

*Rule authors*: 

* Elastic

*Rule license*: Elastic License v2


==== Rule query


[source, js]
----------------------------------
network where process.name : ("http", "https")
  and destination.port not in (80, 443)
  and event.action in ("connection_attempted", "connection_accepted")
  and destination.ip != "127.0.0.1"

----------------------------------

*Framework*: MITRE ATT&CK^TM^

* Tactic:
** Name: Command and Control
** ID: TA0011
** Reference URL: https://attack.mitre.org/tactics/TA0011/
* Technique:
** Name: Non-Standard Port
** ID: T1571
** Reference URL: https://attack.mitre.org/techniques/T1571/
* Technique:
** Name: Application Layer Protocol
** ID: T1071
** Reference URL: https://attack.mitre.org/techniques/T1071/
* Sub-technique:
** Name: Web Protocols
** ID: T1071.001
** Reference URL: https://attack.mitre.org/techniques/T1071/001/
* Technique:
** Name: Encrypted Channel
** ID: T1573
** Reference URL: https://attack.mitre.org/techniques/T1573/
* Sub-technique:
** Name: Symmetric Cryptography
** ID: T1573.001
** Reference URL: https://attack.mitre.org/techniques/T1573/001/
* Sub-technique:
** Name: Asymmetric Cryptography
** ID: T1573.002
** Reference URL: https://attack.mitre.org/techniques/T1573/002/
