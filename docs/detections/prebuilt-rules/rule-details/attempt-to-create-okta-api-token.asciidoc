[[attempt-to-create-okta-api-token]]
=== Attempt to Create Okta API Token

An adversary may create an Okta API token to maintain access to an
organization's network while they work to achieve their objectives. An attacker
may abuse an API token to execute techniques such as creating user accounts, or
disabling security rules or policies.

*Rule type*: query

*Rule indices*:

* filebeat-*
* logs-okta*

*Severity*: low

*Risk score*: 21

*Runs every*: 5 minutes

*Searches indices from*: now-6m ({ref}/common-options.html#date-math[Date Math format], see also <<rule-schedule, `Additional look-back time`>>)

*Maximum alerts per execution*: 100

*References*:

* https://developer.okta.com/docs/reference/api/system-log/
* https://developer.okta.com/docs/reference/api/event-types/

*Tags*:

* Elastic
* Okta
* SecOps
* Monitoring
* Continuous Monitoring

*Version*: 2 (<<attempt-to-create-okta-api-token-history, version history>>)

*Added ({stack} release)*: 7.9.0

*Last modified ({stack} release)*: 7.10.0

*Rule authors*: Elastic

*Rule license*: Elastic License

==== Potential false positives

If the behavior of creating Okta API tokens is expected, consider adding
exceptions to this rule to filter false positives.

==== Investigation guide

The Okta Filebeat module must be enabled to use this rule.

==== Rule query


[source,js]
----------------------------------
event.dataset:okta.system and event.action:system.api_token.create
----------------------------------

==== Threat mapping

*Framework*: MITRE ATT&CK^TM^

* Tactic:
** Name: Persistence
** ID: TA0003
** Reference URL: https://attack.mitre.org/tactics/TA0003/
* Technique:
** Name: Create Account
** ID: T1136
** Reference URL: https://attack.mitre.org/techniques/T1136/

[[attempt-to-create-okta-api-token-history]]
==== Rule version history

Version 2 (7.10.0 release)::
* Updated query, changed from:
+
[source, js]
----------------------------------
event.module:okta and event.dataset:okta.system and
event.action:system.api_token.create
----------------------------------

