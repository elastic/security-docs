[[prebuilt-rule-0-16-1-prebuilt-rules-0-16-1-summary]]
[role="xpack"]
== Update v0.16.1

This section lists all updates associated with version 0.16.1 of the Fleet integration *Prebuilt Security Detection Rules*.


[width="100%",options="header"]
|==============================================
|Rule |Description |Status |Version

|<<prebuilt-rule-0-16-1-agent-spoofing-mismatched-agent-id, Agent Spoofing - Mismatched Agent ID>> | Detects events which have a mismatch on the expected event agent ID. The status "agent_id_mismatch" occurs when the expected agent ID associated with the API key does not match the actual agent ID in an event. This could indicate attempts to spoof events in order to masquerade actual activity to evade detection. | new | 2 

|<<prebuilt-rule-0-16-1-agent-spoofing-multiple-hosts-using-same-agent, Agent Spoofing - Multiple Hosts Using Same Agent>> | Detects when multiple hosts are using the same agent ID. This could occur in the event of an agent being taken over and used to inject illegitimate documents into an instance as an attempt to spoof events in order to masquerade actual activity to evade detection. | new | 2 

|<<prebuilt-rule-0-16-1-potential-java-jndi-exploitation-attempt, Potential JAVA/JNDI Exploitation Attempt>> | Identifies an outbound network connection by JAVA to LDAP, RMI or DNS standard ports followed by a suspicious JAVA child processes. This may indicate an attempt to exploit a JAVA/NDI (Java Naming and Directory Interface) injection vulnerability. | new | 1 

|<<prebuilt-rule-0-16-1-azure-alert-suppression-rule-created-or-modified, Azure Alert Suppression Rule Created or Modified>> | Identifies the creation of suppression rules in Azure. Suppression rules are a mechanism used to suppress alerts previously identified as false positives or too noisy to be in production. This mechanism can be abused or mistakenly configured, resulting in defense evasions and loss of security visibility. | new | 2 

|<<prebuilt-rule-0-16-1-azure-ad-global-administrator-role-assigned, Azure AD Global Administrator Role Assigned>> | In Azure Active Directory (Azure AD), permissions to manage resources are assigned using Roles. The Global Administrator is a role that enables users to have access to all administrative features in Azure AD and services that use Azure Active Directory identities like the Microsoft 365 Defender portal, the Microsoft 365 compliance center, Exchange, SharePoint Online, and Skype for Business Online. Attackers can add users as Global Administrators to maintain access and manage all subscriptions and their settings and resources. | new | 1 

|<<prebuilt-rule-0-16-1-gcp-kubernetes-rolebindings-created-or-patched, GCP Kubernetes Rolebindings Created or Patched>> | Identifies the creation or patching of potentially malicious role bindings. Users can use role bindings and cluster role bindings to assign roles to Kubernetes subjects (users, groups, or service accounts). | new | 2 

|<<prebuilt-rule-0-16-1-o365-mailbox-audit-logging-bypass, O365 Mailbox Audit Logging Bypass>> | Detects the occurrence of mailbox audit bypass associations. The mailbox audit is responsible for logging specified mailbox events (like accessing a folder or a message or permanently deleting a message). However, actions taken by some authorized accounts, such as accounts used by third-party tools or accounts used for lawful monitoring, can create a large number of mailbox audit log entries and may not be of interest to your organization. Because of this, administrators can create bypass associations, allowing certain accounts to perform their tasks without being logged. Attackers can abuse this allowlist mechanism to conceal actions taken, as the mailbox audit will log no activity done by the account. | new | 3 

|<<prebuilt-rule-0-16-1-o365-email-reported-by-user-as-malware-or-phish, O365 Email Reported by User as Malware or Phish>> | Detects the occurrence of emails reported as Phishing or Malware by Users. Security Awareness training is essential to stay ahead of scammers and threat actors, as security products can be bypassed, and the user can still receive a malicious message. Educating users to report suspicious messages can help identify gaps in security controls and prevent malware infections and Business Email Compromise attacks. | new | 1 

|<<prebuilt-rule-0-16-1-onedrive-malware-file-upload, OneDrive Malware File Upload>> | Identifies the occurence of files uploaded to OneDrive being detected as Malware by the file scanning engine. Attackers can use File Sharing and Organization Repositories to spread laterally within the company and amplify their access. Users can inadvertently share these files without knowing their maliciousness, giving adversaries opportunity to gain initial access to other endpoints in the environment. | new | 1 

|<<prebuilt-rule-0-16-1-sharepoint-malware-file-upload, SharePoint Malware File Upload>> | Identifies the occurence of files uploaded to SharePoint being detected as Malware by the file scanning engine. Attackers can use File Sharing and Organization Repositories to spread laterally within the company and amplify their access. Users can inadvertently share these files without knowing their maliciousness, giving adversaries opportunity to gain initial access to other endpoints in the environment. | new | 1 

|<<prebuilt-rule-0-16-1-microsoft-365-global-administrator-role-assigned, Microsoft 365 Global Administrator Role Assigned>> | In Azure Active Directory (Azure AD), permissions to manage resources are assigned using Roles. The Global Administrator is a role that enables users to have access to all administrative features in Azure AD and services that use Azure Active Directory identities like the Microsoft 365 Defender portal, the Microsoft 365 compliance center, Exchange, SharePoint Online, and Skype for Business Online. Attackers can add users as Global Administrators to maintain access and manage all subscriptions and their settings and resources. | new | 1 

|<<prebuilt-rule-0-16-1-potential-abuse-of-repeated-mfa-push-notifications, Potential Abuse of Repeated MFA Push Notifications>> | Detect when an attacker abuses the Multi-Factor authentication mechanism by repeatedly issuing login requests until the user eventually accepts the Okta push notification. An adversary may attempt to bypass the Okta MFA policies configured for an organization to obtain unauthorized access. | new | 1 

|<<prebuilt-rule-0-16-1-potential-privilege-escalation-via-pkexec, Potential Privilege Escalation via PKEXEC>> | Identifies attempt to exploit a local privilege escalation in polkit pkexec (CVE-2021-4034) via unsecure environment variable injection. Successful exploitation allows an unprivileged user to escalate to the root user. | new | 1 

|<<prebuilt-rule-0-16-1-powershell-suspicious-script-with-screenshot-capabilities, PowerShell Suspicious Script with Screenshot Capabilities>> | Detects PowerShell scripts that can take screenshots, which is a common feature in post-exploitation kits and remote access tools (RATs). | new | 2 

|<<prebuilt-rule-0-16-1-potential-credential-access-via-dcsync, Potential Credential Access via DCSync>> | This rule identifies when a User Account starts the Active Directory Replication Process. Attackers can use the DCSync technique to get credential information of individual accounts or the entire domain, thus compromising the entire domain. | new | 1 

|<<prebuilt-rule-0-16-1-kerberos-preauthentication-disabled-for-user, Kerberos Preauthentication Disabled for User>> | Identifies the modification of account Kerberos preauthentication options. An adversary with GenericWrite/GenericAll rights over the account can maliciously modify these settings to perform offline password cracking attacks such as AS-REP roasting. | new | 1 

|<<prebuilt-rule-0-16-1-powershell-kerberos-ticket-request, PowerShell Kerberos Ticket Request>> | Detects PowerShell scripts that have the capability of requesting kerberos tickets, which is common step in Kerberoasting toolkits to crack service accounts. | new | 1 

|<<prebuilt-rule-0-16-1-sensitive-privilege-seenabledelegationprivilege-assigned-to-a-user, Sensitive Privilege SeEnableDelegationPrivilege assigned to a User>> | Identifies the assignment of the SeEnableDelegationPrivilege sensitive "user right" to a user. The SeEnableDelegationPrivilege "user right" enables computer and user accounts to be trusted for delegation. Attackers can abuse this right to compromise Active Directory accounts and elevate their privileges. | new | 1 

|<<prebuilt-rule-0-16-1-potential-shadow-credentials-added-to-ad-object, Potential Shadow Credentials added to AD Object>> | Identify the modification of the msDS-KeyCredentialLink attribute in an Active Directory Computer or User Object. Attackers can abuse control over the object and create a key pair, append to raw public key in the attribute, and obtain persistent and stealthy access to the target user or computer object. | new | 1 

|<<prebuilt-rule-0-16-1-symbolic-link-to-shadow-copy-created, Symbolic Link to Shadow Copy Created>> | Identifies the creation of symbolic links to a shadow copy. Symbolic links can be used to access files in the shadow copy, including sensitive files that may contain credential information. | new | 2 

|<<prebuilt-rule-0-16-1-powershell-script-block-logging-disabled, PowerShell Script Block Logging Disabled>> | Identifies attempts to disable PowerShell Script Block Logging via registry modification. Attackers may disable this logging to conceal their activities in the host and evade detection. | new | 1 

|<<prebuilt-rule-0-16-1-microsoft-windows-defender-tampering, Microsoft Windows Defender Tampering>> | Identifies when one or more features on Microsoft Defender are disabled. Adversaries may disable or tamper Microsoft Defender features to evade detection and conceal malicious behavior. | new | 2 

|<<prebuilt-rule-0-16-1-ms-office-macro-security-registry-modifications, MS Office Macro Security Registry Modifications>> | Microsoft Office Products offers options for users and developers to control the security settings for running and using Macros. Adversaries may abuse these security settings to modify the default behavior of the Office Application to trust future macros and/or disable security warnings, which could increase their chances of establishing persistence. | new | 1 

|<<prebuilt-rule-0-16-1-powershell-suspicious-payload-encoded-and-compressed, PowerShell Suspicious Payload Encoded and Compressed>> | Identifies the use of .NET functionality for decompression and base64 decoding combined in PowerShell scripts, which malware and security tools heavily use to deobfuscate payloads and load them directly in memory to bypass defenses. | new | 2 

|<<prebuilt-rule-0-16-1-powershell-psreflect-script, PowerShell PSReflect Script>> | Detects the use of PSReflect in PowerShell scripts. Attackers leverage PSReflect as a library that enables PowerShell to access win32 API functions. | new | 2 

|<<prebuilt-rule-0-16-1-adminsdholder-backdoor, AdminSDHolder Backdoor>> | Detects modifications in the AdminSDHolder object. Attackers can abuse the SDProp process to implement a persistent backdoor in Active Directory. SDProp compares the permissions on protected objects with those defined on the AdminSDHolder object. If the permissions on any of the protected accounts and groups do not match, the permissions on the protected accounts and groups are reset to match those of the domain's AdminSDHolder object, regaining their Administrative Privileges. | new | 1 

|<<prebuilt-rule-0-16-1-krbtgt-delegation-backdoor, KRBTGT Delegation Backdoor>> | Identifies the modification of the msDS-AllowedToDelegateTo attribute to KRBTGT. Attackers can use this technique to maintain persistence to the domain by having the ability to request tickets for the KRBTGT service. | new | 1 

|<<prebuilt-rule-0-16-1-startup-logon-script-added-to-group-policy-object, Startup/Logon Script added to Group Policy Object>> | Detects the modification of Group Policy Objects (GPO) to add a startup/logon script to users or computer objects. | new | 2 

|<<prebuilt-rule-0-16-1-group-policy-abuse-for-privilege-addition, Group Policy Abuse for Privilege Addition>> | Detects the first occurrence of a modification to Group Policy Object Attributes to add privileges to user accounts or use them to add users as local admins. | new | 2 

|<<prebuilt-rule-0-16-1-scheduled-task-execution-at-scale-via-gpo, Scheduled Task Execution at Scale via GPO>> | Detects the modification of Group Policy Object attributes to execute a scheduled task in the objects controlled by the GPO. | new | 2 

|<<prebuilt-rule-0-16-1-potential-privilege-escalation-via-installerfiletakeover, Potential Privilege Escalation via InstallerFileTakeOver>> | Identifies a potential exploitation of InstallerTakeOver (CVE-2021-41379) default PoC execution. Successful exploitation allows an unprivileged user to escalate privileges to SYSTEM. | new | 2 

|<<prebuilt-rule-0-16-1-potential-privileged-escalation-via-samaccountname-spoofing, Potential Privileged Escalation via SamAccountName Spoofing>> | Identifies a suspicious computer account name rename event, which may indicate an attempt to exploit CVE-2021-42278 to elevate privileges from a standard domain user to a user with domain admin privileges. CVE-2021-42278 is a security vulnerability that allows potential attackers to impersonate a domain controller via samAccountName attribute spoofing. | new | 1 

|<<prebuilt-rule-0-16-1-windows-service-installed-via-an-unusual-client, Windows Service Installed via an Unusual Client>> | Identifies the creation of a Windows service by an unusual client process. Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. | new | 1 

|<<prebuilt-rule-0-16-1-aws-cloudtrail-log-created, AWS CloudTrail Log Created>> | Identifies the creation of an AWS log trail that specifies the settings for delivery of log data. | update | 6 

|<<prebuilt-rule-0-16-1-aws-cloudtrail-log-deleted, AWS CloudTrail Log Deleted>> | Identifies the deletion of an AWS log trail. An adversary may delete trails in an attempt to evade defenses. | update | 7 

|<<prebuilt-rule-0-16-1-aws-cloudwatch-alarm-deletion, AWS CloudWatch Alarm Deletion>> | Identifies the deletion of an AWS CloudWatch alarm. An adversary may delete alarms in an attempt to evade defenses. | update | 7 

|<<prebuilt-rule-0-16-1-aws-ec2-flow-log-deletion, AWS EC2 Flow Log Deletion>> | Identifies the deletion of one or more flow logs in AWS Elastic Compute Cloud (EC2). An adversary may delete flow logs in an attempt to evade defenses. | update | 7 

|<<prebuilt-rule-0-16-1-aws-ec2-network-access-control-list-deletion, AWS EC2 Network Access Control List Deletion>> | Identifies the deletion of an Amazon Elastic Compute Cloud (EC2) network access control list (ACL) or one of its ingress/egress entries. | update | 7 

|<<prebuilt-rule-0-16-1-aws-elasticache-security-group-created, AWS ElastiCache Security Group Created>> | Identifies when an ElastiCache security group has been created. | update | 2 

|<<prebuilt-rule-0-16-1-aws-elasticache-security-group-modified-or-deleted, AWS ElastiCache Security Group Modified or Deleted>> | Identifies when an ElastiCache security group has been modified or deleted. | update | 2 

|<<prebuilt-rule-0-16-1-aws-guardduty-detector-deletion, AWS GuardDuty Detector Deletion>> | Identifies the deletion of an Amazon GuardDuty detector. Upon deletion, GuardDuty stops monitoring the environment and all existing findings are lost. | update | 7 

|<<prebuilt-rule-0-16-1-aws-s3-bucket-configuration-deletion, AWS S3 Bucket Configuration Deletion>> | Identifies the deletion of various Amazon Simple Storage Service (S3) bucket configuration components. | update | 6 

|<<prebuilt-rule-0-16-1-aws-waf-access-control-list-deletion, AWS WAF Access Control List Deletion>> | Identifies the deletion of a specified AWS Web Application Firewall (WAF) access control list. | update | 7 

|<<prebuilt-rule-0-16-1-aws-waf-rule-or-rule-group-deletion, AWS WAF Rule or Rule Group Deletion>> | Identifies the deletion of a specified AWS Web Application Firewall (WAF) rule or rule group. | update | 7 

|<<prebuilt-rule-0-16-1-aws-rds-snapshot-restored, AWS RDS Snapshot Restored>> | Identifies when an attempt was made to restore an RDS Snapshot. Snapshots are sometimes shared by threat actors in order to exfiltrate bulk data. If the permissions were modified, verify if the snapshot was shared with an unauthorized or unexpected AWS account. | update | 3 

|<<prebuilt-rule-0-16-1-aws-eventbridge-rule-disabled-or-deleted, AWS EventBridge Rule Disabled or Deleted>> | Identifies when a user has disabled or deleted an EventBridge rule. This activity can result in an unintended loss of visibility in applications or a break in the flow with other AWS services. | update | 3 

|<<prebuilt-rule-0-16-1-aws-cloudwatch-log-group-deletion, AWS CloudWatch Log Group Deletion>> | Identifies the deletion of a specified AWS CloudWatch log group. When a log group is deleted, all the archived log events associated with the log group are also permanently deleted. | update | 7 

|<<prebuilt-rule-0-16-1-aws-cloudwatch-log-stream-deletion, AWS CloudWatch Log Stream Deletion>> | Identifies the deletion of an AWS CloudWatch log stream, which permanently deletes all associated archived log events with the stream. | update | 7 

|<<prebuilt-rule-0-16-1-aws-efs-file-system-or-mount-deleted, AWS EFS File System or Mount Deleted>> | Detects when a EFS File System or Mount is deleted. An adversary could break any file system using the mount target that is being deleted, which might disrupt instances or applications using those mounts. The mount must be deleted prior to deleting the File System, or the adversary will be unable to delete the File System. | update | 2 

|<<prebuilt-rule-0-16-1-aws-iam-group-deletion, AWS IAM Group Deletion>> | Identifies the deletion of a specified AWS Identity and Access Management (IAM) resource group. Deleting a resource group does not delete resources that are members of the group; it only deletes the group structure. | update | 6 

|<<prebuilt-rule-0-16-1-aws-rds-cluster-deletion, AWS RDS Cluster Deletion>> | Identifies the deletion of an Amazon Relational Database Service (RDS) Aurora database cluster or global database cluster. | update | 6 

|<<prebuilt-rule-0-16-1-aws-rds-security-group-deletion, AWS RDS Security Group Deletion>> | Identifies the deletion of an Amazon Relational Database Service (RDS) Security group. | update | 3 

|<<prebuilt-rule-0-16-1-spike-in-aws-error-messages, Spike in AWS Error Messages>> | A machine learning job detected a significant spike in the rate of a particular error in the CloudTrail messages. Spikes in error messages may accompany attempts at privilege escalation, lateral movement, or discovery. | update | 8 

|<<prebuilt-rule-0-16-1-unusual-country-for-an-aws-command, Unusual Country For an AWS Command>> | A machine learning job detected AWS command activity that, while not inherently suspicious or abnormal, is sourcing from a geolocation (country) that is unusual for the command. This can be the result of compromised credentials or keys being used by a threat actor in a different geography than the authorized user(s). | update | 8 

|<<prebuilt-rule-0-16-1-aws-ec2-network-access-control-list-creation, AWS EC2 Network Access Control List Creation>> | Identifies the creation of an AWS Elastic Compute Cloud (EC2) network access control list (ACL) or an entry in a network ACL with a specified rule number. | update | 7 

|<<prebuilt-rule-0-16-1-aws-security-group-configuration-change-detection, AWS Security Group Configuration Change Detection>> | Identifies a change to an AWS Security Group Configuration. A security group is like a virtual firewall, and modifying configurations may allow unauthorized access. Threat actors may abuse this to establish persistence, exfiltrate data, or pivot in an AWS environment. | update | 3 

|<<prebuilt-rule-0-16-1-aws-iam-group-creation, AWS IAM Group Creation>> | Identifies the creation of a group in AWS Identity and Access Management (IAM). Groups specify permissions for multiple users. Any user in a group automatically has the permissions that are assigned to the group. | update | 7 

|<<prebuilt-rule-0-16-1-aws-rds-cluster-creation, AWS RDS Cluster Creation>> | Identifies the creation of a new Amazon Relational Database Service (RDS) Aurora DB cluster or global database spread across multiple regions. | update | 7 

|<<prebuilt-rule-0-16-1-aws-rds-security-group-creation, AWS RDS Security Group Creation>> | Identifies the creation of an Amazon Relational Database Service (RDS) Security group. | update | 3 

|<<prebuilt-rule-0-16-1-aws-rds-instance-creation, AWS RDS Instance Creation>> | Identifies the creation of an Amazon Relational Database Service (RDS) Aurora database instance. | update | 3 

|<<prebuilt-rule-0-16-1-aws-route-table-created, AWS Route Table Created>> | Identifies when an AWS Route Table has been created. | update | 2 

|<<prebuilt-rule-0-16-1-aws-route-table-modified-or-deleted, AWS Route Table Modified or Deleted>> | Identifies when an AWS Route Table has been modified or deleted. | update | 2 

|<<prebuilt-rule-0-16-1-aws-saml-activity, AWS SAML Activity>> | Identifies when SAML activity has occurred in AWS. An adversary could manipulate SAML to maintain access to the target. | update | 2 

|<<prebuilt-rule-0-16-1-aws-security-token-service-sts-assumerole-usage, AWS Security Token Service (STS) AssumeRole Usage>> | Identifies the use of AssumeRole. AssumeRole returns a set of temporary security credentials that can be used to access AWS resources. An adversary could use those credentials to move laterally and escalate privileges. | update | 2 

|<<prebuilt-rule-0-16-1-azure-event-hub-deletion, Azure Event Hub Deletion>> | Identifies an Event Hub deletion in Azure. An Event Hub is an event processing service that ingests and processes large volumes of events and data. An adversary may delete an Event Hub in an attempt to evade detection. | update | 6 

|<<prebuilt-rule-0-16-1-azure-firewall-policy-deletion, Azure Firewall Policy Deletion>> | Identifies the deletion of a firewall policy in Azure. An adversary may delete a firewall policy in an attempt to evade defenses and/or to eliminate barriers to their objective. | update | 6 

|<<prebuilt-rule-0-16-1-azure-frontdoor-web-application-firewall-waf-policy-deleted, Azure Frontdoor Web Application Firewall (WAF) Policy Deleted>> | Identifies the deletion of a Frontdoor Web Application Firewall (WAF) Policy in Azure. An adversary may delete a Frontdoor Web Application Firewall (WAF) Policy in an attempt to evade defenses and/or to eliminate barriers to their objective. | update | 2 

|<<prebuilt-rule-0-16-1-azure-kubernetes-events-deleted, Azure Kubernetes Events Deleted>> | Identifies when events are deleted in Azure Kubernetes. Kubernetes events are objects that log any state changes. Example events are a container creation, an image pull, or a pod scheduling on a node.  An adversary may delete events in Azure Kubernetes in an attempt to evade detection. | update | 3 

|<<prebuilt-rule-0-16-1-azure-network-watcher-deletion, Azure Network Watcher Deletion>> | Identifies the deletion of a Network Watcher in Azure. Network Watchers are used to monitor, diagnose, view metrics, and enable or disable logs for resources in an Azure virtual network. An adversary may delete a Network Watcher in an attempt to evade defenses. | update | 6 

|<<prebuilt-rule-0-16-1-azure-kubernetes-pods-deleted, Azure Kubernetes Pods Deleted>> | Identifies the deletion of Azure Kubernetes Pods. Adversaries may delete a Kubernetes pod to disrupt the normal behavior of the environment. | update | 3 

|<<prebuilt-rule-0-16-1-azure-virtual-network-device-modified-or-deleted, Azure Virtual Network Device Modified or Deleted>> | Identifies when a virtual network device is modified or deleted. This can be a network virtual appliance, virtual hub, or virtual router. | update | 2 

|<<prebuilt-rule-0-16-1-gcp-pub-sub-subscription-creation, GCP Pub/Sub Subscription Creation>> | Identifies the creation of a subscription in Google Cloud Platform (GCP). In GCP, the publisher-subscriber relationship (Pub/Sub) is an asynchronous messaging service that decouples event-producing and event-processing services. A subscription is a named resource representing the stream of messages to be delivered to the subscribing application. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-pub-sub-topic-creation, GCP Pub/Sub Topic Creation>> | Identifies the creation of a topic in Google Cloud Platform (GCP). In GCP, the publisher-subscriber relationship (Pub/Sub) is an asynchronous messaging service that decouples event-producing and event-processing services. A topic is used to forward messages from publishers to subscribers. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-logging-bucket-deletion, GCP Logging Bucket Deletion>> | Identifies a Logging bucket deletion in Google Cloud Platform (GCP). Log buckets are containers that store and organize log data. A deleted bucket stays in a pending state for 7 days, and Logging continues to route logs to the bucket during that time. To stop routing logs to a deleted bucket, the log sinks can be deleted that have the bucket as a destination, or the filter for the sinks can be modified to stop routing logs to the deleted bucket. An adversary may delete a log bucket to evade detection. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-logging-sink-deletion, GCP Logging Sink Deletion>> | Identifies a Logging sink deletion in Google Cloud Platform (GCP). Every time a log entry arrives, Logging compares the log entry to the sinks in that resource. Each sink whose filter matches the log entry writes a copy of the log entry to the sink's export destination. An adversary may delete a Logging sink to evade detection. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-pub-sub-subscription-deletion, GCP Pub/Sub Subscription Deletion>> | Identifies the deletion of a subscription in Google Cloud Platform (GCP). In GCP, the publisher-subscriber relationship (Pub/Sub) is an asynchronous messaging service that decouples event-producing and event-processing services. A subscription is a named resource representing the stream of messages to be delivered to the subscribing application. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-pub-sub-topic-deletion, GCP Pub/Sub Topic Deletion>> | Identifies the deletion of a topic in Google Cloud Platform (GCP). In GCP, the publisher-subscriber relationship (Pub/Sub) is an asynchronous messaging service that decouples event-producing and event-processing services. A publisher application creates and sends messages to a topic. Deleting a topic can interrupt message flow in the Pub/Sub pipeline. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-iam-role-deletion, GCP IAM Role Deletion>> | Identifies an Identity and Access Management (IAM) role deletion in Google Cloud Platform (GCP). A role contains a set of permissions that allows you to perform specific actions on Google Cloud resources. An adversary may delete an IAM role to inhibit access to accounts utilized by legitimate users. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-storage-bucket-deletion, GCP Storage Bucket Deletion>> | Identifies when a Google Cloud Platform (GCP) storage bucket is deleted. An adversary may delete a storage bucket in order to disrupt their target's business operations. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-virtual-private-cloud-route-creation, GCP Virtual Private Cloud Route Creation>> | Identifies when a virtual private cloud (VPC) route is created in Google Cloud Platform (GCP). Google Cloud routes define the paths that network traffic takes from a virtual machine (VM) instance to other destinations. These destinations can be inside a Google VPC network or outside it. An adversary may create a route in order to impact the flow of network traffic in their target's cloud environment. | update | 7 

|<<prebuilt-rule-0-16-1-gcp-iam-custom-role-creation, GCP IAM Custom Role Creation>> | Identifies an Identity and Access Management (IAM) custom role creation in Google Cloud Platform (GCP). Custom roles are user-defined, and allow for the bundling of one or more supported permissions to meet specific needs. Custom roles will not be updated automatically and could lead to privilege creep if not carefully scrutinized. | update | 6 

|<<prebuilt-rule-0-16-1-gcp-iam-service-account-key-deletion, GCP IAM Service Account Key Deletion>> | Identifies the deletion of an Identity and Access Management (IAM) service account key in Google Cloud Platform (GCP). Each service account is associated with two sets of public/private RSA key pairs that are used to authenticate. If a key is deleted, the application will no longer be able to access Google Cloud resources using that key. A security best practice is to rotate your service account keys regularly. | update | 6 

|<<prebuilt-rule-0-16-1-microsoft-365-inbox-forwarding-rule-created, Microsoft 365 Inbox Forwarding Rule Created>> | Identifies when a new Inbox forwarding rule is created in Microsoft 365. Inbox rules process messages in the Inbox based on conditions and take actions. In this case, the rules will forward the emails to a defined address. Attackers can abuse Inbox Rules to intercept and exfiltrate email data while not requiring organization-wide configuration changes nor privileges to set those. | update | 2 

|<<prebuilt-rule-0-16-1-attempts-to-brute-force-a-microsoft-365-user-account, Attempts to Brute Force a Microsoft 365 User Account>> | Identifies attempts to brute force a Microsoft 365 user account. An adversary may attempt a brute force attack to obtain unauthorized access to user accounts. | update | 6 

|<<prebuilt-rule-0-16-1-potential-password-spraying-of-microsoft-365-user-accounts, Potential Password Spraying of Microsoft 365 User Accounts>> | Identifies a high number (25) of failed Microsoft 365 user authentication attempts from a single IP address within 30 minutes, which could be indicative of a password spraying attack. An adversary may attempt a password spraying attack to obtain unauthorized access to user accounts. | update | 5 

|<<prebuilt-rule-0-16-1-o365-excessive-single-sign-on-logon-errors, O365 Excessive Single Sign-On Logon Errors>> | Identifies accounts with a high number of single sign-on (SSO) logon errors. Excessive logon errors may indicate an attempt to brute force a password or SSO token. | update | 4 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-dlp-policy-removed, Microsoft 365 Exchange DLP Policy Removed>> | Identifies when a Data Loss Prevention (DLP) policy is removed in Microsoft 365. An adversary may remove a DLP policy to evade existing DLP monitoring. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-malware-filter-policy-deletion, Microsoft 365 Exchange Malware Filter Policy Deletion>> | Identifies when a malware filter policy has been deleted in Microsoft 365. A malware filter policy is used to alert administrators that an internal user sent a message that contained malware. This may indicate an account or machine compromise that would need to be investigated. Deletion of a malware filter policy may be done to evade detection. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-malware-filter-rule-modification, Microsoft 365 Exchange Malware Filter Rule Modification>> | Identifies when a malware filter rule has been deleted or disabled in Microsoft 365. An adversary or insider threat may want to modify a malware filter rule to evade detection. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-safe-attachment-rule-disabled, Microsoft 365 Exchange Safe Attachment Rule Disabled>> | Identifies when a safe attachment rule is disabled in Microsoft 365. Safe attachment rules can extend malware protections to include routing all messages and attachments without a known malware signature to a special hypervisor environment. An adversary or insider threat may disable a safe attachment rule to exfiltrate data or evade defenses. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-transport-rule-creation, Microsoft 365 Exchange Transport Rule Creation>> | Identifies a transport rule creation in Microsoft 365. Exchange Online mail transport rules should be set to not forward email to domains outside of your organization as a best practice. An adversary may create transport rules to exfiltrate data. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-transport-rule-modification, Microsoft 365 Exchange Transport Rule Modification>> | Identifies when a transport rule has been disabled or deleted in Microsoft 365. Mail flow rules (also known as transport rules) are used to identify and take action on messages that flow through your organization. An adversary or insider threat may modify a transport rule to exfiltrate data or evade defenses. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-potential-ransomware-activity, Microsoft 365 Potential ransomware activity>> | Identifies when Microsoft Cloud App Security reports that a user has uploaded files to the cloud that might be infected with ransomware. | update | 3 

|<<prebuilt-rule-0-16-1-microsoft-365-unusual-volume-of-file-deletion, Microsoft 365 Unusual Volume of File Deletion>> | Identifies that a user has deleted an unusually large volume of files as reported by Microsoft Cloud App Security. | update | 2 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-anti-phish-policy-deletion, Microsoft 365 Exchange Anti-Phish Policy Deletion>> | Identifies the deletion of an anti-phishing policy in Microsoft 365. By default, Microsoft 365 includes built-in features that help protect users from phishing attacks. Anti-phishing polices increase this protection by refining settings to better detect and prevent attacks. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-anti-phish-rule-modification, Microsoft 365 Exchange Anti-Phish Rule Modification>> | Identifies the modification of an anti-phishing rule in Microsoft 365. By default, Microsoft 365 includes built-in features that help protect users from phishing attacks. Anti-phishing rules increase this protection by refining settings to better detect and prevent attacks. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-safe-link-policy-disabled, Microsoft 365 Exchange Safe Link Policy Disabled>> | Identifies when a Safe Link policy is disabled in Microsoft 365. Safe Link policies for Office applications extend phishing protection to documents that contain hyperlinks, even after they have been delivered to a user. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-user-restricted-from-sending-email, Microsoft 365 User Restricted from Sending Email>> | Identifies when a user has been restricted from sending email due to exceeding sending limits of the service policies per the Security Compliance Center. | update | 2 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-dkim-signing-configuration-disabled, Microsoft 365 Exchange DKIM Signing Configuration Disabled>> | Identifies when a DomainKeys Identified Mail (DKIM) signing configuration is disabled in Microsoft 365. With DKIM in Microsoft 365, messages that are sent from Exchange Online will be cryptographically signed. This will allow the receiving email system to validate that the messages were generated by a server that the organization authorized and not being spoofed. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-teams-custom-application-interaction-allowed, Microsoft 365 Teams Custom Application Interaction Allowed>> | Identifies when custom applications are allowed in Microsoft Teams. If an organization requires applications other than those available in the Teams app store, custom applications can be developed as packages and uploaded. An adversary may abuse this behavior to establish persistence in an environment. | update | 5 

|<<prebuilt-rule-0-16-1-o365-exchange-suspicious-mailbox-right-delegation, O365 Exchange Suspicious Mailbox Right Delegation>> | Identifies the assignment of rights to access content from another mailbox. An adversary may use the compromised account to send messages to other accounts in the network of the target organization while creating inbox rules, so messages can evade spam/phishing detection mechanisms. | update | 2 

|<<prebuilt-rule-0-16-1-microsoft-365-exchange-management-group-role-assignment, Microsoft 365 Exchange Management Group Role Assignment>> | Identifies when a new role is assigned to a management group in Microsoft 365. An adversary may attempt to add a role in order to maintain persistence in an environment. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-teams-external-access-enabled, Microsoft 365 Teams External Access Enabled>> | Identifies when external access is enabled in Microsoft Teams. External access lets Teams and Skype for Business users communicate with other users that are outside their organization. An adversary may enable external access or add an allowed domain to exfiltrate data or maintain persistence in an environment. | update | 5 

|<<prebuilt-rule-0-16-1-microsoft-365-teams-guest-access-enabled, Microsoft 365 Teams Guest Access Enabled>> | Identifies when guest access is enabled in Microsoft Teams. Guest access in Teams allows people outside the organization to access teams and channels. An adversary may enable guest access to maintain persistence in an environment. | update | 5 

|<<prebuilt-rule-0-16-1-new-or-modified-federation-domain, New or Modified Federation Domain>> | Identifies a new or modified federation domain, which can be used to create a trust between O365 and an external identity provider. | update | 2 

|<<prebuilt-rule-0-16-1-unauthorized-access-to-an-okta-application, Unauthorized Access to an Okta Application>> | Identifies unauthorized access attempts to Okta applications. | update | 2 

|<<prebuilt-rule-0-16-1-launchdaemon-creation-or-modification-and-immediate-loading, LaunchDaemon Creation or Modification and Immediate Loading>> | Adversaries may create or modify launch daemons to repeatedly execute malicious payloads as part of persistence. | update | 3 

|<<prebuilt-rule-0-16-1-persistence-via-folder-action-script, Persistence via Folder Action Script>> | A Folder Action script is executed when the folder to which it is attached has items added or removed, or when its window is opened, closed, moved, or resized. Adversaries may abuse this feature to establish persistence by utilizing a malicious script. | update | 4 

|<<prebuilt-rule-0-16-1-unexpected-child-process-of-macos-screensaver-engine, Unexpected Child Process of macOS Screensaver Engine>> | Identifies when a child process is spawned by the screensaver engine process, which is consistent with an attacker's malicious payload being executed after the screensaver activated on the endpoint. An adversary can maintain persistence on a macOS endpoint by creating a malicious screensaver (.saver) file and configuring the screensaver plist file to execute code each time the screensaver is activated. | update | 2 

|<<prebuilt-rule-0-16-1-unusual-process-for-a-windows-host, Unusual Process For a Windows Host>> | Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host. | update | 9 

|<<prebuilt-rule-0-16-1-adversary-behavior-detected-elastic-endgame, Adversary Behavior - Detected - Elastic Endgame>> | Elastic Endgame detected an Adversary Behavior. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-credential-dumping-detected-elastic-endgame, Credential Dumping - Detected - Elastic Endgame>> | Elastic Endgame detected Credential Dumping. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-credential-dumping-prevented-elastic-endgame, Credential Dumping - Prevented - Elastic Endgame>> | Elastic Endgame prevented Credential Dumping. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-credential-manipulation-detected-elastic-endgame, Credential Manipulation - Detected - Elastic Endgame>> | Elastic Endgame detected Credential Manipulation. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-credential-manipulation-prevented-elastic-endgame, Credential Manipulation - Prevented - Elastic Endgame>> | Elastic Endgame prevented Credential Manipulation. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-exploit-detected-elastic-endgame, Exploit - Detected - Elastic Endgame>> | Elastic Endgame detected an Exploit. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-exploit-prevented-elastic-endgame, Exploit - Prevented - Elastic Endgame>> | Elastic Endgame prevented an Exploit. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-malware-detected-elastic-endgame, Malware - Detected - Elastic Endgame>> | Elastic Endgame detected Malware. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-malware-prevented-elastic-endgame, Malware - Prevented - Elastic Endgame>> | Elastic Endgame prevented Malware. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-permission-theft-detected-elastic-endgame, Permission Theft - Detected - Elastic Endgame>> | Elastic Endgame detected Permission Theft. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-permission-theft-prevented-elastic-endgame, Permission Theft - Prevented - Elastic Endgame>> | Elastic Endgame prevented Permission Theft. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-process-injection-detected-elastic-endgame, Process Injection - Detected - Elastic Endgame>> | Elastic Endgame detected Process Injection. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-process-injection-prevented-elastic-endgame, Process Injection - Prevented - Elastic Endgame>> | Elastic Endgame prevented Process Injection. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 7 

|<<prebuilt-rule-0-16-1-ransomware-detected-elastic-endgame, Ransomware - Detected - Elastic Endgame>> | Elastic Endgame detected ransomware. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 8 

|<<prebuilt-rule-0-16-1-ransomware-prevented-elastic-endgame, Ransomware - Prevented - Elastic Endgame>> | Elastic Endgame prevented ransomware. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information. | update | 8 

|<<prebuilt-rule-0-16-1-powershell-suspicious-script-with-audio-capture-capabilities, PowerShell Suspicious Script with Audio Capture Capabilities>> | Detects PowerShell scripts that can record audio, a common feature in popular post-exploitation tooling. | update | 4 

|<<prebuilt-rule-0-16-1-powershell-keylogging-script, PowerShell Keylogging Script>> | Detects the use of Win32 API Functions that can be used to capture user keystrokes in PowerShell scripts. Attackers use this technique to capture user input, looking for credentials and/or other valuable data. | update | 3 

|<<prebuilt-rule-0-16-1-connection-to-commonly-abused-web-services, Connection to Commonly Abused Web Services>> | Adversaries may implement command and control communications that use common web services in order to hide their activity. This attack technique is typically targeted to an organization and uses web services common to the victim network which allows the adversary to blend into legitimate traffic. activity. These popular services are typically targeted since they have most likely been used before a compromise and allow adversaries to blend in the network. | update | 7 

|<<prebuilt-rule-0-16-1-potential-command-and-control-via-internet-explorer, Potential Command and Control via Internet Explorer>> | Identifies instances of Internet Explorer (iexplore.exe) being started via the Component Object Model (COM) making unusual network connections. Adversaries could abuse Internet Explorer via COM to avoid suspicious processes making network connections and bypass host-based firewall restrictions. | update | 5 

|<<prebuilt-rule-0-16-1-port-forwarding-rule-addition, Port Forwarding Rule Addition>> | Identifies the creation of a new port forwarding rule. An adversary may abuse this technique to bypass network segmentation restrictions. | update | 5 

|<<prebuilt-rule-0-16-1-kerberos-traffic-from-unusual-process, Kerberos Traffic from Unusual Process>> | Identifies network connections to the standard Kerberos port from an unusual process. On Windows, the only process that normally performs Kerberos traffic from a domain joined host is lsass.exe. | update | 5 

|<<prebuilt-rule-0-16-1-modification-of-wdigest-security-provider, Modification of WDigest Security Provider>> | Identifies attempts to modify the WDigest security provider in the registry to force the user's password to be stored in clear text in memory. This behavior can be indicative of an adversary attempting to weaken the security configuration of an endpoint. Once the UseLogonCredential value is modified, the adversary may attempt to dump clear text passwords from memory. | update | 2 

|<<prebuilt-rule-0-16-1-network-logon-provider-registry-modification, Network Logon Provider Registry Modification>> | Adversaries may register a rogue network logon provider module for persistence and/or credential access via intercepting the authentication credentials in clear text during user logon. | update | 2 

|<<prebuilt-rule-0-16-1-powershell-minidump-script, PowerShell MiniDump Script>> | This rule detects PowerShell scripts capable of dumping process memory using WindowsErrorReporting or Dbghelp.dll MiniDumpWriteDump. Attackers can use this tooling to dump LSASS and get access to credentials. | update | 5 

|<<prebuilt-rule-0-16-1-potential-credential-access-via-renamed-com-services-dll, Potential Credential Access via Renamed COM+ Services DLL>> | Identifies suspicious renamed COMSVCS.DLL Image Load, which exports the MiniDump function that can be used to dump a process memory. This may indicate an attempt to dump LSASS memory while bypassing command-line based detection in preparation for credential access. | update | 2 

|<<prebuilt-rule-0-16-1-potential-credential-access-via-lsass-memory-dump, Potential Credential Access via LSASS Memory Dump>> | Identifies suspicious access to LSASS handle from a call trace pointing to DBGHelp.dll or DBGCore.dll, which both export the MiniDumpWriteDump method that can be used to dump LSASS memory content in preparation for credential access. | update | 3 

|<<prebuilt-rule-0-16-1-potential-lsass-memory-dump-via-psscapturesnapshot, Potential LSASS Memory Dump via PssCaptureSnapShot>> | Identifies suspicious access to an LSASS handle via PssCaptureSnapShot where two successive process accesses are performed by the same process and targeting two different instances of LSASS. This may indicate an attempt to evade detection and dump LSASS memory for credential access. | update | 2 

|<<prebuilt-rule-0-16-1-modification-of-amsienable-registry-key, Modification of AmsiEnable Registry Key>> | JScript tries to query the AmsiEnable registry key from the HKEY_USERS registry hive before initializing Antimalware Scan Interface (AMSI). If this key is set to 0, AMSI is not enabled for the JScript process. An adversary can modify this key to disable AMSI protections. | update | 3 

|<<prebuilt-rule-0-16-1-windows-defender-disabled-via-registry-modification, Windows Defender Disabled via Registry Modification>> | Identifies modifications to the Windows Defender registry settings to disable the service or set the service to be started manually. | update | 4 

|<<prebuilt-rule-0-16-1-windows-defender-exclusions-added-via-powershell, Windows Defender Exclusions Added via PowerShell>> | Identifies modifications to the Windows Defender configuration settings using PowerShell to add exclusions at the folder directory or process level. | update | 6 

|<<prebuilt-rule-0-16-1-encoded-executable-stored-in-the-registry, Encoded Executable Stored in the Registry>> | Identifies registry write modifications to hide an encoded portable executable. This could be indicative of adversary defense evasion by avoiding the storing of malicious content directly on disk. | update | 5 

|<<prebuilt-rule-0-16-1-program-files-directory-masquerading, Program Files Directory Masquerading>> | Identifies execution from a directory masquerading as the Windows Program Files directories. These paths are trusted and usually host trusted third party programs. An adversary may leverage masquerading, along with low privileges to bypass detections allowlisting those folders. | update | 6 

|<<prebuilt-rule-0-16-1-suspicious-net-reflection-via-powershell, Suspicious .NET Reflection via PowerShell>> | Detects the use of Reflection.Assembly to load PEs and DLLs in memory in PowerShell scripts. Attackers use this method to load executables and DLLs without writing to the disk, bypassing security solutions. | update | 2 

|<<prebuilt-rule-0-16-1-potential-process-injection-via-powershell, Potential Process Injection via PowerShell>> | Detects the use of Windows API functions that are commonly abused by malware and security tools to load malicious code or inject it into remote processes. | update | 3 

|<<prebuilt-rule-0-16-1-windows-firewall-disabled-via-powershell, Windows Firewall Disabled via PowerShell>> | Identifies when the Windows Firewall is disabled using PowerShell cmdlets, which attackers do to evade network constraints, like internet and network lateral communication restrictions. | update | 3 

|<<prebuilt-rule-0-16-1-scheduled-tasks-at-command-enabled, Scheduled Tasks AT Command Enabled>> | Identifies attempts to enable the Windows scheduled tasks AT command via the registry. Attackers may use this method to move laterally or persist locally. The AT command has been deprecated since Windows 8 and Windows Server 2012, but still exists for backwards compatibility. | update | 4 

|<<prebuilt-rule-0-16-1-sip-provider-modification, SIP Provider Modification>> | Identifies modifications to the registered Subject Interface Package (SIP) providers. SIP providers are used by the Windows cryptographic system to validate file signatures on the system. This may be an attempt to bypass signature validation checks or inject code into critical processes. | update | 2 

|<<prebuilt-rule-0-16-1-solarwinds-process-disabling-services-via-registry, SolarWinds Process Disabling Services via Registry>> | Identifies a SolarWinds binary modifying the start type of a service to be disabled. An adversary may abuse this technique to manipulate relevant security services. | update | 4 

|<<prebuilt-rule-0-16-1-suspicious-wmic-xsl-script-execution, Suspicious WMIC XSL Script Execution>> | Identifies WMIC allowlist bypass techniques by alerting on suspicious execution of scripts. When WMIC loads scripting libraries it may be indicative of an allowlist bypass. | update | 3 

|<<prebuilt-rule-0-16-1-whitespace-padding-in-process-command-line, Whitespace Padding in Process Command Line>> | Identifies process execution events where the command line value contains a long sequence of whitespace characters or multiple occurrences of contiguous whitespace. Attackers may attempt to evade signature-based detections by padding their malicious command with unnecessary whitespace characters. These observations should be investigated for malicious behavior. | update | 4 

|<<prebuilt-rule-0-16-1-adfind-command-activity, AdFind Command Activity>> | This rule detects the Active Directory query tool, AdFind.exe. AdFind has legitimate purposes, but it is frequently leveraged by threat actors to perform post-exploitation Active Directory reconnaissance. The AdFind tool has been observed in Trickbot, Ryuk, Maze, and FIN6 campaigns. For Winlogbeat, this rule requires Sysmon. | update | 6 

|<<prebuilt-rule-0-16-1-net-command-via-system-account, Net command via SYSTEM account>> | Identifies the SYSTEM account using an account discovery utility. This could be a sign of discovery activity after an adversary has achieved privilege escalation. | update | 9 

|<<prebuilt-rule-0-16-1-powershell-suspicious-discovery-related-windows-api-functions, PowerShell Suspicious Discovery Related Windows API Functions>> | This rule detects the use of discovery-related Windows API functions in PowerShell Scripts. Attackers can use these functions to perform various situational awareness related activities, like enumerating users, shares, sessions, domain trusts, groups, etc. | update | 4 

|<<prebuilt-rule-0-16-1-external-ip-lookup-from-non-browser-process, External IP Lookup from Non-Browser Process>> | Identifies domains commonly used by adversaries for post-exploitation IP lookups. It is common for adversaries to test for Internet access and acquire their external IP address after they have gained access to a system. Among others, this has been observed in campaigns leveraging the information stealer, Trickbot. | update | 7 

|<<prebuilt-rule-0-16-1-enumeration-of-privileged-local-groups-membership, Enumeration of Privileged Local Groups Membership>> | Identifies instances of an unusual process enumerating built-in Windows privileged local groups membership like Administrators or Remote Desktop users. | update | 2 

|<<prebuilt-rule-0-16-1-suspicious-portable-executable-encoded-in-powershell-script, Suspicious Portable Executable Encoded in Powershell Script>> | Detects the presence of portable executables (PE) in a PowerShell script by looking for its encoded header. Attackers embed PEs into PowerShell scripts for injecting them into the memory, avoiding defenses by not writing to disk. | update | 4 

|<<prebuilt-rule-0-16-1-network-connection-via-registration-utility, Network Connection via Registration Utility>> | Identifies the native Windows tools regsvr32.exe, regsvr64.exe, RegSvcs.exe, or RegAsm.exe making a network connection. This may be indicative of an attacker bypassing allowlists or running arbitrary scripts via a signed Microsoft binary. | update | 10 

|<<prebuilt-rule-0-16-1-volume-shadow-copy-deleted-or-resized-via-vssadmin, Volume Shadow Copy Deleted or Resized via VssAdmin>> | Identifies use of vssadmin.exe for shadow copy deletion or resizing on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks. | update | 11 

|<<prebuilt-rule-0-16-1-incoming-dcom-lateral-movement-via-mshta, Incoming DCOM Lateral Movement via MSHTA>> | Identifies the use of Distributed Component Object Model (DCOM) to execute commands from a remote host, which are launched via the HTA Application COM Object. This behavior may indicate an attacker abusing a DCOM application to move laterally while attempting to evading detection. | update | 5 

|<<prebuilt-rule-0-16-1-incoming-dcom-lateral-movement-with-mmc, Incoming DCOM Lateral Movement with MMC>> | Identifies the use of Distributed Component Object Model (DCOM) to run commands from a remote host, which are launched via the MMC20 Application COM Object. This behavior may indicate an attacker abusing a DCOM application to move laterally. | update | 5 

|<<prebuilt-rule-0-16-1-incoming-dcom-lateral-movement-with-shellbrowserwindow-or-shellwindows, Incoming DCOM Lateral Movement with ShellBrowserWindow or ShellWindows>> | Identifies use of Distributed Component Object Model (DCOM) to run commands from a remote host, which are launched via the ShellBrowserWindow or ShellWindows Application COM Object. This behavior may indicate an attacker abusing a DCOM application to stealthily move laterally. | update | 5 

|<<prebuilt-rule-0-16-1-nullsessionpipe-registry-modification, NullSessionPipe Registry Modification>> | Identifies NullSessionPipe registry modifications that specify which pipes can be accessed anonymously. This could be indicative of adversary lateral movement preparation by making the added pipe available to everyone. | update | 2 

|<<prebuilt-rule-0-16-1-abnormally-large-dns-response, Abnormally Large DNS Response>> | Specially crafted DNS requests can manipulate a known overflow vulnerability in some Windows DNS servers which result in Remote Code Execution (RCE) or a Denial of Service (DoS) from crashing the service. | update | 6 

|<<prebuilt-rule-0-16-1-lateral-tool-transfer, Lateral Tool Transfer>> | Identifies the creation or change of a Windows executable file over network shares. Adversaries may transfer tools or other files between systems in a compromised environment. | update | 4 

|<<prebuilt-rule-0-16-1-incoming-execution-via-winrm-remote-shell, Incoming Execution via WinRM Remote Shell>> | Identifies remote execution via Windows Remote Management (WinRM) remote shell on a target host. This could be an indication of lateral movement. | update | 4 

|<<prebuilt-rule-0-16-1-wmi-incoming-lateral-movement, WMI Incoming Lateral Movement>> | Identifies processes executed via Windows Management Instrumentation (WMI) on a remote host. This could be indicative of adversary lateral movement, but could be noisy if administrators use WMI to remotely manage hosts. | update | 4 

|<<prebuilt-rule-0-16-1-incoming-execution-via-powershell-remoting, Incoming Execution via PowerShell Remoting>> | Identifies remote execution via Windows PowerShell remoting. Windows PowerShell remoting allows for running any Windows PowerShell command on one or more remote computers. This could be an indication of lateral movement. | update | 4 

|<<prebuilt-rule-0-16-1-rdp-enabled-via-registry, RDP Enabled via Registry>> | Identifies registry write modifications to enable Remote Desktop Protocol (RDP) access. This could be indicative of adversary lateral movement preparation. | update | 5 

|<<prebuilt-rule-0-16-1-potential-sharprdp-behavior, Potential SharpRDP Behavior>> | Identifies potential behavior of SharpRDP, which is a tool that can be used to perform authenticated command execution against a remote target via Remote Desktop Protocol (RDP) for the purposes of lateral movement. | update | 6 

|<<prebuilt-rule-0-16-1-remotely-started-services-via-rpc, Remotely Started Services via RPC>> | Identifies remote execution of Windows services over remote procedure call (RPC). This could be indicative of lateral movement, but will be noisy if commonly done by administrators." | update | 4 

|<<prebuilt-rule-0-16-1-remote-scheduled-task-creation, Remote Scheduled Task Creation>> | Identifies remote scheduled task creations on a target host. This could be indicative of adversary lateral movement. | update | 7 

|<<prebuilt-rule-0-16-1-service-control-spawned-via-script-interpreter, Service Control Spawned via Script Interpreter>> | Identifies Service Control (sc.exe) spawning from script interpreter processes to create, modify, or start services. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins. | update | 10 

|<<prebuilt-rule-0-16-1-registry-persistence-via-appcert-dll, Registry Persistence via AppCert DLL>> | Detects attempts to maintain persistence by creating registry keys using AppCert DLLs. AppCert DLLs are loaded by every process using the common API functions to create processes. | update | 4 

|<<prebuilt-rule-0-16-1-image-file-execution-options-injection, Image File Execution Options Injection>> | The Debugger and SilentProcessExit registry keys can allow an adversary to intercept the execution of files, causing a different process to be executed. This functionality can be abused by an adversary to establish persistence. | update | 5 

|<<prebuilt-rule-0-16-1-suspicious-startup-shell-folder-modification, Suspicious Startup Shell Folder Modification>> | Identifies suspicious startup shell folder modifications to change the default Startup directory in order to bypass detections monitoring file creation in the Windows Startup folder. | update | 4 

|<<prebuilt-rule-0-16-1-local-scheduled-task-creation, Local Scheduled Task Creation>> | A scheduled task can be used by an adversary to establish persistence, move laterally, and/or escalate privileges. | update | 10 

|<<prebuilt-rule-0-16-1-uncommon-registry-persistence-change, Uncommon Registry Persistence Change>> | Detects changes to registry persistence keys that are uncommonly used or modified by legitimate programs. This could be an indication of an adversary's attempt to persist in a stealthy manner. | update | 5 

|<<prebuilt-rule-0-16-1-account-password-reset-remotely, Account Password Reset Remotely>> | Identifies an attempt to reset an account password remotely. Adversaries may manipulate account passwords to maintain access or evade password duration policies and preserve compromised credentials. | update | 2 

|<<prebuilt-rule-0-16-1-startup-or-run-key-registry-modification, Startup or Run Key Registry Modification>> | Identifies run key or startup key registry modifications. In order to survive reboots and other system interrupts, attackers will modify run keys within the registry or leverage startup folder items as a form of persistence. | update | 5 

|<<prebuilt-rule-0-16-1-unusual-persistence-via-services-registry, Unusual Persistence via Services Registry>> | Identifies processes modifying the services registry key directly, instead of through the expected Windows APIs. This could be an indication of an adversary attempting to stealthily persist through abnormal service creation or modification of an existing service. | update | 5 

|<<prebuilt-rule-0-16-1-component-object-model-hijacking, Component Object Model Hijacking>> | Identifies Component Object Model (COM) hijacking via registry modification. Adversaries may establish persistence by executing malicious content triggered by hijacked references to COM objects. | update | 6 

|<<prebuilt-rule-0-16-1-suspicious-imagepath-service-creation, Suspicious ImagePath Service Creation>> | Identifies the creation of a suspicious ImagePath value. This could be an indication of an adversary attempting to stealthily persist or escalate privileges through abnormal service creation. | update | 4 

|<<prebuilt-rule-0-16-1-potential-persistence-via-time-provider-modification, Potential Persistence via Time Provider Modification>> | Windows operating systems are utilizing the time provider architecture in order to obtain accurate time stamps from other network devices or clients in the network. Time providers are implemented in the form of a DLL file which resides in System32 folder. The service W32Time initiates during the startup of Windows and loads w32time.dll. Adversaries may abuse this architecture to establish persistence, specifically by registering and enabling a malicious DLL as a time provider. | update | 2 

|<<prebuilt-rule-0-16-1-persistence-via-hidden-run-key-detected, Persistence via Hidden Run Key Detected>> | Identifies a persistence mechanism that utilizes the NtSetValueKey native API to create a hidden (null terminated) registry key. An adversary may use this method to hide from system utilities such as the Registry Editor (regedit). | update | 4 

|<<prebuilt-rule-0-16-1-installation-of-security-support-provider, Installation of Security Support Provider>> | Identifies registry modifications related to the Windows Security Support Provider (SSP) configuration. Adversaries may abuse this to establish persistence in an environment. | update | 4 

|<<prebuilt-rule-0-16-1-persistence-via-wmi-standard-registry-provider, Persistence via WMI Standard Registry Provider>> | Identifies use of the Windows Management Instrumentation StdRegProv (registry provider) to modify commonly abused registry locations for persistence. | update | 2 

|<<prebuilt-rule-0-16-1-disabling-user-account-control-via-registry-modification, Disabling User Account Control via Registry Modification>> | User Account Control (UAC) can help mitigate the impact of malware on Windows hosts. With UAC, apps and tasks always run in the security context of a non-administrator account, unless an administrator specifically authorizes administrator-level access to the system. This rule identifies registry value changes to bypass User Access Control (UAC) protection. | update | 3 

|<<prebuilt-rule-0-16-1-potential-lsa-authentication-package-abuse, Potential LSA Authentication Package Abuse>> | Adversaries can use the autostart mechanism provided by the Local Security Authority (LSA) authentication packages for privilege escalation or persistence by placing a reference to a binary in the Windows registry. The binary will then be executed by SYSTEM when the authentication packages are loaded. | update | 2 

|<<prebuilt-rule-0-16-1-potential-port-monitor-or-print-processor-registration-abuse, Potential Port Monitor or Print Processor Registration Abuse>> | Identifies port monitor and print processor registry modifications. Adversaries may abuse port monitor and print processors to run malicious DLLs during system boot that will be executed as SYSTEM for privilege escalation and/or persistence, if permissions allow writing a fully-qualified pathname for that DLL. | update | 2 

|<<prebuilt-rule-0-16-1-potential-printnightmare-exploit-registry-modification, Potential PrintNightmare Exploit Registry Modification>> | Detects attempts to exploit privilege escalation vulnerabilities related to the Print Spooler service. For more information refer to CVE-2021-34527 and verify that the impacted system is investigated. | update | 2 

|<<prebuilt-rule-0-16-1-suspicious-print-spooler-point-and-print-dll, Suspicious Print Spooler Point and Print DLL>> | Detects attempts to exploit a privilege escalation vulnerability (CVE-2020-1030) related to the print spooler service. Exploitation involves chaining multiple primitives to load an arbitrary DLL into the print spooler process running as SYSTEM. | update | 3 

|<<prebuilt-rule-0-16-1-privilege-escalation-via-windir-environment-variable, Privilege Escalation via Windir Environment Variable>> | Identifies a privilege escalation attempt via a rogue Windows directory (Windir) environment variable. This is a known primitive that is often combined with other vulnerabilities to elevate privileges. | update | 4 

|<<prebuilt-rule-0-16-1-unusual-print-spooler-child-process, Unusual Print Spooler Child Process>> | Detects unusual Print Spooler service (spoolsv.exe) child processes. This may indicate an attempt to exploit privilege escalation vulnerabilities related to the Printing Service on Windows. | update | 3 

|==============================================
