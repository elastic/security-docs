[[prebuilt-rule-8-13-12-prebuilt-rules-8-13-12-summary]]
[role="xpack"]
== Update v8.13.12

This section lists all updates associated with version 8.13.12 of the Fleet integration *Prebuilt Security Detection Rules*.


[width="100%",options="header"]
|==============================================
|Rule |Description |Status |Version

|<<prebuilt-rule-8-13-12-aws-rds-db-snapshot-shared-with-another-account, AWS RDS DB Snapshot Shared with Another Account>> | Identifies an AWS RDS DB snapshot being shared with another AWS account. DB snapshots contain a full backup of an entire DB instance including sensitive data that can be abused if shared with unauthorized accounts or made public. Adversaries may use snapshots to restore a DB Instance in an environment they control as a means of data exfiltration. | new | 1 

|<<prebuilt-rule-8-13-12-aws-rds-db-instance-or-cluster-deletion-protection-disabled, AWS RDS DB Instance or Cluster Deletion Protection Disabled>> | Identifies the modification of an AWS RDS DB instance or cluster to remove the deletionProtection feature. Deletion protection is enabled automatically for instances set up through the console and can be used to protect them from unintentional deletion activity. If disabled an instance or cluster can be deleted, destroying sensitive or critical information. Adversaries with the proper permissions can take advantage of this to set up future deletion events against a compromised environment. | new | 1 

|<<prebuilt-rule-8-13-12-aws-rds-snapshot-deleted, AWS RDS Snapshot Deleted>> | Identifies the deletion of an AWS RDS DB snapshot. Snapshots contain a full backup of an entire DB instance. Unauthorized deletion of snapshots can make it impossible to recover critical or sensitive data. This rule detects deleted snapshots and instances modified so that backupRetentionPeriod is set to 0 which disables automated backups and is functionally similar to deleting the system snapshot. | new | 1 

|<<prebuilt-rule-8-13-12-aws-s3-object-encryption-using-external-kms-key, AWS S3 Object Encryption Using External KMS Key>> | Identifies `CopyObject` events within an S3 bucket using an AWS KMS key from an external account for encryption. Adversaries with access to a misconfigured S3 bucket and the proper permissions may encrypt objects with an external KMS key to deny their victims access to their own data. | new | 1 

|<<prebuilt-rule-8-13-12-aws-rds-db-instance-or-cluster-password-modified, AWS RDS DB Instance or Cluster Password Modified>> | Identifies the modification of the master password for an AWS RDS DB instance or cluster. DB instances may contain sensitive data that can be abused if accessed by unauthorized actors. Amazon RDS API operations never return the password, so this operation provides a means to regain access if the password is lost. Adversaries with the proper permissions can take advantage of this to evade defenses and gain unauthorized access to a DB instance or cluster to support persistence mechanisms or privilege escalation. | new | 1 

|<<prebuilt-rule-8-13-12-aws-rds-db-instance-made-public, AWS RDS DB Instance Made Public>> | Identifies the creation or modification of an AWS RDS DB instance to enable public access. DB instances may contain sensitive data that can be abused if shared with unauthorized accounts or made public. Adversaries may enable public access on a DB instance to maintain persistence or evade defenses by bypassing access controls. | new | 1 

|<<prebuilt-rule-8-13-12-entra-id-device-code-auth-with-broker-client, Entra ID Device Code Auth with Broker Client>> | Identifies device code authentication with an Azure broker client for Entra ID. Adversaries abuse Primary Refresh Tokens (PRTs) to bypass multi-factor authentication (MFA) and gain unauthorized access to Azure resources. PRTs are used in Conditional Access policies to enforce device-based controls. Compromising PRTs allows attackers to bypass these policies and gain unauthorized access. This rule detects successful sign-ins using device code authentication with the Entra ID broker client application ID (29d9ed98-a469-4536-ade2-f981bc1d605e). | new | 1 

|<<prebuilt-rule-8-13-12-shadow-file-modification, Shadow File Modification>> | This rule monitors for Linux Shadow file modifications. These modifications are indicative of a potential password change or user addition event. Threat actors may attempt to create new users or change the password of a user account to maintain access to a system. | new | 1 

|<<prebuilt-rule-8-13-12-sensitive-registry-hive-access-via-regback, Sensitive Registry Hive Access via RegBack>> | Identifies attempts to access sensitive registry hives which contain credentials from the registry backup folder. | new | 1 

|<<prebuilt-rule-8-13-12-potential-powershell-obfuscated-script, Potential PowerShell Obfuscated Script>> | Identifies scripts that contain patterns and known methods that obfuscate PowerShell code. Attackers can use obfuscation techniques to bypass PowerShell security protections such as Antimalware Scan Interface (AMSI). | new | 1 

|<<prebuilt-rule-8-13-12-tampering-of-shell-command-line-history, Tampering of Shell Command-Line History>> | Adversaries may attempt to clear or disable the Bash command-line history in an attempt to evade detection or forensic investigations. | update | 106 

|<<prebuilt-rule-8-13-12-aws-rds-db-instance-restored, AWS RDS DB Instance Restored>> | An adversary with a set of compromised credentials may attempt to make copies of running or deleted RDS databases in order to evade defense mechanisms or access data. This rule identifies successful attempts to restore a DB instance using the RDS `RestoreDBInstanceFromDBSnapshot` or `RestoreDBInstanceFromS3` API operations. | update | 207 

|<<prebuilt-rule-8-13-12-potential-aws-s3-bucket-ransomware-note-uploaded, Potential AWS S3 Bucket Ransomware Note Uploaded>> | Identifies potential ransomware note being uploaded to an AWS S3 bucket. This rule detects the `PutObject` S3 API call with a common ransomware note file extension such as `.ransom`, or `.lock`. Adversaries with access to a misconfigured S3 bucket may retrieve, delete, and replace objects with ransom notes to extort victims. | update | 2 

|<<prebuilt-rule-8-13-12-google-workspace-restrictions-for-marketplace-modified-to-allow-any-app, Google Workspace Restrictions for Marketplace Modified to Allow Any App>> | Detects when the Google Marketplace restrictions are changed to allow any application for users in Google Workspace. Malicious APKs created by adversaries may be uploaded to the Google marketplace but not installed on devices managed within Google Workspace. Administrators should set restrictions to not allow any application from the marketplace for security reasons. Adversaries may enable any app to be installed and executed on mobile devices within a Google Workspace environment prior to distributing the malicious APK to the end user. | update | 107 

|<<prebuilt-rule-8-13-12-google-workspace-object-copied-to-external-drive-with-app-consent, Google Workspace Object Copied to External Drive with App Consent>> | Detects when a user copies a Google spreadsheet, form, document or script from an external drive. Sequence logic has been added to also detect when a user grants a custom Google application permission via OAuth shortly after. An adversary may send a phishing email to the victim with a Drive object link where "copy" is included in the URI, thus copying the object to the victim's drive. If a container-bound script exists within the object, execution will require permission access via OAuth in which the user has to accept. | update | 5 

|<<prebuilt-rule-8-13-12-google-workspace-api-access-granted-via-domain-wide-delegation, Google Workspace API Access Granted via Domain-Wide Delegation>> | Detects when a domain-wide delegation of authority is granted to a service account. Domain-wide delegation can be configured to grant third-party and internal applications to access the data of Google Workspace users. An adversary may configure domain-wide delegation to maintain access to their targetâ€™s data. | update | 206 

|<<prebuilt-rule-8-13-12-attempts-to-brute-force-a-microsoft-365-user-account, Attempts to Brute Force a Microsoft 365 User Account>> | Identifies attempts to brute force a Microsoft 365 user account. An adversary may attempt a brute force attack to obtain unauthorized access to user accounts. | update | 209 

|<<prebuilt-rule-8-13-12-suspicious-microsoft-365-mail-access-by-clientappid, Suspicious Microsoft 365 Mail Access by ClientAppId>> | Identifies when a Microsoft 365 Mailbox is accessed by a ClientAppId that was observed for the fist time during the last 10 days. | update | 107 

|<<prebuilt-rule-8-13-12-multiple-device-token-hashes-for-single-okta-session, Multiple Device Token Hashes for Single Okta Session>> | This rule detects when a specific Okta actor has multiple device token hashes for a single Okta session. This may indicate an authenticated session has been hijacked or is being used by multiple devices. Adversaries may hijack a session to gain unauthorized access to Okta admin console, applications, tenants, or other resources. | update | 102 

|<<prebuilt-rule-8-13-12-ssh-key-generated-via-ssh-keygen, SSH Key Generated via ssh-keygen>> | This rule identifies the creation of SSH keys using the ssh-keygen tool, which is the standard utility for generating SSH keys. Users often create SSH keys for authentication with remote services. However, threat actors can exploit this tool to move laterally across a network or maintain persistence by generating unauthorized SSH keys, granting them SSH access to systems. | update | 2 

|<<prebuilt-rule-8-13-12-suspicious-inter-process-communication-via-outlook, Suspicious Inter-Process Communication via Outlook>> | Detects Inter-Process Communication with Outlook via Component Object Model from an unusual process. Adversaries may target user email to collect sensitive information or send email on their behalf via API. | update | 7 

|<<prebuilt-rule-8-13-12-lsass-process-access-via-windows-api, LSASS Process Access via Windows API>> | Identifies access attempts to the LSASS handle, which may indicate an attempt to dump credentials from LSASS memory. | update | 9 

|<<prebuilt-rule-8-13-12-unusual-file-creation-alternate-data-stream, Unusual File Creation - Alternate Data Stream>> | Identifies suspicious creation of Alternate Data Streams on highly targeted files. This is uncommon for legitimate files and sometimes done by adversaries to hide malware. | update | 115 

|<<prebuilt-rule-8-13-12-suspicious-file-renamed-via-smb, Suspicious File Renamed via SMB>> | Identifies an incoming SMB connection followed by a suspicious file rename operation. This may indicate a remote ransomware attack via the SMB protocol. | update | 3 

|<<prebuilt-rule-8-13-12-potential-ransomware-note-file-dropped-via-smb, Potential Ransomware Note File Dropped via SMB>> | Identifies an incoming SMB connection followed by the creation of a file with a name similar to ransomware note files. This may indicate a remote ransomware attack via the SMB protocol. | update | 3 

|==============================================
