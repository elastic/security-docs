[[prebuilt-rule-8-15-3-suspicious-file-downloaded-from-google-drive]]
=== Suspicious File Downloaded from Google Drive

Identifies suspicious file download activity from a Google Drive URL. This could indicate an attempt to deliver phishing payloads via a trusted webservice.

*Rule type*: eql

*Rule indices*: 

* auditbeat-*
* logs-endpoint*
* logs-system.security*
* winlogbeat-*

*Severity*: medium

*Risk score*: 47

*Runs every*: 5m

*Searches indices from*: now-9m ({ref}/common-options.html#date-math[Date Math format], see also <<rule-schedule, `Additional look-back time`>>)

*Maximum alerts per execution*: 100

*References*: 

* https://intelligence.abnormalsecurity.com/blog/google-drive-matanbuchus-malware

*Tags*: 

* Domain: Endpoint
* OS: Linux
* OS: Windows
* OS: macOS
* Use Case: Threat Detection
* Tactic: Command and Control
* Data Source: System

*Version*: 4

*Rule authors*: 

* Elastic

*Rule license*: Elastic License v2


==== Rule query


[source, js]
----------------------------------
process where

    /* common browser processes  */
    event.action in ("exec", "fork", "start") and 

    process.name : ("Microsoft Edge", "chrome.exe", "Google Chrome", "google-chrome-stable", 
                    "google-chrome-beta", "google-chrome", "msedge.exe", "firefox.exe", "brave.exe", 
                    "whale.exe", "browser.exe", "dragon.exe", "vivaldi.exe", "opera.exe", "firefox", 
                    "powershell.exe", "curl", "curl.exe", "wget", "wget.exe") and 

    /* Look for Google Drive download URL with AV flag skipping */
    (process.command_line : "*drive.google.com*" and process.command_line : "*export=download*" and process.command_line : "*confirm=no_antivirus*")

----------------------------------

*Framework*: MITRE ATT&CK^TM^

* Tactic:
** Name: Command and Control
** ID: TA0011
** Reference URL: https://attack.mitre.org/tactics/TA0011/
* Technique:
** Name: Ingress Tool Transfer
** ID: T1105
** Reference URL: https://attack.mitre.org/techniques/T1105/
