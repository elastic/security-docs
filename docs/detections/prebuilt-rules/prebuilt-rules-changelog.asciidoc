[[prebuilt-rules-changelog]]
== Prebuilt rule changes per release

beta[]

The following lists prebuilt rule updates per release. Only rules with
significant modifications to their query or scope are listed. For detailed
information about a rule's changes, see the rule's description page.

[float]
=== 7.12.0


This prebuilt rule has been removed:

<<setgid-bit-set-via-chmod>>

These prebuilt rules have been updated:

<<access-to-keychain-credentials-directories>>

<<attempt-to-remove-file-quarantine-attribute>>

<<azure-automation-account-created>>

<<azure-automation-runbook-created-or-modified>>

<<azure-automation-runbook-deleted>>

<<azure-automation-webhook-created>>

<<azure-blob-container-access-level-modification>>

<<azure-command-execution-on-virtual-machine>>

<<azure-diagnostic-settings-deletion>>

<<azure-event-hub-authorization-rule-created-or-updated>>

<<azure-event-hub-deletion>>

<<azure-firewall-policy-deletion>>

<<azure-key-vault-modified>>

<<azure-network-watcher-deletion>>

<<azure-resource-group-deletion>>

<<azure-storage-account-key-regenerated>>

<<connection-to-commonly-abused-web-services>>

<<credential-acquisition-via-registry-hive-dumping>>

<<execution-from-unusual-directory-command-line>>

<<execution-with-explicit-credentials-via-scripting>>

<<file-and-directory-discovery>>

<<installation-of-custom-shim-databases>>

<<outbound-scheduled-task-activity-via-powershell>>

<<persistence-via-microsoft-office-addins>>

<<persistence-via-microsoft-outlook-vba>>

<<persistence-via-update-orchestrator-service-hijack>>

<<potential-command-and-control-via-internet-explorer>>

<<potential-remote-desktop-tunneling-detected>>

<<potential-secure-file-deletion-via-sdelete-utility>>

<<prompt-for-credentials-with-osascript>>

<<remote-ssh-login-enabled-via-systemsetup-command>>

<<scheduled-task-created-by-a-windows-script>>

<<service-command-lateral-movement>>

<<setuid-setgid-bit-set-via-chmod>>

<<sudoers-file-modification>>

<<suspicious-cmd-execution-via-wmi>>

<<suspicious-image-load-taskschd.dll-from-ms-office>>

<<suspicious-powershell-engine-imageload>>

<<suspicious-process-from-conhost>>

<<suspicious-rdp-activex-client-loaded>>

<<suspicious-wmi-image-load-from-ms-office>>

<<suspicious-wmic-xsl-script-execution>>

<<tampering-of-bash-command-line-history>>

<<timestomping-using-touch-command>>

<<uac-bypass-attempt-via-elevated-com-internet-explorer-add-on-installer>>

<<uac-bypass-attempt-with-ieditionupgrademanager-elevated-com-interface>>

<<windows-script-interpreter-executing-process-via-wmi>>

<<windows-suspicious-script-object-execution>>

[float]
=== 7.11.2

<<credential-acquisition-via-registry-hive-dumping>>

<<file-and-directory-discovery>>

<<persistence-via-wmi-event-subscription>>

<<potential-remote-desktop-tunneling-detected>>

[float]
=== 7.11.0

<<attempt-to-modify-an-okta-network-zone>>

<<attempt-to-modify-an-okta-policy-rule>>

<<azure-automation-account-created>>

<<azure-automation-runbook-created-or-modified>>

<<azure-automation-runbook-deleted>>

<<azure-automation-webhook-created>>

<<azure-blob-container-access-level-modification>>

<<azure-command-execution-on-virtual-machine>>

<<azure-conditional-access-policy-modified>>

<<azure-diagnostic-settings-deletion>>

<<azure-event-hub-authorization-rule-created-or-updated>>

<<azure-event-hub-deletion>>

<<azure-external-guest-user-invitation>>

<<azure-firewall-policy-deletion>>

<<azure-global-administrator-role-addition-to-pim-user>>

<<azure-key-vault-modified>>

<<azure-network-watcher-deletion>>

<<azure-privilege-identity-management-role-modified>>

<<azure-resource-group-deletion>>

<<azure-storage-account-key-regenerated>>

<<clearing-windows-event-logs>>

<<dns-activity-to-the-internet>>

<<ftp-file-transfer-protocol-activity-to-the-internet>>

<<gcp-firewall-rule-creation>>

<<gcp-firewall-rule-deletion>>

<<gcp-firewall-rule-modification>>

<<gcp-iam-custom-role-creation>>

<<gcp-iam-role-deletion>>

<<gcp-iam-service-account-key-deletion>>

<<gcp-logging-bucket-deletion>>

<<gcp-logging-sink-deletion>>

<<gcp-logging-sink-modification>>

<<gcp-pub-sub-subscription-creation>>

<<gcp-pub-sub-subscription-deletion>>

<<gcp-pub-sub-topic-creation>>

<<gcp-pub-sub-topic-deletion>>

<<gcp-service-account-creation>>

<<gcp-service-account-deletion>>

<<gcp-service-account-disabled>>

<<gcp-service-account-key-creation>>

<<gcp-storage-bucket-configuration-modification>>

<<gcp-storage-bucket-deletion>>

<<gcp-storage-bucket-permissions-modification>>

<<gcp-virtual-private-cloud-network-deletion>>

<<gcp-virtual-private-cloud-route-creation>>

<<gcp-virtual-private-cloud-route-deletion>>

<<iis-http-logging-disabled>>

<<irc-internet-relay-chat-protocol-activity-to-the-internet>>

<<microsoft-build-engine-loading-windows-credential-libraries>>

<<microsoft-build-engine-using-an-alternate-name>>

<<microsoft-iis-connection-strings-decryption>>

<<microsoft-iis-service-account-password-dumped>>

<<multi-factor-authentication-disabled-for-an-azure-user>>

<<persistence-via-telemetrycontroller-scheduled-task-hijack>>

<<possible-consent-grant-attack-via-azure-registered-application>>

<<potential-dll-sideloading-via-trusted-microsoft-programs>>

<<potential-modification-of-accessibility-binaries>>

<<potential-secure-file-deletion-via-sdelete-utility>>

<<potential-windows-error-manager-masquerading>>

<<proxy-port-activity-to-the-internet>>

<<rdp-remote-desktop-protocol-from-the-internet>>

<<rdp-remote-desktop-protocol-to-the-internet>>

<<rpc-remote-procedure-call-from-the-internet>>

<<rpc-remote-procedure-call-to-the-internet>>

<<remote-file-download-via-desktopimgdownldr-utility>>

<<remote-file-download-via-mpcmdrun>>

<<renamed-autoit-scripts-interpreter>>

<<smb-windows-file-sharing-activity-to-the-internet>>

<<smtp-to-the-internet>>

<<sql-traffic-to-the-internet>>

<<ssh-secure-shell-from-the-internet>>

<<ssh-secure-shell-to-the-internet>>

<<suspicious-.net-code-compilation>>

<<suspicious-endpoint-security-parent-process>>

<<suspicious-ms-office-child-process>>

<<suspicious-process-execution-via-renamed-psexec-executable>>

<<suspicious-zoom-child-process>>

<<tcp-port-8000-activity-to-the-internet>>

<<tor-activity-to-the-internet>>

<<uac-bypass-via-diskcleanup-scheduled-task-hijack>>

<<unusual-child-processes-of-rundll32>>

<<unusual-file-modification-by-dns.exe>>

<<unusual-network-connection-via-rundll32>>

<<unusual-parent-child-relationship>>

<<user-added-as-owner-for-azure-application>>

<<user-added-as-owner-for-azure-service-principal>>

<<vnc-virtual-network-computing-from-the-internet>>

<<vnc-virtual-network-computing-to-the-internet>>

[float]
=== 7.10.0

<<aws-ec2-snapshot-activity>>

<<aws-execution-via-system-manager>>

<<aws-iam-assume-role-policy-update>>

<<aws-iam-brute-force-of-assume-role-policy>>

<<aws-management-console-root-login>>

<<aws-root-login-without-mfa>>

<<aws-waf-rule-or-rule-group-deletion>>

<<administrator-privileges-assigned-to-an-okta-group>>

<<attempt-to-create-okta-api-token>>

<<attempt-to-deactivate-mfa-for-an-okta-user-account>>

<<attempt-to-deactivate-an-okta-policy>>

<<attempt-to-deactivate-an-okta-policy-rule>>

<<attempt-to-delete-an-okta-policy>>

<<attempt-to-modify-an-okta-network-zone>>

<<attempt-to-modify-an-okta-policy>>

<<attempt-to-modify-an-okta-policy-rule>>

<<attempt-to-reset-mfa-factors-for-an-okta-user-account>>

<<attempt-to-revoke-okta-api-token>>

<<attempted-bypass-of-okta-mfa>>

<<command-prompt-network-connection>>

<<connection-to-external-network-via-telnet>>

<<connection-to-internal-network-via-telnet>>

<<direct-outbound-smb-connection>>

<<microsoft-build-engine-using-an-alternate-name>>

<<modification-or-removal-of-an-okta-application-sign-on-policy>>

<<msbuild-making-network-connections>>

<<net-command-via-system-account>>

<<netcat-network-activity>>

<<network-connection-via-certutil>>

<<network-connection-via-compiled-html-file>>

<<network-connection-via-msxsl>>

<<network-connection-via-registration-utility>>

<<network-connection-via-signed-binary>>

<<okta-brute-force-or-password-spraying-attack>>

<<possible-okta-dos-attack>>

<<potential-application-shimming-via-sdbinst>>

<<potential-evasion-via-filter-manager>>

<<potential-modification-of-accessibility-binaries>>

<<process-activity-via-compiled-html-file>>

<<process-discovery-via-tasklist>>

<<psexec-network-connection>>

<<suspicious-activity-reported-by-okta-user>>

<<threat-detected-by-okta-threatinsight>>

<<trusted-developer-application-usage>>

<<unusual-network-connection-via-rundll32>>

<<unusual-parent-child-relationship>>

<<unusual-process-network-connection>>

<<whoami-process-activity>>

[float]
=== 7.9.0

<<adding-hidden-file-attribute-via-attrib>>

<<adobe-hijack-persistence>>

<<attempt-to-disable-iptables-or-firewall>>

<<attempt-to-disable-syslog-service>>

<<base16-or-base32-encoding-decoding-activity>>

<<base64-encoding-decoding-activity>>

<<bypass-uac-via-event-viewer>>

<<clearing-windows-event-logs>>

<<command-prompt-network-connection>>

<<connection-to-external-network-via-telnet>>

<<connection-to-internal-network-via-telnet>>

<<dns-activity-to-the-internet>>

<<delete-volume-usn-journal-with-fsutil>>

<<deleting-backup-catalogs-with-wbadmin>>

<<direct-outbound-smb-connection>>

<<disable-windows-firewall-rules-via-netsh>>

<<encoding-or-decoding-files-via-certutil>>

<<enumeration-of-kernel-modules>>

<<execution-via-regsvcs-regasm>>

<<ftp-file-transfer-protocol-activity-to-the-internet>>

<<file-deletion-via-shred>>

<<file-permission-modification-in-writable-directory>>

<<hex-encoding-decoding-activity>>

<<hping-process-activity>>

<<ipsec-nat-traversal-port-activity>>

<<irc-internet-relay-chat-protocol-activity-to-the-internet>>

<<interactive-terminal-spawned-via-perl>>

<<interactive-terminal-spawned-via-python>>

<<kernel-module-removal>>

<<local-scheduled-task-commands>>

<<local-service-commands>>

<<microsoft-build-engine-loading-windows-credential-libraries>>

<<microsoft-build-engine-started-an-unusual-process>>

<<microsoft-build-engine-started-by-a-script-process>>

<<microsoft-build-engine-started-by-a-system-process>>

<<microsoft-build-engine-started-by-an-office-application>>

<<microsoft-build-engine-using-an-alternate-name>>

<<mknod-process-activity>>

<<modification-of-boot-configuration>>

<<msbuild-making-network-connections>>

<<net-command-via-system-account>>

<<netcat-network-activity>>

<<network-connection-via-certutil>>

<<network-connection-via-compiled-html-file>>

<<network-connection-via-msxsl>>

<<network-connection-via-registration-utility>>

<<network-connection-via-signed-binary>>

<<network-sniffing-via-tcpdump>>

<<nmap-process-activity>>

<<nping-process-activity>>

<<pptp-point-to-point-tunneling-protocol-activity>>

<<persistence-via-kernel-module-modification>>

<<potential-dns-tunneling-via-iodine>>

<<potential-disabling-of-selinux>>

<<potential-shell-via-web-server>>

<<powershell-spawning-cmd>>

<<proxy-port-activity-to-the-internet>>

<<psexec-network-connection>>

<<rdp-remote-desktop-protocol-from-the-internet>>

<<rdp-remote-desktop-protocol-to-the-internet>>

<<rpc-remote-procedure-call-from-the-internet>>

<<rpc-remote-procedure-call-to-the-internet>>

<<smb-windows-file-sharing-activity-to-the-internet>>

<<smtp-on-port-26-tcp>>

<<smtp-to-the-internet>>

<<sql-traffic-to-the-internet>>

<<ssh-secure-shell-from-the-internet>>

<<ssh-secure-shell-to-the-internet>>

<<setuid-setgid-bit-set-via-chmod>>

<<socat-process-activity>>

<<strace-process-activity>>

<<sudoers-file-modification>>

<<suspicious-ms-office-child-process>>

<<suspicious-ms-outlook-child-process>>

<<suspicious-pdf-reader-child-process>>

<<svchost-spawning-cmd>>

<<system-shells-via-services>>

<<tcp-port-8000-activity-to-the-internet>>

<<telnet-port-activity>>

<<tor-activity-to-the-internet>>

<<unusual-network-connection-via-rundll32>>

<<unusual-parent-child-relationship>>

<<unusual-process-execution-temp>>

<<unusual-process-network-connection>>

<<user-account-creation>>

<<user-discovery-via-whoami>>

<<vnc-virtual-network-computing-from-the-internet>>

<<vnc-virtual-network-computing-to-the-internet>>

<<virtual-machine-fingerprinting>>

<<volume-shadow-copy-deletion-via-vssadmin>>

<<volume-shadow-copy-deletion-via-wmic>>

<<windows-script-executing-powershell>>

[float]
=== 7.8.0

<<potential-shell-via-web-server>>

<<unusual-network-connection-via-rundll32>>

[float]
=== 7.7.0


These prebuilt rules have been removed:

* Execution via Signed Binary
* Suspicious Process spawning from Script Interpreter
* Suspicious Script Object Execution

These prebuilt rules have been updated:

<<adding-hidden-file-attribute-via-attrib>>

<<adversary-behavior-detected-elastic-endgame>>

<<clearing-windows-event-logs>>

<<command-prompt-network-connection>>

<<credential-dumping-detected-elastic-endgame>>

<<credential-dumping-prevented-elastic-endgame>>

<<credential-manipulation-detected-elastic-endgame>>

<<credential-manipulation-prevented-elastic-endgame>>

<<dns-activity-to-the-internet>>

<<delete-volume-usn-journal-with-fsutil>>

<<deleting-backup-catalogs-with-wbadmin>>

<<direct-outbound-smb-connection>>

<<disable-windows-firewall-rules-via-netsh>>

<<encoding-or-decoding-files-via-certutil>>

<<exploit-detected-elastic-endgame>>

<<exploit-prevented-elastic-endgame>>

<<ftp-file-transfer-protocol-activity-to-the-internet>>

<<hping-process-activity>>

<<irc-internet-relay-chat-protocol-activity-to-the-internet>>

<<local-scheduled-task-commands>>

<<local-service-commands>>

<<malware-detected-elastic-endgame>>

<<malware-prevented-elastic-endgame>>

<<mknod-process-activity>>

<<msbuild-making-network-connections>>

<<netcat-network-activity>>

<<network-connection-via-compiled-html-file>>

<<network-connection-via-registration-utility>>

<<network-connection-via-signed-binary>>

<<network-sniffing-via-tcpdump>>

<<nmap-process-activity>>

<<nping-process-activity>>

<<permission-theft-detected-elastic-endgame>>

<<permission-theft-prevented-elastic-endgame>>

<<persistence-via-kernel-module-modification>>

<<potential-dns-tunneling-via-iodine>>

<<potential-modification-of-accessibility-binaries>>

<<process-injection-detected-elastic-endgame>>

<<process-injection-prevented-elastic-endgame>>

<<proxy-port-activity-to-the-internet>>

<<psexec-network-connection>>

<<rdp-remote-desktop-protocol-from-the-internet>>

<<rdp-remote-desktop-protocol-to-the-internet>>

<<rpc-remote-procedure-call-from-the-internet>>

<<rpc-remote-procedure-call-to-the-internet>>

<<ransomware-detected-elastic-endgame>>

<<ransomware-prevented-elastic-endgame>>

<<smb-windows-file-sharing-activity-to-the-internet>>

<<smtp-to-the-internet>>

<<sql-traffic-to-the-internet>>

<<ssh-secure-shell-from-the-internet>>

<<ssh-secure-shell-to-the-internet>>

<<socat-process-activity>>

<<strace-process-activity>>

<<suspicious-ms-office-child-process>>

<<suspicious-ms-outlook-child-process>>

<<system-shells-via-services>>

<<tcp-port-8000-activity-to-the-internet>>

<<tor-activity-to-the-internet>>

<<trusted-developer-application-usage>>

<<unusual-network-connection-via-rundll32>>

<<unusual-parent-child-relationship>>

<<unusual-process-execution-temp>>

<<unusual-process-network-connection>>

<<user-account-creation>>

<<user-discovery-via-whoami>>

<<vnc-virtual-network-computing-from-the-internet>>

<<vnc-virtual-network-computing-to-the-internet>>

<<volume-shadow-copy-deletion-via-vssadmin>>

<<volume-shadow-copy-deletion-via-wmic>>

<<web-application-suspicious-activity-no-user-agent>>

<<windows-script-executing-powershell>>

[float]
=== 7.6.2

<<adobe-hijack-persistence>>

[float]
=== 7.6.1

<<dns-activity-to-the-internet>>

<<ftp-file-transfer-protocol-activity-to-the-internet>>

<<ipsec-nat-traversal-port-activity>>

<<irc-internet-relay-chat-protocol-activity-to-the-internet>>

<<pptp-point-to-point-tunneling-protocol-activity>>

<<potential-shell-via-web-server>>

<<proxy-port-activity-to-the-internet>>

<<rdp-remote-desktop-protocol-from-the-internet>>

<<rdp-remote-desktop-protocol-to-the-internet>>

<<rpc-remote-procedure-call-from-the-internet>>

<<rpc-remote-procedure-call-to-the-internet>>

<<smb-windows-file-sharing-activity-to-the-internet>>

<<smtp-on-port-26-tcp>>

<<smtp-to-the-internet>>

<<sql-traffic-to-the-internet>>

<<ssh-secure-shell-from-the-internet>>

<<ssh-secure-shell-to-the-internet>>

<<tcp-port-8000-activity-to-the-internet>>

<<telnet-port-activity>>

<<tor-activity-to-the-internet>>

<<vnc-virtual-network-computing-from-the-internet>>

<<vnc-virtual-network-computing-to-the-internet>>

