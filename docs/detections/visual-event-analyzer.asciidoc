[[visual-event-analyzer]]
[role="xpack"]
== Visual event analyzer 

Elastic Security allows any event detected by Elastic Endpoint to be analyzed using a heirchacal graphical timeline. This enables security analyst to drill-down into all related hosts, processes, and other events to aid in their investigations. 

[float]
[[find-events-analyze]]
=== Find events to analyze

You can only visualize events triggered from hosts configured with the Elastic Endpoint Security Integration. In KQL, this translates to any event with the `agent.type` set to `endpoint and process.entity`. 

To access events that can be visually analyzed:

1. In Elastic Security, select **Hosts** > **Events**. A list of all your host's events appears in the bottom panel of the Host's view.

2. Create a KQL query that filters all `endpoint` detected events by entering `agent.type: endpoint and process.entity_id : *` into the KQL search bar, and then select **Update**.
+
[role="screenshot"]
image::images/kql-agent-type.png[]
+
A list of all `endpoint` related events appears.

3. Select the **Analyze Event** icon next to the event you want to analyze. 
+
[role="screenshot"]
image::images/analyze-event.png[]

The **Visual analyzer** view appears.

[role="screenshot"]
image::images/analyze-event-view.png[]


[discrete]
[[visual-analyzer]]
=== Visual analyzer

Inside the visual analyzer, each cube represents either a node, process, or alert. Click and drag in timeline view to see all process relationships. 

To make the analyzer full screen, select the **Full Screen** icon above the left-panel. 

[role="screenshot"]
image::images/full-screen-analyzer.png[]

The left panel contains a list of all process related to the event, starting with the first process in the event chain. Event selected for analysis are highlighted and labled as a **Analyzed Event**. In the graphical view, Analyzed Events are highlighted with light blue cube. 

[role="screenshot"]
image::images/process-list.png[]

In the graphical view, you can:

- Zoom in and out of the timeline view using the slider to the right of the timeline.
- See the time passed between each node.
- See all events related to each process. 

[role="screenshot"]
image::images/graphical-view.png[]


[discrete]
[[process-and-event-details]]
=== Process and event details

To see more details about each related process, select the process either in the left panel or the graphical view. The details about the process appear in the left panel, which typcially includes but isn't limited to:

- The number of events associated with the process.
- The timestamp when the process was executed.
- The file path of the process within the host.
- The `process-pid`.
- The user name and domain that ran the process.
- Any other relevant process information. 

[role="screenshot"]
image::images/process-details.png[]

Event details can be accessed by selecting the **# events** URL at the top of the process details view, or selecting one of the event pills in the graphical view.


Events are catergorized based on thier `event.type`. When selecting an `event.type`, a list of all those types of events appears in the left han

[role="screenshot"]
image::event-type.png[]

When selecting an `event.type`, a list of all those types of events appears in the left hand panel. If you want further details on the event, select the event from the list. Event details appear in the left hand panel. 

[role="screenshot"]
image::event-details.png[]

In Elastic Security 7.10 and later, there is no limit to the amount of events that can be associated with a process. However, in 7.9, each process is limited to only 100 events.
