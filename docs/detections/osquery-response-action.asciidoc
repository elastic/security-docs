[[osquery-response-action]]
=== Add Osquery Response Actions

Response Actions are triggered every time a rule executes and can be configured to gather relevant data about events. You can use this data while triaging and investigating alerts.

NOTE: Response Actions are in technical preview and require a https://www.elastic.co/pricing[Platinum or Enterprise subscription].

From the Response Actions section, you can choose to set up live Osquery queries. The Osquery response action is only available for the custom query rule type.

IMPORTANT: You must have the Osquery manager integration installed and the appropriate privileges to use Osquery. Refer to <<osquery-prereqs>> for more information.

[role="screenshot"]
image::images/available-response-actions.png[Shows available response actions]

[float]
[[add-osquery-response-action]]
=== Add an Osquery Response Action to a rule

. Choose to add an Osquery Response Action to a new or existing rule:
** *New rule*: After creating a <<create-custom-rule,custom query rule>>, click the *osquery* icon to add a live query to the rule.
** *Existing rule*: Edit the rule's settings and go to the *Actions* tab. In the tab, go to the Response Actions section and click the *osquery* icon.
. Specify whether you want to set up a single live query or a pack:
** *Query*: Select a saved query or enter a new one in the text box. After you enter the query, you can expand the **Advanced** section to view or set {kibana-ref}/osquery.html#osquery-map-fields[mapped ECS fields] included in the results from the live query. Mapping ECS fields is optional.
** *Pack*: Select from query packs that have been loaded and activated. After you select a pack, all of the queries in the pack are displayed.
+
TIP: Refer to {kibana-ref}/osquery.html#osquery-prebuilt-packs-queries[prebuilt packs] to learn about using and managing Elastic prebuilt packs.
+
[role="screenshot"]
image::images/setup-single-query.png[width=80%][height=80%][Shows how to set up a single query]
+

. Click the *osquery* icon to add more live queries.
. Create the rule or save your changes to finish adding the queries.
