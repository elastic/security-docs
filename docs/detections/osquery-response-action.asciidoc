[[osquery-response-action]]
=== Add Osquery Response Actions
Osquery Response Actions allow you to add live queries to custom query rules so you can automatically collect data on systems the rule is monitoring. Use this data to support your alert triage and investigation efforts.

NOTE: Response Actions are in technical preview.

[role="screenshot"]
image::images/available-response-actions.png[Shows available response actions]

.Requirements
[sidebar]
--
* Osquery Response Actions are available with a https://www.elastic.co/pricing[Platinum or Enterprise subscription].
* The {kibana-ref}/manage-osquery-integration.html[Osquery manager integration] must be installed.
* {agent}'s {fleet-guide}/view-elastic-agent-status.html[status] must be `Healthy`. Refer to {fleet-guide}/fleet-troubleshooting.html[{fleet} Troubleshooting] if it isn't.
* Your role must have {kibana-ref}/osquery.html[Osquery feature privileges].
--

[float]
[[add-osquery-response-action]]
=== Add Osquery Response Actions to rules

You can add Osquery Response Actions to new or existing custom query rules. Queries are ran every time the rule executes.

. Choose one of the following:
** *New rule*: When you are on the last step of <<create-custom-rule,custom query rule>>, go to the Response Actions section and click the *osquery* icon.
** *Existing rule*: Edit the rule's settings, then go to the *Actions* tab. In the tab, click the *osquery* icon under the Response Actions section.
. Specify whether you want to set up a single live query or a pack:
** *Query*: Select a saved query or enter a new one in the text box. After you enter the query, you can expand the **Advanced** section to view or set {kibana-ref}/osquery.html#osquery-map-fields[mapped ECS fields] included in the results from the live query. Mapping ECS fields is optional.
** *Pack*: Select from query packs that have been loaded and activated. After you select a pack, all of the queries in the pack are displayed.
+
TIP: Refer to {kibana-ref}/osquery.html#osquery-prebuilt-packs-queries[prebuilt packs] to learn about using and managing Elastic prebuilt packs.
+
[role="screenshot"]
image::images/setup-single-query.png[Shows how to set up a single query]
+

. Click the *osquery* icon to add more live queries (optional).
. Create the rule or save your changes to finish adding the queries.

[float]
[[find-osquery-response-action-results]]
=== Find query results

When an alert is generated, Osquery automatically collects data on the system related to the alert. Query results are displayed within the *Osquery Results* tab in the Alert details flyout. The number to the right of the *Osquery Results* tab represents the number of queries attached to the rule.

NOTE: Refer to <<view-osquery-results>> for more information about query results.

[role="screenshot"]
image::images/osquery-results-tab.png[width=80%][height=80%][Shows how to set up a single query]
