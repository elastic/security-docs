[[prebuilt-rules-management]]
== Install and manage Elastic prebuilt rules

:frontmatter-description: Start detections quickly with prebuilt rules designed and updated by Elastic.
:frontmatter-tags-products: [security]
:frontmatter-tags-content-type: [how-to]
:frontmatter-tags-user-goals: [manage]

Follow these guidelines to start using the {security-app}'s <<prebuilt-rules, prebuilt rules>>, keep them updated, and make sure they have the data needed to run successfully. 

* <<load-prebuilt-rules>>
* <<prebuilt-rule-tags>>
* <<select-all-prebuilt-rules>>
* <<update-prebuilt-rules>>
* <<rule-prerequisites>>

[NOTE]
====
* Most prebuilt rules don't start running by default. You can use the **Install and enable** option to start running rules as you install them, or first install the rules, then enable them manually. After installation, only a few prebuilt rules will be enabled by default, such as the Endpoint Security rule.
* Automatic updates of Elastic prebuilt rules are supported for the current {elastic-sec} version and the latest three previous minor releases. For example, if you’re on {elastic-sec} 8.10, you’ll be able to use the Rules UI to update your prebuilt rules until {elastic-sec} 8.14 is released. After that point, you can still manually download and install updated prebuilt rules, but you must upgrade to the latest {elastic-sec} version to receive automatic updates.
====

[float]
[[load-prebuilt-rules]]
=== Install and enable Elastic prebuilt rules

. Find *Detection rules (SIEM)* in the navigation menu or by using the {kibana-ref}/introduction.html#kibana-navigation-search[global search field], then go to the Rules table.
+
The badge next to *Add Elastic rules* shows the number of prebuilt rules available for installation. 
+
[role="screenshot"]
image::images/prebuilt-rules-add-badge.png[The Add Elastic Rules page]

. Click *Add Elastic rules*.
+
TIP: To examine the details of a rule before you install it, select the rule name. This opens the rule details flyout.

. Do one of the following:
+
--
* Install all available rules: Click *Install all* at the top of the page. (This doesn't enable the rules; you still need to do that manually.)
* Install a single rule: In the Rules table, either click **Install** to install a rule without enabling it, or click image:images/boxesVertical.svg[Vertical boxes button] → **Install and enable** to start running the rule once it's installed.
* Install multiple rules: Select the rules, and then at the top of the page either click *Install _x_ selected rule(s)* to install without enabling the rules, or click image:images/boxesVertical.svg[Vertical boxes button] → **Install and enable** to install and start running the rules.
--
+
TIP: Use the search bar and *Tags* filter to find the rules you want to install. For example, filter by `OS: Windows` if your environment only includes Windows endpoints. For more on tag categories, refer to <<prebuilt-rule-tags>>.
+
[role="screenshot"]
image::images/prebuilt-rules-add.png[The Add Elastic Rules page]

. For any rules you haven't already enabled, go back to the *Rules* page, search or filter for the rules you want to run, and do either of the following:

* Enable a single rule: Turn on the rule's *Enabled* switch.
* Enable multiple rules: Select the rules, then click *Bulk actions* -> *Enable*.

Once you enable a rule, it starts running on its configured schedule. To confirm that it's running successfully, check its *Last response* status in the Rules table, or open the rule's details page and check the <<rule-execution-logs, *Execution results*>> tab.

[float]
[[prebuilt-rule-tags]]
=== Prebuilt rule tags

Each prebuilt rule includes several tags identifying the rule's purpose, detection method, associated resources, and other information to help categorize your rules. These tags are category-value pairs; for example, `OS: Windows` indicates rules designed for Windows endpoints. Categories include:

* `Data Source`: The application, cloud provider, data shipper, or Elastic integration providing data for the rule.
* `Domain`: A general category of data source types (such as cloud, endpoint, or network).
* `OS`: The host operating system, which could be considered another data source type.
* `Resources`: Additional rule resources such as investigation guides.
* `Rule Type`: Identifies if the rule depends on specialized resources (such as machine learning jobs or threat intelligence indicators), or if it's a higher-order rule built from other rules' alerts.
* `Tactic`: MITRE ATT&CK tactics that the rule addresses.
* `Threat`: Specific threats the rule detects (such as Cobalt Strike or BPFDoor).
* `Use Case`: The type of activity the rule detects and its purpose. Use cases include:
** `Active Directory Monitoring`: Detects changes related to Active Directory.
** `Asset Visibility`: Detects changes to specified asset types.
** `Configuration Audit`: Detects undesirable configuration changes.
** `Guided Onboarding`: Example rule, used for {elastic-sec}'s guided onboarding tour.
** `Identity and Access Audit`: Detects activity related to identity and access management (IAM).
** `Log Auditing`: Detects activity on log configurations or storage.
** `Network Security Monitoring`: Detects network security configuration activity.
** `Threat Detection`: Detects threats.
** `Vulnerability`: Detects exploitation of specific vulnerabilities.

[float]
[[select-all-prebuilt-rules]]
=== Select and duplicate prebuilt rules

. Find *Detection rules (SIEM)* in the navigation menu or by using the {kibana-ref}/introduction.html#kibana-navigation-search[global search field].
. In the *Rules* table, select the *Elastic rules* filter.
. Select one or more rules, or click *Select all _x_ rules* above the rules table.
. Click *Bulk actions* -> *Duplicate*.
. Select whether to duplicate the rules' exceptions, then click *Duplicate*.

You can then modify the duplicated rules and, if required, delete the prebuilt ones. Be aware that your modified rules are entirely separate from the original prebuilt rules, and will not get updates from Elastic if the prebuilt rules are updated.

[float]
[[update-prebuilt-rules]]
=== Update Elastic prebuilt rules

Elastic regularly updates prebuilt rules to optimize their performance and ensure they detect the latest threats and techniques. When updated versions are available for your installed prebuilt rules, the *Rule Updates* tab appears on the *Rules* page, allowing you to update your installed rules with the latest versions.

. Find *Detection rules (SIEM)* in the navigation menu or by using the {kibana-ref}/introduction.html#kibana-navigation-search[global search field].
. In the *Rules* table, select the *Rule Updates* tab.
+
NOTE: The *Rule Updates* tab doesn't appear if all your installed prebuilt rules are up to date.
+
[role="screenshot"]
image::images/prebuilt-rules-update.png[The Rule Updates tab on the Rules page]

. (Optional) To examine the details of a rule's latest version before you update it, select the rule name. This opens the rule details flyout, where you can do the following: 

+
** *Preview incoming updates to the rule*: Select the *Elastic update overview* tab to view rule changes field by field, or the *JSON view* tab to view changes for the entire rule in JSON format. Both tabs display side-by-side comparisons of the *Current rule* (what you currently have installed) and the *Elastic update* version (what you can choose to install). Deleted characters are highlighted in red; added characters are highlighted in green.
+
TIP: Use the **Diff view** drop-down menu to compare the values of a field across different versions of a rule. For example, compare the changes that you made to the current version of the rule with changes that will be applied from the incoming Elastic update. 
+
[role="screenshot"]
image::images/prebuilt-rules-update-diff.png[Prebuilt rule comparison,75%]
+
** *Fix update conflicts*: Address <<resolve-reduce-rule-conflicts,conflicts>> with the incoming Elastic update. 
** *Edit the final version of the field*: Go to the *Final update* section, edit the value for the field, then click *Save*. The value that you entered will be fully applied when you update the rule.
** *Update the rule* If the rule is ready to update, you can click *Update* to accept the incoming changes and install the updated version.
+
NOTE: Changes to rule types cannot be edited. They can only be accepted during the update process.

. Do one of the following to update prebuilt rules on the *Rules* page:
* Update all available rules: Click *Update all*.
* Update a single rule: Click *Update rule* for that rule.
* Update multiple rules: Select the rules and click *Update _x_ selected rule(s)*.
+
TIP: Use the search bar and *Tags* filter to find the rules you want to update. For example, filter by `OS: Windows` if your environment only includes Windows endpoints. For more on tag categories, refer to <<prebuilt-rule-tags>>.

[float]
[[resolve-reduce-rule-conflicts]]
==== Resolve and reduce update conflicts

Regularly updating prebuilt rules can help reduce the frequency, and sometimes complexity, of update conflicts. 

When possible, Elastic will attempt to resolve conflicts and suggest solutions. In these cases, you only need to review the suggested fixes and accept or edit them before updating the rule. If Elastic can't auto-resolve the conflicts, you must manually fix them before updating the rule.

To manually fix a conflict:

. Find the rule field with an unresolved conflict. It will have the `Action required` badge next to its name.
. Go to the *Final update* section and edit the value.
. Save and apply your changes to the field by clicking **Save and accept**. The field's status changes to `Ready for update`.
. After you've resolved all other conflicts, click *Update rule*.