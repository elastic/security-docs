[[view-osquery-results]]
=== View and investigate Osquery results

You can use Osquery with {elastic-sec} to gather more information about your environment as you investigate a potential security issue. Query results display within the Alert details flyout and you can investigate results after reviewing them.

.Requirements
[sidebar]
--
* The {kibana-ref}/manage-osquery-integration.html[Osquery manager integration] must be installed.
* {agent}'s {fleet-guide}/view-elastic-agent-status.html[status] must be `Healthy`. Refer to {fleet-guide}/fleet-troubleshooting.html[{fleet} Troubleshooting] if it isn't.
* Your role must have {kibana-ref}/osquery.html[Osquery feature privileges].
--

[float]
[[review-single-osquery-results]]
=== Review single query results

Results for single queries appear in the *Results* tab. When you run a query, the number of agents queried and query status temporarily display in a status bar above the results table. Agent responses can be `Sucessful`, `Not yet responded` (pending), and `Failed`.

[role="screenshot"]
image::images/single-query-results.png[width=80%][height=80%][Shows query results]

[float]
[[review-pack-osquery-results]]
=== Review query pack results

Results for each query in the pack appear in the *Results* tab. Click the expand button (image:images/pack-expand-button-osquery.png[Click markdown icon,20,20]) at the far right of each query row to display query results. The number of agents that were queried and their responses are shown for each query. Agent responses are color-coded. Green is `Sucessful`, `Not yet responded` (pending) is gray, and `Failed` is red.

[role="screenshot"]
image::images/pack-query-results.png[width=80%][height=80%][Shows query results]

[float]
[[investigate-osquery-results]]
=== Investigate query results

From the results table, you can:

* Click the *View in Discover* button (image:images/discover-button-osquery.png[Click the View in Discover button,20,20])  to explore the results in Discover.
* Click the *View in Lens* button (image:images/lens-button-osquery.png[Click the View in Lens button,20,20]) to navigate to Lens, where you can use the drag-and-drop *Lens* editor to create visualizations.
* Click the *Timeline* button (image:images/timeline-button-osquery.png[Click Timeline button,20,20]) to investigate a single query result in Timeline or *Add to timeline investigation* to investigate all results. This option is only available for single query results.

+
When you open all results in Timeline, the events in Timeline are filtered based on the `action_ID` generated by the Osquery query.
+

* Click the *Add to Case* button (image:images/case-button-osquery.png[Click Add to Case button,20,20]) to add the query results to a new or existing case.
+
NOTE: If you add the results to a new case, you are prompted to specify the solution that you want the create the case within. Ensure you select the correct solution. From {elastic-sec}, you cannot access cases created in {observability} or Stack Management.

* View more information about the request, such as failures, by opening the *Status* tab.
