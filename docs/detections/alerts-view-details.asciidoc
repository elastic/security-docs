[[view-alert-details]]
== View detection alert details

:frontmatter-description: Create detection rules to monitor your environment for suspicious and malicious behavior.
:frontmatter-tags-products: [security, defend]
:frontmatter-tags-content-type: [reference]
:frontmatter-tags-user-goals: [manage]

To inspect a detection alert, click the *View details* button from the Alerts table. 

[role="screenshot"]
image::images/view-alert-details.png[View details button, 200] 

The right panel of the expandable flyout appears with several options to view alert data. The expandable flyout has three main components:

* *Right panel*: Provides an <<alert-details-overview,overview>> of the alert and allows you to view the alert document in the table or JSON format. 
* *Preview panel*: Shows an expanded version of the rule summary and alert reason.
* *Left panel*: Contains three main tabs (**Insights**, **Investigation**, and **Response**) and multiple sub-tabs. Each tab displays more more information about sections in the right panel. For example, if you wanted to learn more about hosts or users that you're monitoring, you can find more information on them in the *Entities* tab (**Insights** -> **Entities**).  

[role="screenshot"]
image::images/alert-details-flyout.png[Alert details flyout, 90%]

The **Share alert** link allows you to share alert details. Click it to copy a URL that you can paste into browsers, cases, messages, and more. We recommend doing this instead of copying the URL from your browser's address bar, which can cause inconsistent results if the Alerts page has filters or relative time ranges. 

IMPORTANT: If you've enabled grouping on the Alerts page, the expandable flyout won't open until you expand the collapsed group. 

NOTE: If you've configured the {kibana-ref}/settings.html#server-publicBaseUrl[`server.publicBaseUrl`] setting in the `kibana.yml` file, the shareable URL is also in the `kibana.alert.url` field. You can find the field by searching for `kibana.alert.url` on the *Table* tab.

Hover over fields on the *Overview* and *Table* tabs to display available <<inline-actions, inline actions>>. 

[role="screenshot"]
image::images/alert-details-flyout-inline-actions.png[Alert details flyout, 75%]

[discrete]
[[alert-details-overview]]
=== Overview tab

The *Overview* tab summarizes the alert and shows relevant threat intelligence details. Use this information to understand what generated the alert so you can triage and resolve it.

The *Overview* tab contains these sections:

* *About*: Displays the rule that the alert is related to, what caused the alert, and MITRE ATT&CK tactic or technique that the rule is linked to. Refer to <<about-section,About section>> to learn more. 

* *Investigation*: Shows the rule's investigation guide and relevant fields for the alert. Refer to <<investigation-section,Investigation section>> to learn more.

* *Visualizations*: Allows you to visualize the alert in the event analyzer or session viewer. Refer to <<visualizations-section,Visualizations section>> to learn more.

* *Insights*: Shows hosts and users related to the alert, threat intelligence on the alert, suppressed alerts, correlations, prevalence. Refer to <<insights-section,Insights section>> to learn more.

* *Response*: Shows response actions attached to the rule associated with the alert. Refer to <<response-section,Response section>> to learn more.

[discrete]
[[about-section]]
=== About section

The About section has the following information:

* *Summary*: Displays general details such as the alert's status, severity, risk score, and a link to the detection rule that produced the alert.

* *Rule description*: Describes the rule's purpose or detection goals. Click *Rule summary* to display the preview panel, which shows more information about the rule. 

* *Alert reason*: Describes the event that generated the alert. Event details are displayed in plain text and ordered logically to provide context for the alert. Click *Show full reason* to display the preview panel, which shows the alert reason in the event rendered view.  

+
NOTE: The event renderer only displays if an event renderer exists for the alert type. Fields are interactive; hover over to access the available actions.

* *MITRE ATT&CK*: Provides relevant https://attack.mitre.org/[MITRE ATT&CK] framework tactics, techniques, and subtechniques.

[discrete]
[[investigation-section]]
=== Investigation section

Shows the rule's investigation guide and relevant fields for the alert. 

If the rule associated with the alert has an investigation guide, the guide is displayed in this section. 

The Investigation section also displays relevant fields for the alert type. Use these fields to inform your triage efforts as you investigate the alert. 

// Explain what shows in the left panel when display more details about this sub-section.

[discrete]
[[visualizations-section]]
=== Visualizations section

Allows you to visualize the alert in the event analyzer or session viewer.

// Explain what shows in the left panel when display more details about this sub-section. More details are opened in Timeline.

[discrete]
[[insights-section]]
=== Insights section

The Insights section shows hosts and users related to the alert, threat intelligence on the alert, suppressed alerts, correlations, prevalence.

[discrete]
[[entities-section]]
==== Entities 

Shows hosts and users related to the alert.

Alerts can be enriched with user and host risk scores, which convey the level of risk associated with a specific user and host. Risk levels are `Unknown`, `Low`, `Moderate`, `High`, or `Critical`. Refer to <<host-risk-score>> and <<user-risk-score>> to learn how risk scores are calculated.

NOTE: User and host risk scores are technical preview features and require a https://www.elastic.co/pricing[Platinum subscription] or higher. You must enable user and host risk score features to access risk scores data. Refer to <<host-risk-score>> and <<user-risk-score>> to learn more.

// Explain what shows in the left panel when display more details about this sub-section.

[discrete]
[[alert-prevalence-section]]
==== Alert prevalence

Shows the total number of alerts within the selected time frame that have identical values. For example, an alert prevalence of 3 for `host.name` means three alerts with the same `host.name` value exist within the time frame.

Alert prevalence data can help you investigate relationships with other alerts and gain context about the events producing alerts. You can also click the alert prevalence count to explore the alerts in Timeline.

IMPORTANT: Before investigating alert prevalence data in Timeline, save any Timelines you're working on to ensure you can access them later.

// Explain what shows in the left panel when display more details about this sub-section.

[discrete]
[[threat-intelligence-section]]
==== Threat intelligence 

Alerts can be enriched with contextually relevant threat intelligence that you can use for triaging and investigating alerts. If available, this information appears in the Enriched data section.

When gathering threat intelligence data for an alert, {elastic-sec} queries the alert for indicator matches from the past 30 days. The query looks for the following fields:

- `file.hash.md5`: The MD5 hash
- `file.hash.sha1`: The SHA1 hash
- `file.hash.sha256`: The SHA256 hash
- `file.pe.imphash`: Imports in a PE file
- `file.elf.telfhash`: Imports in an ELF file
- `file.hash.ssdeep`: The SSDEEP hash
- `source.ip`: The IP address of the source (IPv4 or IPv6)
- `destination.ip`: The event's destination IP address
- `url.full`: The full URL of the event source
- `registry.path`: The full registry path, including the hive, key, and value

If these fields aren't available, {elastic-sec} does not perform the query and does not display threat intelligence data for the alert.

Available threat indicator match data appears in the **Threat Match Detected** subsection.

[role="screenshot"]
image::images/matched-indicator-sub-sec.png[Threat Match Detected subsection with matched file hash, 600]

All other available threat intelligence data appears in the **Enriched with Threat Intelligence** subsection.

[role="screenshot"]
image::images/threat-intel-sub-sec.png[Enriched with Threat Intelligence subsection with matched file hash, 700]

TIP: To learn more about the query, select the **Threat Intel** tab, then click the **Inspect** button next to the threat you want to inspect.

Additional threat intelligence data is generated for indicator match alerts when indicators are matched with source events, as outlined by the conditions in the relevant indicator match rule. Indicator match alerts always populate the *Threat Matched Detected* section under the *Threat Intel* tab with additional threat match data.

IMPORTANT: After upgrading to {stack} version 7.15.0 or newer from release versions 7.12.0 through 7.14.2, you need to migrate detection alerts enriched with threat intelligence data to ensure threat intelligence properly displays in {elastic-sec}. For more information, refer to instructions for <<post-upgrade-req-cti-alerts, migrating detection alerts enriched with threat intelligence data>>.

**Threat Intelligence tab**

The *Threat Intelligence* tab in the left panel (*Insights -> Threat Intelligence*) shows the number of individual threats matching the alert. You can expand and collapse threat details by clicking the arrow button at the end of the threat label. Each threat is labelled with values from the `matched.field` and `matched.atomic` fields and displays the threat intelligence provider. If the alert does not contain threat intelligence data, the *Threat Intel* tab displays a message that none is available.

Matched threats are organized into several sections, described below. Within each section, matched threats are shown in reverse chronological order, with the most recent at the top. All mapped fields are displayed for each matched threat.

* *Threat Matched Detected*: This section is solely reserved for threat indicator matches identified by an indicator match rule. Threat indicator matches are produced whenever event data matches a threat indicator field value in your indicator index. If indicator threat matches are not discovered, the section displays a message that none are available.
* *Enriched with Threat Intelligence*: This section shows indicator matches that {elastic-sec} found when querying the alert for fields with threat intelligence. You can use the date time picker to modify the query time frame, which looks at the past 30 days by default. Click the **Inspect** button, located on the far right of the threat label, to view more information on the query. If threat matches are not discovered within the selected time frame, the section displays a message that none are available.

NOTE: The event enrichment query uses the indices specified in the `securitySolution:defaultThreatIndex` advanced setting. For more information, refer to <<update-threat-intel-indices, Update default Elastic Security threat intelligence indices>>.

[discrete]
[[supressed-alerts-section]]
==== Suppressed alerts

Indicates that the alert was created with <<alert-suppression,alert suppression>>, and shows how many duplicate alerts were suppressed. This section only appears if alert suppression is enabled for the rule.

[discrete]
[[response-section]]
=== Response section

// Ditto
