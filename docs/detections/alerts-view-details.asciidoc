[[view-alert-details]]
== View detection alert details

:frontmatter-description: Create detection rules to monitor your environment for suspicious and malicious behavior.
:frontmatter-tags-products: [security, defend]
:frontmatter-tags-content-type: [reference]
:frontmatter-tags-user-goals: [manage]

To learn more about an alert, click the *View details* button from the Alerts table. This opens the alert details flyout, which provides you with a central place to assess the alert. 

[role="screenshot"]
image::images/open-alert-details-flyout.gif[Expandable flyout, 90%]

Use the alert details flyout to begin an investigation, open a case, or plan a response. Click **Take action** at the bottom of the flyout to find more options for interacting with the alert.

NOTE: To use the alert details flyout design from {elastic-sec} 8.9 and earlier, turn off the <<enable-expandable-flyout,`securitySolution:enableExpandableFlyout`>> advanced setting. 

[discrete]
[[alert-details-flyout-ui]]
== Alert details flyout UI 

The alert details flyout has a right panel, a preview panel, and a left panel. Each panel provides a different perspective of the alert.  

[discrete]
[[right-panel]]
=== Right panel 

The right panel provides an overview of the alert. Expand any of the collapsed sections to learn more about the alert. You can also hover over fields on the *Overview* and *Table* tabs to display available <<inline-actions, inline actions>>. 

[role="screenshot"]
image::images/alert-details-flyout-right-panel.png[Right panel of the alert details flyout, 65%]

From the right panel, you can also:

* Click **Expand details** to open the <<left-panel,left panel>>, which shows more information about sections in the right panel.
* Click **Chat** to access the <<security-assistant>>.
* Click **Share alert** to get a shareable URL to the alert. We _do not_ recommend copying the URL from your browser's address bar. The URL creates inconsistent results if you've set up filters or relative time ranges for the Alerts page. 
+
NOTE: If you've configured the {kibana-ref}/settings.html#server-publicBaseUrl[`server.publicBaseUrl`] setting in the `kibana.yml` file, the shareable URL is also in the `kibana.alert.url` field. You can find the field by searching for `kibana.alert.url` on the *Table* tab.
+
IMPORTANT: If you've enabled grouping on the Alerts page, the alert details flyout won't open until you expand the collapsed group.

* Find basic details about the alert, such as the:

** Associated rule
** Alert status
** Date and time the alert was created
** Alert severity and risk score (these are inherited from rule that generated the alert)

* Click the **Table** or **JSON** tabs to display the alert details in table or JSON format. In table format, alert details are displayed as field-value pairs. 

[discrete]
[[preview-panel]]
=== Preview panel 

The preview panel shows more information about the rule associated with the alert and the alert reason. This panel overlays the right panel when you click **Show rule details** or **Show full reason** in the <<about-section,About>> section. To close the preview panel, click **x**. 

[role="screenshot"]
image::images/alert-details-flyout-preview-panel.gif[Preview panel of the alert details flyout, 65%]

[discrete]
[[left-panel]]
=== Left panel 

The left panel provides an expanded view of what's shown in the right panel. To open the left panel, do one of the following:

* Click **Expand details** at the top of the right panel.
+

[role="screenshot"]
image::images/expand-details-button.png[Expand details button at the top of the alert details flyout, 45%]

* Click one of the section titles on the **Overview** tab within the right panel. 
+

[role="screenshot"]
image::images/alert-details-flyout-left-panel.png[Left panel of the alert details flyout, 45%]

[discrete]
[[about-section]]
== About 

The About section is located on the **Overview** tab in the right panel. It provides a brief description of the rule that's related to the alert and an explanation of what generated the alert. 

[role="screenshot"]
image::images/about-section-rp.png[About section of the Overview tab, 65%]

The About section has the following information:

* **Rule description**: Describes the rule's purpose or detection goals. Click **Show rule summary** to display more details about the rule within the <<preview-panel,preview panel>>. From the preview panel, click **Show rule details** to view the rule's details page. 

* **Alert reason**: Describes the source event that generated the alert. Event details are displayed in plain text and ordered logically to provide context for the alert. Click **Show full reason** to display the alert reason in the event rendered format within the <<preview-panel,preview panel>>.  
+
NOTE: The event renderer only displays if an event renderer exists for the alert type. Fields are interactive; hover over them to access the available actions.

* **MITRE ATT&CK**: Provides relevant https://attack.mitre.org/[MITRE ATT&CK] framework tactics, techniques, and sub-techniques.

[discrete]
[[investigation-section]]
== Investigation 

The Investigation section is located on the **Overview** tab in the right panel. It offers a couple of ways to begin investigating the alert. 

[role="screenshot"]
image::images/investigation-section-rp.png[Investigation section of the Overview tab, 65%]

The Investigation section provides the following information:

* **Investigation guide**: The **Show investigation guide** button displays if the rule associated with the alert has an investigation guide. Click the button to open the **Investigation** tab in the left panel of the alert details flyout.  
+
TIP: Add an <<add-ig-actions-rule,investigation guide>> to a rule when creating a new custom rule or modifying an existing custom rule's settings.

* **Highlighted fields**: Shows relevant fields for the alert and any custom highlighted fields you added to the rule. 
//link to custom highlighted fields docs

[discrete]
[[visualizations-section]]
== Visualizations 

The Visualizations section is located on the **Overview** tab in the right panel. It offers a glimpse of the processes that led up to the alert and occurred after it. 

[role="screenshot"]
image::images/visualizations-section-rp.png[Visualizations section of the Overview tab, 65%]

Click **Visualizations** to display the following sub-sections:

* **Session view preview**: Shows a preview of <<session-view,session view>> data. Click **Session viewer preview** to open the **Session View** tab in Timeline. 

* **Analyzer preview**: Shows a preview of the <<visual-event-analyzer,visual analyzer graph>>. The preview displays up to three levels of the analyzed event's ancestors and up to three levels of the event's descendants and children. The ellipses symbol (**`...`**) indicates the event has more ancestors and descendants to examine. Click **Analyzer preview** to open the **Event Analyzer** tab in Timeline.

[discrete]
[[insights-section]]
== Insights 

The Insights section is located on the **Overview** tab in the right panel. It offers different perspectives from which you can assess the alert. 

[role="screenshot"]
image::images/insights-section-rp.png[Insights section of the Overview tab, 65%]

Click **Insights** to display the following sub-sections:

* <<entities-section>>
* <<threat-intelligence-section>> 
* <<correlations-section>>
* <<prevalence-section>>

[discrete]
[[entities-section]]
=== Entities 

The Entities sub-section shows the user related to the alert and the host on which the alert was generated against. <<host-risk-score,Host>> and <<user-risk-score,user risk>> scores are also available with a https://www.elastic.co/pricing[Platinum subscription] or higher. 

NOTE: User and host risk scores are technical preview features. 

Click **Entities** to expand the **Entities** sub-tab in the left panel. The **Entities** sub-tab provides more information about the user and host, including notable activity on related hosts and users. 

[discrete]
[[threat-intelligence-section]]
=== Threat intelligence 

The Threat intelligence sub-section shows contextually relevant threat intelligence that was discovered on the alert. When gathering threat intelligence data for an alert, {elastic-sec} queries the alert for indicator matches from the past 30 days. The query looks for the following fields:

- `file.hash.md5`: The MD5 hash
- `file.hash.sha1`: The SHA1 hash
- `file.hash.sha256`: The SHA256 hash
- `file.pe.imphash`: Imports in a PE file
- `file.elf.telfhash`: Imports in an ELF file
- `file.hash.ssdeep`: The SSDEEP hash
- `source.ip`: The IP address of the source (IPv4 or IPv6)
- `destination.ip`: The event's destination IP address
- `url.full`: The full URL of the event source
- `registry.path`: The full registry path, including the hive, key, and value

If these fields aren't available, {elastic-sec} does not perform the query and does not display threat intelligence data for the alert.

Additional threat intelligence data is generated for indicator match alerts when indicators are matched with source events, as outlined by the conditions in the relevant indicator match rule. Indicator match alerts always populate the *Threat Matched Detected* section under the *Threat intelligence* tab with additional threat match data.

Click **Threat intelligence** to expand the **Threat intelligence** sub-tab in the left panel. Within the sub-tab, matched threats are organized into two sections: <<threat-match-detected-section>> and <<enriched-with-threat-intelligence-section>>. Matched threats are ordered in reverse chronological order, with the most recent at the top. All mapped fields are displayed for each matched threat.

[discrete]
[[threat-match-detected-section]]
==== Threat match detected

The Threat match detected section is solely reserved for threat indicator matches identified by an indicator match rule. Threat indicator matches are produced whenever event data matches a threat indicator field value in your indicator index. 

[discrete]
[[enriched-with-threat-intelligence-section]]
==== Enriched with threat intelligence

The Enriched with threat intelligence section shows indicator matches that {elastic-sec} found when querying the alert for fields with threat intelligence. You can use the date time picker to modify the query time frame, which looks at the past 30 days by default. 

Click the **Inspect** button, located on the far right of the threat label, to view more information on the query. If threat matches are not discovered within the selected time frame, the section displays a message that none are available.

NOTE: The event enrichment query uses the indices specified in the `securitySolution:defaultThreatIndex` advanced setting. For more information, refer to <<update-threat-intel-indices, Update default Elastic Security threat intelligence indices>>.

[discrete]
[[correlations-section]]
=== Correlations 

The Correlations sub-section shows how an alert is related to other alerts and offers ways to investigate related alerts. Use this information to quickly find patterns between alerts and then take action. 

The Correlations sub-section provides the following information: 

* **Suppressed alerts**: Indicates that the alert was created with alert suppression, and shows how many duplicate alerts were suppressed. This information only appears if alert suppression is enabled for the rule.
* **Alerts related by source event**: Shows alerts that were created by the same source event. This can help you find alerts with a shared origin and provide more context about the source event. 
* **Cases related to the alert**: Shows the total number and names of cases to which the alert has been added.
* **Alerts related by session ID**: Shows alerts that generated during the same <<session-view, session>>. These alerts share the same session ID, which is a unique ID for tracking a given Linux session. 
+
NOTE: To use this feature, you must enable the **Include session data** setting in your {elastic-defend} integration policy. Refer to <<enable-session-view, Enable Session View data>> for more information.
* **Alerts related by process ancestry**: Shows alerts that are related by process events on the same linear branch. When you examine this information further, note that alerts generated from processes on child or related branches are not shown. 
+
NOTE: To access data about alerts related by process ancestry, you must have a https://www.elastic.co/pricing[Platinum or higher subscription].

[discrete]
[[prevalence-section]]
=== Prevalence

The Prevalence sub-section shows how often data from the alert was observed on other host and user events. Prevalence calculations use data from the alert's highlighted fields and examine user and host events that occurred during the last 30 days. Click **Prevalence** to further examine prevalence data in the <<prevalence-sub-tab,Prevalence sub-tab>>. 

[discrete]
[[prevalence-sub-tab]]
==== Prevalence sub-tab

The **Prevalence** sub-tab is located under the **Insights** tab in the left panel. It shows relationships with other alerts, events, users, and hosts. Update the date time picker for the table to show data from a different time range. 

[role="screenshot"]
image::images/prevalence-sub-tab-lp.png[Table within the Prevalence sub-tab]

The following details are provided:

* **Field**: Shows <<investigation-section,highlighted fields>> for the alert and any custom highlighted fields that were added to the alert's rule.
* **Value**: Shows values for highlighted fields and any custom highlighted fields that were added to the alert's rule.
* **Alert count**: Shows the total number of alert documents that have identical field values, including the alert you're currently examining. For example, if the `host.name` field alert count is 5, there are five total alerts with the same `host.name` field value.
+
NOTE: Alert documents contain the {ecs-ref}/ecs-allowed-values-event-kind.html#ecs-event-kind-signal[`event.kind:signal`] field-value pair.  
* **Document count**: Shows the total number of event documents that have identical field values. A dash (`——`) displays if there are no event documents that match the field value.
+
NOTE: Event documents contain the {ecs-ref}/ecs-allowed-values-event-kind.html#ecs-event-kind-event[`event.kind:event`] field-value pair.  

* **Host prevalence**: Shows the percentage of unique hosts that have identical field values. Host prevalence for highlighted fields is calculated by taking the number of unique hosts with identical field values and dividing that number by the total number of unique hosts in your environment. 

* **User prevalence**: Shows the percentage of unique users that have identical field values. User prevalence for for highlighted fields is calculated by taking the number of unique users with identical field values and dividing that number by the total number of unique users in your environment. 

[discrete]
[[response-section]]
== Response 

The **Response** section is located on the **Overview** tab in the right panel. It shows <<rules-ui-create,response actions>> that were added to the rule associated with the alert. Click **Response** to display the response action's results in the left panel.

[role="screenshot"]
image::images/response-action-rp.png[Response section of the Overview tab, 50%]


