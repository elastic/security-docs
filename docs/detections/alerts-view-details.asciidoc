[[view-alert-details]]
== View detection alert details

:frontmatter-description: Create detection rules to monitor your environment for suspicious and malicious behavior.
:frontmatter-tags-products: [security, defend]
:frontmatter-tags-content-type: [reference]
:frontmatter-tags-user-goals: [manage]

To learn more about an alert, click the *View details* button from the Alerts table. This opens the expandable flyout, which provides you with a central place to assess information about an alert. Use this information to begin an investigation, open a case, or plan a response. 

[role="screenshot"]
image::images/view-alert-details.png[View details button, 200] 

.Requirements
[sidebar]
--
The `securitySolution:enableExpandableFlyout` setting must be turned on to use the expandable flyout. Turn the setting off to use the alert details flyout. 
--

[discrete]
[[expandable-flyout-ui]]
== Expandable flyout UI 

The expandable flyout has a right panel, a preview panel, and a left panel. When analyzing an alert, you can build upon your understanding of the alert by assessing the information in each panel. 

[role="screenshot"]
image::images/alert-details-flyout.png[Alert details flyout, 90%]

[discrete]
[[right-panel]]
=== Right panel 

Use the right panel to gain an overview of the alert. You can also do the following:

* Click **Expand details** to open the left panel, which contains more information about sections in the right panel.
* Click **Chat** to access the <<security-assistant>>.
* Click **Share alert** to get a shareable URL to the alert. copy the alert's URL to a clipboard. 
+

NOTE: If you've configured the {kibana-ref}/settings.html#server-publicBaseUrl[`server.publicBaseUrl`] setting in the `kibana.yml` file, the shareable URL is also in the `kibana.alert.url` field. You can find the field by searching for `kibana.alert.url` on the *Table* tab.

[IMPORTANT] 

======

* We do not recommend copying the URL from your browser's address bar. That URL create inconsistent results if you've set up filters or relative time ranges for the Alerts page. 
* If you've enabled grouping on the Alerts page, the expandable flyout won't open until you expand the collapsed group.
======

* Find basic alert details such as the:
** Name of the rule that's linked to the alert
** Date and time that the alert was created
** Status of the alert 
** Alert severity (The alert's severity is inherited from the rule severity.)
//Might want to link to create rule docs.
** Risk score (The alert's risk score is inherited from the rule risk score.)
//Might want to link to create rule docs.

* Click the Table or JSON tabs to display the alert details in table or JSON format. In table format, alert details are displayed as field-value pair. 
* Hover over fields on the *Overview* and *Table* tabs to display available <<inline-actions, inline actions>>. 
+
[role="screenshot"]
image::images/alert-details-flyout-inline-actions.png[Alert details flyout, 75%]

[discrete]
[[preview-panel]]
=== Preview panel 

Use the preview panel to learn more about the rule that's associated with the alert and the event that generated the alert. 

Click **Show rule summary** to show a more detailed view of the alert. Click **Show full reason** to display the alert reason in event rendered format. 

NOTE: The event renderer only displays if an event renderer exists for the alert type. Fields are interactive; hover over to access the available actions.

[discrete]
[[left-panel]]
=== Left panel 

Use the left panel to learn more about the information presented within the right panel. To open the left panel, click **Expand details** at the top of the right panel or click on a section title within the right panel. For example, to learn more about hosts or users related to the alert, go to the **Insights -> Entites**, then click **Entities**. This opens the **Entities** sub-tab in the left panel, which displays more details about the alert's host and user.

[discrete]
[[about-section]]
== About 

The About section has the following information:

* **Rule description**: Describes the rule's purpose or detection goals. Click *Rule summary* to display the preview panel, which shows more information about the rule. 

* **Alert reason**: Describes the event that generated the alert. Event details are displayed in plain text and ordered logically to provide context for the alert. Click *Show full reason* to display the preview panel, which shows the alert reason in the event rendered view.  

* **MITRE ATT&CK**: Provides relevant https://attack.mitre.org/[MITRE ATT&CK] framework tactics, techniques, and subtechniques.

[discrete]
[[investigation-section]]
== Investigation 

The Investigation section has the following information:

* **Investigation guide**: If the rule associated with the alert has an investigation guide, the guide is displayed in this section. 
* **Highlighted fields**: Shows relevant fields for the alert and any custom highlighted fields you added to the rule. 
//link to custom highlighted fields docs

[discrete]
[[visualizations-section]]
== Visualizations 

The Visualizations section has the following information:

* **Section view preview**: Shows TBD. Click **Session viewer preview** to open the **Session View** tab in Timeline. Refer to <<session-view>> to learn more about this feature and its requirements for this feature. 
* **Analyzer preview**: Shows TBD. Click **Analyzer preview** to open the Event Analyzer tab in Timeline. Refer to <<visual-event-analyzer>> to learn more about this feature and its requirements. 

[discrete]
[[insights-section]]
== Insights 

The Insights section shows hosts and users related to the alert, threat intelligence on the alert, suppressed alerts, correlations, prevalence.

[discrete]
[[entities-section]]
=== Entities 

Shows hosts and users related to the alert.

Alerts can be enriched with user and host risk scores, which convey the level of risk associated with a specific user and host. Risk levels are `Unknown`, `Low`, `Moderate`, `High`, or `Critical`. Refer to <<host-risk-score>> and <<user-risk-score>> to learn how risk scores are calculated.

NOTE: User and host risk scores are technical preview features and require a https://www.elastic.co/pricing[Platinum subscription] or higher. You must enable user and host risk score features to access risk scores data. Refer to <<host-risk-score>> and <<user-risk-score>> to learn more.

// Explain what shows in the left panel when display more details about this sub-section.

[discrete]
[[alert-prevalence-section]]
=== Alert prevalence

Shows the total number of alerts within the selected time frame that have identical values. For example, an alert prevalence of 3 for `host.name` means three alerts with the same `host.name` value exist within the time frame.

Alert prevalence data can help you investigate relationships with other alerts and gain context about the events producing alerts. You can also click the alert prevalence count to explore the alerts in Timeline.

IMPORTANT: Before investigating alert prevalence data in Timeline, save any Timelines you're working on to ensure you can access them later.

// Explain what shows in the left panel when display more details about this sub-section.

[discrete]
[[threat-intelligence-section]]
=== Threat intelligence 

Alerts can be enriched with contextually relevant threat intelligence that you can use for triaging and investigating alerts. If available, this information appears in the Enriched data section.

When gathering threat intelligence data for an alert, {elastic-sec} queries the alert for indicator matches from the past 30 days. The query looks for the following fields:

- `file.hash.md5`: The MD5 hash
- `file.hash.sha1`: The SHA1 hash
- `file.hash.sha256`: The SHA256 hash
- `file.pe.imphash`: Imports in a PE file
- `file.elf.telfhash`: Imports in an ELF file
- `file.hash.ssdeep`: The SSDEEP hash
- `source.ip`: The IP address of the source (IPv4 or IPv6)
- `destination.ip`: The event's destination IP address
- `url.full`: The full URL of the event source
- `registry.path`: The full registry path, including the hive, key, and value

If these fields aren't available, {elastic-sec} does not perform the query and does not display threat intelligence data for the alert.

Available threat indicator match data appears in the **Threat Match Detected** subsection.

[role="screenshot"]
image::images/matched-indicator-sub-sec.png[Threat Match Detected subsection with matched file hash, 600]

All other available threat intelligence data appears in the **Enriched with Threat Intelligence** subsection.

[role="screenshot"]
image::images/threat-intel-sub-sec.png[Enriched with Threat Intelligence subsection with matched file hash, 700]

TIP: To learn more about the query, select the **Threat Intel** tab, then click the **Inspect** button next to the threat you want to inspect.

Additional threat intelligence data is generated for indicator match alerts when indicators are matched with source events, as outlined by the conditions in the relevant indicator match rule. Indicator match alerts always populate the *Threat Matched Detected* section under the *Threat Intel* tab with additional threat match data.

IMPORTANT: After upgrading to {stack} version 7.15.0 or newer from release versions 7.12.0 through 7.14.2, you need to migrate detection alerts enriched with threat intelligence data to ensure threat intelligence properly displays in {elastic-sec}. For more information, refer to instructions for <<post-upgrade-req-cti-alerts, migrating detection alerts enriched with threat intelligence data>>.

**Threat Intelligence tab**

The *Threat Intelligence* tab in the left panel (*Insights -> Threat Intelligence*) shows the number of individual threats matching the alert. You can expand and collapse threat details by clicking the arrow button at the end of the threat label. Each threat is labelled with values from the `matched.field` and `matched.atomic` fields and displays the threat intelligence provider. If the alert does not contain threat intelligence data, the *Threat Intel* tab displays a message that none is available.

Matched threats are organized into several sections, described below. Within each section, matched threats are shown in reverse chronological order, with the most recent at the top. All mapped fields are displayed for each matched threat.

* *Threat Matched Detected*: This section is solely reserved for threat indicator matches identified by an indicator match rule. Threat indicator matches are produced whenever event data matches a threat indicator field value in your indicator index. If indicator threat matches are not discovered, the section displays a message that none are available.
* *Enriched with Threat Intelligence*: This section shows indicator matches that {elastic-sec} found when querying the alert for fields with threat intelligence. You can use the date time picker to modify the query time frame, which looks at the past 30 days by default. Click the **Inspect** button, located on the far right of the threat label, to view more information on the query. If threat matches are not discovered within the selected time frame, the section displays a message that none are available.

NOTE: The event enrichment query uses the indices specified in the `securitySolution:defaultThreatIndex` advanced setting. For more information, refer to <<update-threat-intel-indices, Update default Elastic Security threat intelligence indices>>.

[discrete]
[[correlations-section]]
=== Correlations 

// docs for suppressed alerts

Indicates that the alert was created with <<alert-suppression,alert suppression>>, and shows how many duplicate alerts were suppressed. This section only appears if alert suppression is enabled for the rule.

[discrete]
[[response-section]]
== Response section

Use this section to find out whether a <<rules-ui-create,response action>> was added to the rule that's associated with the alert. 
//Document how to access the left panel. 
