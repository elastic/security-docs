[[investigation-guide-actions]]
== Investigation guide actions

NOTE: This feature is available for {stack} versions 8.6.0 and newer.

Detection rule investigation guides suggest steps for triaging, analyzing, and responding to potential security issues. When you build a custom rule, you can also set up an investigation guide that incorporates runtime queries built from alert data or hard-coded literal values. This allows you to launch detailed Timeline investigations as you analyze alerts produced by the rule.


[float]
[[add-ig-actions-rule]]
=== Add investigation guide actions to a rule

NOTE: You can only add investigation guide actions to custom rules because Elastic prebuilt rules cannot be edited.

You can configure investigation guide actions when you create a new rule or edit an existing rule. When configuring the rule's settings (the *About rule* step for a new rule, the *About* tab for an existing rule), expand the *Advanced settings*, then scroll down to the *Investigation guide* field.

Add the following syntax to the *Investigation guide* field to create a query action. The syntax will be rendered as an action button in the alert and rule details.


[source,json]
----
!{insight{
    "label": "Test action",
    "description": "Click to investigate",
    "providers": [
      [
        {
          "field": "event.id",
          "value": "kibana.alert.original_event.id",
          "type": "parameter"
        }
      ],
      [
        {
          "field": "event.category",
          "value": "network",
          "type": "literal"
        },
        {
          "field": "process.pid",
          "value": "process.pid",
          "type": "parameter"
        }
      ]
    ]
  }
}
----


[float]
[[run-ig-actions-alert]]
=== Run investigation guide actions from an alert


