[[timeline-templates-ui]]
= About Timeline templates

You can attach Timeline templates to detection rules. When attached, the rule's
alerts use the template when they are investigated in Timeline. This enables
immediately viewing the alert's most interesting fields when you start an
investigation.

Templates can include two types of filters:

* *Regular filter*: Like other {kib} KQL filters, defines both the source
event field and its value. For example: `host.name : "win-server"`.
* *Template filter*: Only defines the event field and uses a placeholder
for the field's value. When you investigate an alert in Timeline, the field's
value is taken from the alert.

For example, if you define the `host.name: "{host.name}"` template filter, when
alerts generated by the rule are investigated in Timeline, the alert's
`host.name` value is used in the filter. If the alert's `host.name` value is
`Linux_stafordshire-061`, the Timeline filter is:
`host.name: "Linux_stafordshire-061"`.

NOTE: For information on how to add Timeline templates to rules, see
<<create-rule-ui>>.

When you load {es-sec} prebuilt rules, some prebuilt Timeline templates are
also loaded. You can attach these templates to detection rules. The following
templates are loaded:

* *Generic Endpoint Timeline*: Useful for investigating Elastic Endpoint
security alerts.
* *Generic Process Timeline*: Useful for investigating process-related alerts.
* *Generic Network Timeline*: Useful for investigating network-related alerts.
* *Generic Indicator Match Timeline*: Useful for investigating indicator match alerts.

TIP: You can <<man-templates-ui, duplicate prebuilt templates>> and use them as
a starting point for your own custom templates.

[discrete]
[[template-legend-ui]]
=== Timeline template legend

When you add filters to a Timelime template, the items are color coded to
indicate which type of filter is added. Additionally, you change Timeline
filters to template filters as you build your template.

Regular Timeline filter::
Clicking *Convert to template field* changes the filter to a template filter:
+
[role="screenshot"]
image::images/template-filter-value.png[width=30%]

Template filter::
+
[role="screenshot"]
image::images/timeline-template-filter.png[width=30%]

When you <<man-templates-ui, convert a template to a Timeline>>, template
filters with placeholders are disabled:

[role="screenshot"]
image::images/invalid-filter.png[width=30%]

To enable the filter, either specify a value or change it to a field's existing
filter (see <<pivot>>).


[discrete]
[[create-timeline-template]]
=== Create a Timeline template

. Go to *Investigate* -> *Timelines* -> *Templates*.
. Click *Create new timeline template*.
+
[role="screenshot"]
image::images/create-template-ui.png[]

. Give the template a title.
. Optionally, add a description and notes.
. To add filters, click *Add field*, and then select the required option:

* *Add field*: Add a regular Timeline filter.
* *Add template field*: Add a template filter with a value placeholder.

TIP: You can also drag and send items to the template from the *Overview*,
*Hosts*, *Network*, and *Alerts* pages.

*Example*

To create a template for process-related alerts on a specific host:

* Add a regular filter for the host name:
`host.name: "Linux_stafordshire-061"`
* Add template filter for process names: `process.name: "{process.name}"`

[role="screenshot"]
image::images/template-query-example.png[]

When alerts generated by rules associated with this template are investigated
in Timeline, the host name is `Linux_stafordshire-061`, whereas the process name
value is retrieved from the alert's `process.name` field.

[discrete]
[[man-templates-ui]]
=== Manage existing Timeline templates

You can view, duplicate, export, delete, and create templates from existing Timelines:

. Go to *Investigate* -> *Timelines* -> *Templates*.

+
[role="screenshot"]
image::images/all-actions-timeline-ui.png[]

. Click the *All actions* icon in the relevant row, and then select the action:

* *Create timeline from template* (see <<create-timeline-template>>)
* *Duplicate template*
* *Export selected* (see <<import-export-timeline-templates>>)
* *Delete selected*

TIP: To perform the same action on multiple templates, select templates and
then the required action from the *Bulk actions* menu.

NOTE: You cannot delete prebuilt templates.

[discrete]
[[import-export-timeline-templates]]
=== Export and import Timeline templates

You can import and export Timeline templates, which enables importing templates
from one {kib} space or instance to another. Exported templates are saved in an
http://ndjson.org[`ndjson`] file.

. Go to *Investigate* -> *Timelines* -> *Templates*.
. To export templates, do one of the following:

* To export one template, click the *All actions* icon in the relevant row and
then select *Export selected*.
* To export multiple templates, select all the required templates and then click
*Bulk actions* -> *Export selected*.

. To import templates, click *Import* and then select, or drag and drop,
the template `ndjson` file.
+
NOTE: Each template object in the file must be represented in a single line.
Multiple template objects are delimited with newlines.

NOTE: You cannot export prebuilt templates.
