[
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:23.899Z",
    "created_by": "elastic",
    "description": "Adversaries can add the `hidden` attribute to files to hide them from the user\nin an attempt to evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "d1d53e06-cd1c-446c-a5c3-3a2f5c1b4148",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "4630d948-40d4-4cef-ac69-4002e29bc3db",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Adding Hidden File Attribute via Attrib",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:attrib.exe and process.args:+h",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"attrib.exe\" and process.args:\"+h\"",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:24.052Z",
    "created_by": "elastic",
    "description": "Detects the creation of an executable file or files that will be automatically\nrun by Acrobat Reader when it starts.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "eab4dd35-a7ff-42c0-8b71-538f759756e7",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "2bf78aa2-9c56-48de-b139-f169bf99cf86",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Adobe Hijack Persistence",
    "query": "file.path:(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\" or \"C:\\Program Files\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\") and event.action:\"File created (rule: FileCreate)\" and not process.name:msiexec.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1044",
            "name": "File System Permissions Weakness",
            "reference": "https://attack.mitre.org/techniques/T1044/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.2",
          "pre_query": "file.path:(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\" or \"C:\\Program Files\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\") and event.action:\"File created (rule: FileCreate)\" and not process.name:msiexeec.exe",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.6.2",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.496Z",
    "updated_at": "2020-06-03T06:15:23.719Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected an Adversary Behavior. Click the Elastic Endpoint icon\nin the `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "44a12a50-a2f3-438e-bf1b-7060ce635525",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "77a3c3df-8ec4-4da4-b758-878f551dee69",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Adversary Behavior - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and (event.action:rules_engine_event or endgame.event_subtype_full:rules_engine_event)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:rules_engine_event",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.119Z",
    "created_by": "elastic",
    "description": "Searches for rare processes running on multiple Linux hosts in an entire fleet\nor network. This reduces the detection of false positives since automated\nmaintenance processes usually only run occasionally on a single machine but are\ncommon to all or many hosts in a fleet.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or\nquarterly workflow could trigger this signal."
    ],
    "from": "now-45m",
    "id": "11d26fc4-0c70-4591-9f09-503a3c95be4f",
    "immutable": true,
    "interval": "15m",
    "rule_id": "647fc812-7996-4795-8869-9c4ea595fe88",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "linux_anomalous_process_all_hosts_ecs",
    "risk_score": 21,
    "name": "Anomalous Process For a Linux Population",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate the presence of a Linux process that is rare\nand unusual for all of the monitored Linux hosts for which Auditbeat data is\navailable. Here are some possible avenues of investigation:\n\n* Consider the user as identified by the username field. Is this program part\nof an expected workflow for the user who ran this program on this host?\n* Examine the history of execution. If this process manifested only very\nrecently, it might be part of a new software package. If it has a consistent\nschedule - for example if it runs monthly or quarterly - it might be part of a\nmonthly or quarterly business process.\n* Examine the process arguments, title and working directory. These may provide\nindications as to the source of the program or the nature of the tasks it is\nperforming.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.401Z",
    "created_by": "elastic",
    "description": "Searches for rare processes running on multiple hosts in an entire fleet or\nnetwork. This reduces the detection of false positives since automated\nmaintenance processes usually only run occasionally on a single machine but are\ncommon to all or many hosts in a fleet.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or\nquarterly workflow could trigger this signal."
    ],
    "from": "now-45m",
    "id": "5e09e813-a414-4751-879b-38e70a40d4c6",
    "immutable": true,
    "interval": "15m",
    "rule_id": "6e40d56f-5c0e-4ac6-aece-bee96645b172",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_process_all_hosts_ecs",
    "risk_score": 21,
    "name": "Anomalous Process For a Windows Population",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate the presence of a Windows process that is rare\nand unusual for all of the Windows hosts for which Winlogbeat data is\navailable. Here are some possible avenues of investigation:\n\n* Consider the user as identified by the username field. Is this program part\nof an expected workflow for the user who ran this program on this host?\n* Examine the history of execution. If this process manifested only very\nrecently, it might be part of a new software package. If it has a consistent\nschedule - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n* Examine the process metadata like the values of the Company, Description and\nProduct fields, which may indicate whether the program is associated with an\nexpected software vendor or package.\n* Examine arguments and working directory. These may provide\nindications as to the source of the program or the nature of the tasks it is\nperforming.\n* Consider the same for the parent process. If the parent process is\na legitimate system utility or service, this could be related to software\nupdates or system management. If the parent process is something user-facing\nlike an Office application, this process could be more suspicious.\n* If you have file hash values in the event data, and you suspect malware, you\ncan optionally run a search for the file hash to see if the file is identified\nas malware by anti-malware tools.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.405Z",
    "created_by": "elastic",
    "description": "Identifies unusual parent-child process relationships that can indicate malware\nexecution or persistence mechanisms. Malicious scripts often call on other\napplications and processes as part of their exploit payload. For example, when a\nmalicious Office document runs scripts as part of an exploit payload, Excel or\nWord may start a script interpreter process, which, in turn, runs a script that\ndownloads and executes malware. Another common scenario is Outlook running an\nunusual process when malware is downloaded in an email. Monitoring and\nidentifying anomalous process relationships is a method of detecting new and\nemerging malware that is not yet recognized by anti-virus scanners.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Users running scripts in the course of technical support operations of software\nupgrades could trigger this signal. A newly installed program or one that runs\nrarely as part of a monthly or quarterly workflow could trigger this signal."
    ],
    "from": "now-45m",
    "id": "84a54224-378d-4797-8b3a-f408c44adfbf",
    "immutable": true,
    "interval": "15m",
    "rule_id": "0b29cab4-dbbd-4a3f-9e8e-1287c7c11ae5",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_process_creation",
    "risk_score": 21,
    "name": "Anomalous Windows Process Creation",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.199Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to disable the iptables or firewall service in an attempt to affect how a host is allowed to receive or send network traffic.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "ea0070d3-c5b2-4903-9095-37cc3302d6db",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "125417b8-d3df-479f-8418-12d7e034fee3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Attempt to Disable IPTables or Firewall",
    "query": "event.action:(executed or process_started) and (process.name:service and process.args:stop or process.name:chkconfig and process.args:off) and process.args:(ip6tables or iptables) or process.name:systemctl and process.args:(firewalld and (disable or stop or kill))",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:23.908Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to disable the syslog service in an attempt to an attempt to disrupt event logging and evade detection by security controls.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "7c3d8066-1e42-41e5-825d-9b57d0421c54",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "2f8a1226-5720-437d-9c20-e0029deb6194",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Attempt to Disable Syslog Service",
    "query": "event.action:(executed or process_started) and ((process.name:service and process.args:stop) or (process.name:chkconfig and process.args:off) or (process.name:systemctl and process.args:(disable or stop or kill))) and process.args:(syslog or rsyslog or \"syslog-ng\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.214Z",
    "created_by": "elastic",
    "description": "Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.",
    "enabled": false,
    "false_positives": [
      "Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."
    ],
    "from": "now-6m",
    "id": "4fa3389a-8cf3-4cac-8ebd-328e826b96ce",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "debff20a-46bc-4a4d-bae5-5cdd14222795",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Base16 or Base32 Encoding/Decoding Activity",
    "query": "event.action:(executed or process_started) and process.name:(base16 or base32 or base32plain or base32hex)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1027/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.055Z",
    "created_by": "elastic",
    "description": "Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.",
    "enabled": false,
    "false_positives": [
      "Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."
    ],
    "from": "now-6m",
    "id": "5c2379d2-758f-4b26-aa54-0de61770b074",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "97f22dab-84e8-409d-955e-dacd1d31670b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Base64 Encoding/Decoding Activity",
    "query": "event.action:(executed or process_started) and process.name:(base64 or base64plain or base64url or base64mime or base64pem)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1027/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.515Z",
    "updated_at": "2020-06-03T06:15:24.045Z",
    "created_by": "elastic",
    "description": "Identifies User Account Control (UAC) bypass via `eventvwr.exe.` Attackers\nbypass UAC to stealthily execute code with elevated permissions.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "06bd4d3b-d76f-4d05-b70e-cd9611edf976",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "31b4c719-f2b4-41f6-a9bd-fce93c2eaf62",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Bypass UAC via Event Viewer",
    "query": "process.parent.name:eventvwr.exe and event.action:\"Process Create (rule: ProcessCreate)\" and not process.executable:(\"C:\\Windows\\SysWOW64\\mmc.exe\" or \"C:\\Windows\\System32\\mmc.exe\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1088",
            "name": "Bypass User Account Control",
            "reference": "https://attack.mitre.org/techniques/T1088/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:23.992Z",
    "created_by": "elastic",
    "description": "Identifies attempts to clear Windows event log stores. This is often done by\nattackers in an attempt to evade detection or destroy forensic evidence on a\nsystem.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "ce3bbf29-5d1d-4270-8465-eac25255c504",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "d331bbe2-6db4-4941-80a5-8270db72eb61",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Clearing Windows Event Logs",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:wevtutil.exe and process.args:cl or process.name:powershell.exe and process.args:Clear-EventLog",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host",
            "reference": "https://attack.mitre.org/techniques/T1070/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and (process.name:\"wevtutil.exe\" and process.args:\"cl\") or (process.name:\"powershell.exe\" and process.args:\"Clear-EventLog\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.509Z",
    "updated_at": "2020-06-03T06:15:24.700Z",
    "created_by": "elastic",
    "description": "Identifies `cmd.exe` making a network connection. Adversaries can abuse\n`cmd.exe` to download or execute malware from a remote URL.",
    "enabled": false,
    "false_positives": [
      "Administrators may use the command prompt for regular administrative tasks. It's\nimportant to baseline your environment for network connections being made from\nthe command prompt to determine any abnormal use of this tool."
    ],
    "from": "now-6m",
    "id": "7f85e69f-62ca-4fde-991b-4ee04b4bf1b1",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "89f9a4b0-9f8f-4ee0-8823-c4751a6d6696",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Command Prompt Network Connection",
    "query": "process.name:cmd.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1105",
            "name": "Remote File Copy",
            "reference": "https://attack.mitre.org/techniques/T1105/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name:cmd.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.195Z",
    "created_by": "elastic",
    "description": "Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to publicly routable IP addresses.",
    "enabled": false,
    "false_positives": [
      "Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious."
    ],
    "from": "now-6m",
    "id": "e3841237-0103-4a97-9b19-b469764d6b2b",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "e19e64ee-130e-4c07-961f-8a339f0b8362",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Connection to External Network via Telnet",
    "query": "event.action:(\"connected-to\" or \"network_flow\") and process.name:telnet and not destination.ip:(127.0.0.0/8 or 10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"FE80::/10\" or \"::1/128\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.312Z",
    "created_by": "elastic",
    "description": "Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to non-publicly routable IP addresses.",
    "enabled": false,
    "false_positives": [
      "Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious."
    ],
    "from": "now-6m",
    "id": "6a93fb34-c720-4118-96ae-276db868c43b",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "1b21abcc-4d9f-4b08-a7f5-316f5f94b973",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Connection to Internal Network via Telnet",
    "query": "event.action:(\"connected-to\" or \"network_flow\") and process.name:telnet and destination.ip:((10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"FE80::/10\") and not (127.0.0.0/8 or \"::1/128\"))",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.496Z",
    "updated_at": "2020-06-03T06:15:23.710Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Credential Dumping. Click the Elastic Endpoint icon in\nthe `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "00413118-98c4-49fd-86d2-360c3155c325",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "571afc56-5ed9-465d-a2a9-045f099f6e7e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Credential Dumping - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:cred_theft_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.496Z",
    "updated_at": "2020-06-03T06:15:23.708Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Credential Dumping. Click the Elastic Endpoint icon\nin the `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "dc9195f5-d2ee-42ed-abd9-a7d63a36473c",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "db8c33a8-03cd-4988-9e2c-d0a4863adb13",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Credential Dumping - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:cred_theft_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.496Z",
    "updated_at": "2020-06-03T06:15:23.700Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Credential Manipulation. Click the Elastic Endpoint\nicon in the `event.module` column or the link in the `rule.reference` column in\nthe External Alerts tab of the SIEM *Detections* page for additional\ninformation.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "8696b318-a3f2-45f1-a335-5b846a0f9a9b",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "c0be5f31-e180-48ed-aa08-96b36899d48f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Credential Manipulation - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:token_manipulation_event or endgame.event_subtype_full:token_manipulation_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:token_manipulation_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.707Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Credential Manipulation. Click the Elastic Endpoint\nicon in the `event.module` column or the link in the `rule.reference` column in\nthe External Alerts tab of the SIEM *Detections* page for additional\ninformation.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "2bf563e5-5f41-4d4c-b970-f8ba23a85608",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "c9e38e64-3f4c-4bf3-ad48-0e61a60ea1fa",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Credential Manipulation - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:token_manipulation_event or endgame.event_subtype_full:token_manipulation_event)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:token_manipulation_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.114Z",
    "created_by": "elastic",
    "description": "Detects when an internal network client sends DNS traffic directly to the\nInternet. This is atypical behavior for a managed network, and can be indicative\nof malware, exfiltration, command and control, or, simply, misconfiguration.\nThis DNS activity also impacts your organization's ability to provide enterprise\nmonitoring and logging of DNS, and opens your network to a variety of abuses and\nmalicious communications.",
    "enabled": false,
    "false_positives": [
      "Exclude DNS servers from this rule as this is expected behavior. Endpoints\nusually query local DNS servers defined in their DHCP scopes, but this may be\noverridden if a user configures their endpoint to use a remote DNS server. This\nis uncommon in managed enterprise networks because it could break intranet name\nresolution when split horizon DNS is utilized. Some consumer VPN services and\nbrowser plug-ins may send DNS traffic to remote Internet destinations. In that\ncase, such devices or networks can be excluded from this rule when this is\nexpected behavior."
    ],
    "from": "now-6m",
    "id": "3b9e811f-04b0-4ce4-a2bd-b022ac96a98e",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "6ea71ff0-9e95-475b-9506-2580d1ce6154",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "DNS Activity to the Internet",
    "query": "destination.port:53 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.169.254/32 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or 224.0.0.252 or 255.255.255.255 or \"::1\" or \"ff02::fb\")",
    "references": [
      "https://www.us-cert.gov/ncas/alerts/TA15-240A",
      "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "destination.port:53 and (\n network.direction: outbound or (\n source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip:( 169.254.169.254/32 or 127.0.0.53/32 or 10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or ff02\\:\\:fb or 255.255.255.255 )\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.595Z",
    "created_by": "elastic",
    "description": "Detects unusually large numbers of DNS queries for a single top-level DNS\ndomain, which is often used for DNS tunneling. DNS tunneling can be used for\ncommand-and-control, persistence, or data exfiltration activity. For example,\n`dnscat` tends to generate many DNS questions for a top-level domain as it uses\nthe DNS protocol to tunnel data.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "DNS domains that use large numbers of child domains, such as software or content\ndistribution networks, can trigger this signal and such parent domains can be\nexcluded."
    ],
    "from": "now-45m",
    "id": "d941aef7-f406-4370-981c-dbb4c8f025c4",
    "immutable": true,
    "interval": "15m",
    "rule_id": "91f02f01-969f-4167-8f66-07827ac3bdd9",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "packetbeat_dns_tunneling",
    "risk_score": 21,
    "name": "DNS Tunneling",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Packetbeat"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:23.911Z",
    "created_by": "elastic",
    "description": "Identifies use of the `fsutil.exe` to delete the `USNJRNL` volume. This\ntechnique is used by attackers to eliminate evidence of files created during\npost-exploitation activities.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "e96196e7-8cac-4867-ad5b-2a00bc38d49d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "f675872f-6d85-40a3-b502-c0d2ef101e92",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Delete Volume USN Journal with Fsutil",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:fsutil.exe and process.args:(deletejournal and usn)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"fsutil.exe\" and process.args:(\"usn\" and \"deletejournal\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:24.196Z",
    "created_by": "elastic",
    "description": "Identifies use of the `wbadmin.exe` to delete the backup catalog. Ransomware and\nother malware may do this to prevent system recovery.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "1bf392ff-51ee-4808-a992-248358b9a9b8",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "581add16-df76-42bb-af8e-c979bfb39a59",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Deleting Backup Catalogs with Wbadmin",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:wbadmin.exe and process.args:(catalog and delete)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"wbadmin.exe\" and process.args:(\"delete\" and \"catalog\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:24.036Z",
    "created_by": "elastic",
    "description": "Identifies unexpected processes making network connections over port 445.\nWindows File Sharing is typically implemented over Server Message Block (SMB),\nwhich communicates between hosts using port 445. When legitimate, these network\nconnections are established by the kernel. Processes making 445/tcp connections\nmay be port scanners, exploits, or suspicious user-level processes moving\nlaterally.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "4fcc07de-dda0-49d9-bec4-ee35b5793343",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "c82c7d8f-fb9e-4874-a4bd-fd9e3f9becf1",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Direct Outbound SMB Connection",
    "query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and destination.port:445 and not process.pid:4 and not destination.ip:(127.0.0.1 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1210",
            "name": "Exploitation of Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1210/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and destination.port:445 and not process.pid:4 and not destination.ip:(\"127.0.0.1\" or \"::1\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:24.057Z",
    "created_by": "elastic",
    "description": "Identifies use of the `netsh.exe` to disable or weaken the local firewall.\nAttackers will use this command line tool to disable the firewall during\ntroubleshooting or to enable network mobility.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "2dda8fb5-729a-485c-94b4-bb171445ed92",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "4b438734-3793-4fda-bd42-ceeada0be8f9",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Disable Windows Firewall Rules via Netsh",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:netsh.exe and process.args:(disable and firewall and set) or process.args:(advfirewall and off and state)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"netsh.exe\" and process.args:(\"firewall\" and \"set\" and \"disable\") or process.args:(\"advfirewall\" and \"state\" and \"off\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:23.896Z",
    "created_by": "elastic",
    "description": "Identifies the use of `certutil.exe` to encode or decode data. CertUtil is a\nnative Windows component which is part of Certificate Services. CertUtil is\noften abused by attackers to encode or decode base64 data for stealthier command\nand control or exfiltration.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "162f1be0-8fac-4423-a10a-d0cd90d4bb47",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fd70c98a-c410-42dc-a2e3-761c71848acf",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Encoding or Decoding Files via CertUtil",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:certutil.exe and process.args:(-decode or -encode or /decode or /encode)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"certutil.exe\" and process.args:(\"-encode\" or \"/encode\" or \"-decode\" or \"/decode\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.198Z",
    "created_by": "elastic",
    "description": "Loadable Kernel Modules (or LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This identifies attempts to enumerate information about a kernel module.",
    "enabled": false,
    "false_positives": [
      "Security tools and device drivers may run these programs in order to enumerate kernel modules. Use of these programs by ordinary users is uncommon. These can be exempted by process name or username."
    ],
    "from": "now-6m",
    "id": "2193de67-0149-463d-b620-358aba423d78",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "2d8043ed-5bda-4caf-801c-c1feb7410504",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Enumeration of Kernel Modules",
    "query": "event.action:executed and process.args:(kmod and list and sudo or sudo and (depmod or lsmod or modinfo))",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1082",
            "name": "System Information Discovery",
            "reference": "https://attack.mitre.org/techniques/T1082/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.512Z",
    "updated_at": "2020-06-03T06:15:24.593Z",
    "created_by": "elastic",
    "description": "`RegSvcs.exe` and `RegAsm.exe` are Windows command line utilities that are used\nto register .NET Component Object Model (COM) assemblies. Adversaries can use\n`RegSvcs.exe` and `RegAsm.exe` to proxy execution of code through a trusted\nWindows utility.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "86abf242-e2ee-4dcc-b870-2479d3dc849b",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "47f09343-8d1f-4bb5-8bb0-00c9d18f5010",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Execution via Regsvcs/Regasm",
    "query": "process.name:(RegAsm.exe or RegSvcs.exe) and event.action:\"Process Create (rule: ProcessCreate)\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm",
            "reference": "https://attack.mitre.org/techniques/T1121/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm",
            "reference": "https://attack.mitre.org/techniques/T1121/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.705Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected an Exploit. Click the Elastic Endpoint icon in the\n`event.module` column or the link in the `rule.reference` column in the External\nAlerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "fdc68113-5cb9-4f58-8e13-901b95113ee3",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "2003cdc8-8d83-4aa5-b132-1f9a8eb48514",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Exploit - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:exploit_event or endgame.event_subtype_full:exploit_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:exploit_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.702Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented an Exploit. Click the Elastic Endpoint icon in the\n`event.module` column or the link in the `rule.reference` column in the External\nAlerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "eaadd2c9-affa-4c1d-96d8-2b7d1ee43547",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "2863ffeb-bf77-44dd-b7a5-93ef94b72036",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Exploit - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:exploit_event or endgame.event_subtype_full:exploit_event)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:exploit_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.612Z",
    "created_by": "elastic",
    "description": "Detects events that may indicate the use of FTP network connections to the\nInternet. The File Transfer Protocol (FTP) has been around in its current form\nsince the 1980s. It can be a common and efficient procedure on your network to\nsend and receive files. Because of this, adversaries will also often use this\nprotocol to exfiltrate data from your network or download new tools.\nAdditionally, FTP is a plain-text protocol which, if intercepted, may expose\nusernames and passwords. FTP activity involving servers subject to regulations\nor compliance standards may be unauthorized.",
    "enabled": false,
    "false_positives": [
      "FTP servers should be excluded from this rule as this is expected behavior. Some\nbusiness workflows may use FTP for data exchange. These workflows often have\nexpected characteristics such as users, sources, and destinations. FTP activity\ninvolving an unusual source or destination may be more suspicious. FTP activity\ninvolving a production server that has no known associated FTP workflow or\nbusiness requirement is often suspicious."
    ],
    "from": "now-6m",
    "id": "87c7d284-e773-4973-98f1-7a661bd318bd",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "87ec6396-9ac4-4706-bcf0-2ebb22002f43",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "FTP (File Transfer Protocol) Activity to the Internet",
    "query": "network.transport:tcp and destination.port:(20 or 21) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: (20 or 21) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.059Z",
    "created_by": "elastic",
    "description": "Malware or other files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "66f52991-d7ec-4ec5-95fe-e44546f547b0",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "a1329140-8de3-4445-9f87-908fb6d824f4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "File Deletion via Shred",
    "query": "event.action:(executed or process_started) and process.name:shred and process.args:(\"-u\" or \"--remove\" or \"-z\" or \"--zero\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.109Z",
    "created_by": "elastic",
    "description": "Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution.",
    "enabled": false,
    "false_positives": [
      "Certain programs or applications may modify files or change ownership in writable directories. These can be exempted by username."
    ],
    "from": "now-6m",
    "id": "7dfb646c-a1e4-4922-9c7a-3a4bcd1c13f8",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9f9a2a82-93a8-4b1a-8778-1780895626d4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "File Permission Modification in Writable Directory",
    "query": "event.action:executed and process.name:(chmod or chown or chattr or chgrp) and process.working_directory:(/tmp or /var/tmp or /dev/shm) and not user.name:root",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1222",
            "name": "File and Directory Permissions Modification",
            "reference": "https://attack.mitre.org/techniques/T1222/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:23.912Z",
    "created_by": "elastic",
    "description": "Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.",
    "enabled": false,
    "false_positives": [
      "Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."
    ],
    "from": "now-6m",
    "id": "38e8df2f-0b1c-4676-a91c-da083644cc96",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "a9198571-b135-4a76-b055-e3e5a476fd83",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Hex Encoding/Decoding Activity",
    "query": "event.action:(executed or process_started) and process.name:(hex or xxd)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1027/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.599Z",
    "created_by": "elastic",
    "description": "Hping ran on a Linux host. Hping is a FOSS command-line packet analyzer and has\nthe ability to construct network packets for a wide variety of network security\ntesting applications, including scanning and firewall auditing.",
    "enabled": false,
    "false_positives": [
      "Normal use of hping is uncommon apart from security testing and research. Use by\nnon-security engineers is very uncommon."
    ],
    "from": "now-6m",
    "id": "37c7f84b-7b76-47e8-a70e-54255d1e6a12",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "90169566-2260-4824-b8e4-8615c3b4ed52",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Hping Process Activity",
    "query": "process.name:(hping or hping2 or hping3) and event.action:executed",
    "references": [
      "https://en.wikipedia.org/wiki/Hping"
    ],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: (hping3 or hping2 or hping) and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.408Z",
    "created_by": "elastic",
    "description": "Detects events that could be describing IPSEC NAT Traversal traffic. IPSEC is a\nVPN technology that allows one system to talk to another using encrypted\ntunnels. NAT Traversal enables these tunnels to communicate over the Internet\nwhere one of the sides is behind a NAT router gateway. This may be common on\nyour network, but this technique is also used by threat actors to avoid\ndetection.",
    "enabled": false,
    "false_positives": [
      "Some networks may utilize these protocols but usage that is unfamiliar to local\nnetwork administrators can be unexpected and suspicious. Because this port is in\nthe ephemeral range, this rule may false under certain conditions, such as when\nan application server with a public IP address replies to a client which has\nused a UDP port in the range by coincidence. This is uncommon but such servers\ncan be excluded."
    ],
    "from": "now-6m",
    "id": "2f209140-7764-4148-8235-5ce9ede3f5d3",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "a9cb3641-ff4b-4cdc-a063-b4b8d02a67c7",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "IPSEC NAT Traversal Port Activity",
    "query": "network.transport:udp and destination.port:4500",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        }
      ]
    },
    "last_update": "7.6.1",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.125Z",
    "created_by": "elastic",
    "description": "Detects events that use common ports for Internet Relay Chat (IRC) to the\nInternet. IRC is a common protocol that can be used for chat and file transfers.\nThis protocol is also a good candidate for remote control of malware and data\ntransfers to and from a network.",
    "enabled": false,
    "false_positives": [
      "IRC activity may be normal behavior for developers and engineers but is unusual\nfor non-engineering end users. IRC activity involving an unusual source or\ndestination may be more suspicious. IRC activity involving a production server\nis often suspicious. Because these ports are in the ephemeral range, this rule\nmay false under certain conditions, such as when a NAT-ed web server replies to\na client which has used a port in the range by coincidence. In this case, these\nservers can be excluded. Some legacy applications may use these ports, but this\nis very uncommon and usually only appears in local traffic using private IPs,\nwhich does not match this rule's conditions."
    ],
    "from": "now-6m",
    "id": "7aa51133-6612-4b84-8a61-afa49ab13aa4",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "c6474c34-4953-447a-903e-9fcb7b6661aa",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "IRC (Internet Relay Chat) Protocol Activity to the Internet",
    "query": "network.transport:tcp and destination.port:(6667 or 6697) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port:(6667 or 6697) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.200Z",
    "created_by": "elastic",
    "description": "Identifies when a terminal (tty) is spawned via Perl. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "58be1a81-2b58-4e57-a373-3bd3a46fb388",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "05e5a668-7b51-4a67-93ab-e9af405c9ef3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Interactive Terminal Spawned via Perl",
    "query": "event.action:executed and process.name:perl and process.args:(\"exec \\\"/bin/sh\\\";\" or \"exec \\\"/bin/dash\\\";\" or \"exec \\\"/bin/bash\\\";\")",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.102Z",
    "created_by": "elastic",
    "description": "Identifies when a terminal (tty) is spawned via Python. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "6844b235-3b32-49fe-9a5c-cd522b4fbf79",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "d76b02ef-fc95-4001-9297-01cb7412232f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Interactive Terminal Spawned via Python",
    "query": "event.action:executed and process.name:python and process.args:(\"import pty; pty.spawn(\\\"/bin/sh\\\")\" or \"import pty; pty.spawn(\\\"/bin/dash\\\")\" or \"import pty; pty.spawn(\\\"/bin/bash\\\")\")",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.212Z",
    "created_by": "elastic",
    "description": "Kernel modules are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This rule identifies attempts to remove a kernel module.",
    "enabled": false,
    "false_positives": [
      "There is usually no reason to remove modules, but some buggy modules require it. These can be exempted by username. Note that some Linux distributions are not built to support the removal of modules at all."
    ],
    "from": "now-6m",
    "id": "2e7b6a8b-b2cd-4f42-b482-60901c60001c",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "cd66a5af-e34b-4bb0-8931-57d0a043f2ef",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Kernel Module Removal",
    "query": "event.action:executed and process.args:(rmmod and sudo or modprobe and sudo and (\"--remove\" or \"-r\"))",
    "references": [
      "http://man7.org/linux/man-pages/man8/modprobe.8.html"
    ],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1215",
            "name": "Kernel Modules and Extensions",
            "reference": "https://attack.mitre.org/techniques/T1215/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.499Z",
    "updated_at": "2020-06-03T06:15:23.914Z",
    "created_by": "elastic",
    "description": "A scheduled task can be used by an adversary to establish persistence, move\nlaterally, and/or escalate privileges.",
    "enabled": false,
    "false_positives": [
      "Legitimate scheduled tasks may be created during installation of new software."
    ],
    "from": "now-6m",
    "id": "333a2b52-a22f-4e42-bbff-d04c322e32de",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "afcce5ad-65de-4ed2-8516-5e093d3ac99a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Local Scheduled Task Commands",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:schtasks.exe and process.args:(-change or -create or -run or -s or /S or /change or /create or /run)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1053",
            "name": "Scheduled Task",
            "reference": "https://attack.mitre.org/techniques/T1053/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:schtasks.exe and process.args:(\"/create\" or \"-create\" or \"/S\" or \"-s\" or \"/run\" or \"-run\" or \"/change\" or \"-change\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.499Z",
    "updated_at": "2020-06-03T06:15:23.994Z",
    "created_by": "elastic",
    "description": "Identifies use of `sc.exe` to create, modify, or start services on remote hosts.\nThis could be indicative of adversary lateral movement but will be noisy if\ncommonly done by admins.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "e499976b-94d7-40bd-b429-9a481156697f",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "e8571d5f-bea1-46c2-9f56-998de2d3ed95",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Local Service Commands",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:sc.exe and process.args:(config or create or failure or start)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:sc.exe and process.args:(\"create\" or \"config\" or \"failure\" or \"start\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.717Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Malware. Click the Elastic Endpoint icon in the\n`event.module` column or the link in the `rule.reference` column in the External\nAlerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "d38a3703-88de-42dd-a031-f67da8ab6b06",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "0a97b20f-4144-49ea-be32-b540ecc445de",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 99,
    "name": "Malware - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:file_classification_event or endgame.event_subtype_full:file_classification_event)",
    "references": [],
    "severity": "critical",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:file_classification_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.795Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Malware. Click the Elastic Endpoint icon in the\n`event.module` column or the link in the `rule.reference` column in the External\nAlerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "3c5d5219-9547-4754-a584-8a377ed082e0",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "3b382770-efbb-44f4-beed-f5e0a051b895",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Malware - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:file_classification_event or endgame.event_subtype_full:file_classification_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:file_classification_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.510Z",
    "updated_at": "2020-06-03T06:15:24.504Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, loaded DLLs (dynamically\nlinked libraries) responsible for Windows credential management. This technique\nis sometimes used for credential dumping.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual."
    ],
    "from": "now-6m",
    "id": "8799ccd3-7e4c-4918-bbb7-57fb35b18a13",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae5",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Microsoft Build Engine Loading Windows Credential Libraries",
    "query": "(winlog.event_data.OriginalFileName: (vaultcli.dll or SAMLib.DLL) or dll.name: (vaultcli.dll or SAMLib.DLL)) and process.name: MSBuild.exe and event.action: \"Image loaded (rule: ImageLoad)\"",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1003",
            "name": "Credential Dumping",
            "reference": "https://attack.mitre.org/techniques/T1003/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.511Z",
    "updated_at": "2020-06-03T06:15:24.692Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, started a PowerShell script\nor the Visual C# Command Line Compiler. This technique is sometimes used to\ndeploy a malicious payload using the Build Engine.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual. If a build system triggers this rule it can be exempted by process,\nuser, or host name."
    ],
    "from": "now-6m",
    "id": "f20293df-8239-4870-81ce-1956054afcdd",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae6",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Microsoft Build Engine Started an Unusual Process",
    "query": "process.parent.name:MSBuild.exe and process.name:(csc.exe or iexplore.exe or powershell.exe)",
    "references": [
      "https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1500",
            "name": "Compile After Delivery",
            "reference": "https://attack.mitre.org/techniques/T1500/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.510Z",
    "updated_at": "2020-06-03T06:15:24.695Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started by a script or\nthe Windows command interpreter. This behavior is unusual and is sometimes used\nby malicious payloads.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual."
    ],
    "from": "now-6m",
    "id": "15d38236-2781-4ec6-916b-c5de079b8689",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Microsoft Build Engine Started by a Script Process",
    "query": "process.name:MSBuild.exe and process.parent.name:(cmd.exe or powershell.exe or cscript.exe or wscript.exe) and event.action:\"Process Create (rule: ProcessCreate)\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.511Z",
    "updated_at": "2020-06-03T06:15:24.615Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started by Explorer or\nthe WMI (Windows Management Instrumentation) subsystem. This behavior is unusual\nand is sometimes used by malicious payloads.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual."
    ],
    "from": "now-6m",
    "id": "78275016-0056-4cdd-8e4e-9ea420269c33",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Microsoft Build Engine Started by a System Process",
    "query": "process.name:MSBuild.exe and process.parent.name:(explorer.exe or wmiprvse.exe) and event.action:\"Process Create (rule: ProcessCreate)\"",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.510Z",
    "updated_at": "2020-06-03T06:15:24.609Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started by Excel or\nWord. This is unusual behavior for the Build Engine and could have been caused\nby an Excel or Word document executing a malicious script payload.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual. It is quite unusual for this program to be started by an Office\napplication like Word or Excel."
    ],
    "from": "now-6m",
    "id": "b43a566f-82fb-40c9-b1da-11742ba245fe",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "c5dc3223-13a2-44a2-946c-e9dc0aa0449c",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Microsoft Build Engine Started by an Office Application",
    "query": "process.name:MSBuild.exe and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or outlook.exe or powerpnt.exe or winword.exe) and event.action: \"Process Create (rule: ProcessCreate)\"",
    "references": [
      "https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"
    ],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.511Z",
    "updated_at": "2020-06-03T06:15:24.498Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started after being\nrenamed. This is uncommon behavior and may indicate an attempt to run MSBuild\nunnoticed or undetected.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual."
    ],
    "from": "now-6m",
    "id": "6092fba8-9b63-469f-9880-65417886a66d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Microsoft Build Engine Using an Alternate Name",
    "query": "(pe.original_file_name:MSBuild.exe or winlog.event_data.OriginalFileName: MSBuild.exe) and not process.name: MSBuild.exe and event.action: \"Process Create (rule: ProcessCreate)\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1036",
            "name": "Masquerading",
            "reference": "https://attack.mitre.org/techniques/T1036/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.044Z",
    "created_by": "elastic",
    "description": "The Linux `mknod` program is sometimes used in the command payload of a remote\ncommand injection (RCI) and other exploits. It is used to export a command shell\nwhen the traditional version of `netcat` is not available to the payload.",
    "enabled": false,
    "false_positives": [
      "Mknod is a Linux system program. Some normal use of this program, at varying\nlevels of frequency, may originate from scripts, automation tools, and\nframeworks. Usage by web servers is more likely to be suspicious."
    ],
    "from": "now-6m",
    "id": "0c401a66-c2d1-46e1-8755-672eaadc5f64",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "61c31c14-507f-4627-8c31-072556b89a9c",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Mknod Process Activity",
    "query": "process.name:mknod and event.action:executed",
    "references": [
      "https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: mknod and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.513Z",
    "updated_at": "2020-06-03T06:15:24.606Z",
    "created_by": "elastic",
    "description": "Identifies use of `bcdedit.exe` to delete boot configuration data. Malware and\nattackers sometimes use this tactic as a destructive technique.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "2fb827dc-f7a7-4d46-8547-38c1f27aba30",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "69c251fb-a5d6-4035-b5ec-40438bd829ff",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Modification of Boot Configuration",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:bcdedit.exe and process.args:(/set and (bootstatuspolicy and ignoreallfailures or no and recoveryenabled))",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.499Z",
    "updated_at": "2020-06-03T06:15:24.103Z",
    "created_by": "elastic",
    "description": "Identifies `MsBuild.exe` making outbound network connections. This may indicate\nadversarial activity as MsBuild is often leveraged by adversaries to execute\ncode and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "8cc1e7e4-4b88-47eb-a67c-aaa8b475c5ff",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0e79980b-4250-4a50-a509-69294c14e84b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "MsBuild Making Network Connections",
    "query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:MSBuild.exe and not destination.ip:(127.0.0.1 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:MSBuild.exe and not destination.ip:(\"127.0.0.1\" or \"::1\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.513Z",
    "updated_at": "2020-06-03T06:15:24.403Z",
    "created_by": "elastic",
    "description": "Identifies the SYSTEM account using the Net utility. The Net utility is a\ncomponent of the Windows operating system. It is used in command line operations\nfor control of users, groups, services, and network connections.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "87ef5153-19f9-4869-98b6-6ff094464153",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "2856446a-34e6-435b-9fb5-f8f040bfa7ed",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Net command via SYSTEM account",
    "query": "(process.name:net.exe or process.name:net1.exe and not process.parent.name:net.exe) and user.name:SYSTEM and event.action:\"Process Create (rule: ProcessCreate)\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1087",
            "name": "Account Discovery",
            "reference": "https://attack.mitre.org/techniques/T1087/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.093Z",
    "created_by": "elastic",
    "description": "A `netcat` process is engaging in network activity on a Linux host. Netcat is\noften used as a persistence mechanism by exporting a reverse shell or by serving\na shell on a listening port. Netcat is also sometimes used for data\nexfiltration.",
    "enabled": false,
    "false_positives": [
      "Netcat is a dual-use tool that can be used for benign or malicious activity.\nNetcat is included in some Linux distributions so its presence is not\nnecessarily suspicious. Some normal use of this program, while uncommon, may\noriginate from scripts, automation tools, and frameworks."
    ],
    "from": "now-6m",
    "id": "0d886f50-7a08-4bff-883c-4d62af29b362",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "adb961e0-cb74-42a0-af9e-29fc41f88f5f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Netcat Network Activity",
    "query": "process.name:(nc or ncat or netcat or netcat.openbsd or netcat.traditional) and event.action:(bound-socket or connected-to or socket_opened)",
    "references": [
      "http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet",
      "https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf",
      "https://en.wikipedia.org/wiki/Netcat"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: (nc or ncat or netcat or netcat.openbsd or netcat.traditional) and event.action: (connected-to or bound-socket or socket_opened)",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.509Z",
    "updated_at": "2020-06-03T06:15:24.042Z",
    "created_by": "elastic",
    "description": "Identifies `certutil.exe` making a network connection. Adversaries could abuse\n`certutil.exe` to download a certificate or malware from a remote URL.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "05df845a-e9f6-493e-af01-55bdcc6eeab5",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "3838e0e3-1850-4850-a411-2e8c5ba40ba8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Certutil",
    "query": "process.name:certutil.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1105",
            "name": "Remote File Copy",
            "reference": "https://attack.mitre.org/techniques/T1105/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.512Z",
    "updated_at": "2020-06-03T06:15:24.621Z",
    "created_by": "elastic",
    "description": "Compiled HTML files (`.chm`) are commonly distributed as part of the Microsoft\nHTML Help system. Adversaries may conceal malicious code in a CHM file and\ndeliver it to a victim for execution. CHM content is loaded by the HTML Help\nexecutable program (`hh.exe`).",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "2762f277-f38c-4b3f-9301-5ef35cec99ac",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "b29ee2be-bf99-446c-ab1a-2dc0183394b8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Compiled HTML File",
    "query": "process.name:hh.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name:hh.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.513Z",
    "updated_at": "2020-06-03T06:15:24.398Z",
    "created_by": "elastic",
    "description": "Identifies `msxsl.exe` making a network connection. This may indicate\nadversarial activity as `msxsl.exe` is often leveraged by adversaries to\nexecute malicious scripts and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "58e662e7-031f-4a19-a259-0352f0e67a74",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "b86afe07-0d98-4738-b15d-8d7465f95ff5",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via MsXsl",
    "query": "process.name:msxsl.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1220",
            "name": "XSL Script Processing",
            "reference": "https://attack.mitre.org/techniques/T1220/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.499Z",
    "updated_at": "2020-06-03T06:15:23.814Z",
    "created_by": "elastic",
    "description": "Identifies `mshta.exe` making a network connection. This may indicate\nadversarial activity as `mshta.exe` is often leveraged by adversaries to execute\nmalicious scripts and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "7ec5a263-7f7a-4a94-96ae-1b0c0edd886d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "a4ec1382-4557-452b-89ba-e413b22ed4b8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Network Connection via Mshta",
    "query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:mshta.exe",
    "references": [
      "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1170",
            "name": "Mshta",
            "reference": "https://attack.mitre.org/techniques/T1170/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:\"mshta.exe\"",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.514Z",
    "updated_at": "2020-06-03T06:15:24.694Z",
    "created_by": "elastic",
    "description": "Identifies the native Windows tools `regsvr32.exe` and `regsvr64.exe` making a\nnetwork connection. This may be indicative of an attacker bypassing whitelisting\nor running arbitrary scripts via a signed Microsoft binary.",
    "enabled": false,
    "false_positives": [
      "Security testing may produce events like this. Activity of this kind performed\nby non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "813eb4b6-d47b-4728-b419-39d52f2cab28",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fb02b8d3-71ee-4af1-bacd-215d23f17efa",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Regsvr",
    "query": "process.name:(regsvr32.exe or regsvr64.exe) and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 169.254.169.254 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1117",
            "name": "Regsvr32",
            "reference": "https://attack.mitre.org/techniques/T1117/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1117",
            "name": "Regsvr32",
            "reference": "https://attack.mitre.org/techniques/T1117/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "(process.name:regsvr32.exe or process.name:regsvr64.exe) and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:169.254.169.254/32 and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.513Z",
    "updated_at": "2020-06-03T06:15:24.299Z",
    "created_by": "elastic",
    "description": "Binaries signed with trusted digital certificates can execute on Windows systems\nprotected by digital signature validation. Adversaries may use these binaries to\n'live off the land' and execute malicious files that could bypass application\nwhitelisting and signature validation.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "754c17d4-a2d1-48be-b2ff-49f3931c0d0e",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "63e65ec3-43b1-45b0-8f2d-45b34291dc44",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Signed Binary",
    "query": "process.name:(expand.exe or extrac.exe or ieexec.exe or makecab.exe) and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "(process.name:expand.exe or process.name:extrac.exe or process.name:ieexec.exe or process.name:makecab.exe) and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.217Z",
    "created_by": "elastic",
    "description": "The Tcpdump program ran on a Linux host. Tcpdump is a network monitoring or\npacket sniffing tool that can be used to capture insecure credentials or data in\nmotion. Sniffing can also be used to discover details of network services as a\nprelude to lateral movement or defense evasion.",
    "enabled": false,
    "false_positives": [
      "Some normal use of this command may originate from server or network\nadministrators engaged in network troubleshooting."
    ],
    "from": "now-6m",
    "id": "6f9ec69d-111b-4f93-8777-4305e7c9c2a4",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "7a137d76-ce3d-48e2-947d-2747796a78c0",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Sniffing via Tcpdump",
    "query": "process.name:tcpdump and event.action:executed",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1040",
            "name": "Network Sniffing",
            "reference": "https://attack.mitre.org/techniques/T1040/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1040",
            "name": "Network Sniffing",
            "reference": "https://attack.mitre.org/techniques/T1040/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: tcpdump and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.121Z",
    "created_by": "elastic",
    "description": "Nmap was executed on a Linux host. Nmap is a FOSS tool for network scanning and\nsecurity testing. It can map and discover networks, and identify listening\nservices and operating systems. It is sometimes used to gather information in\nsupport of exploitation, execution or lateral movement.",
    "enabled": false,
    "false_positives": [
      "Security testing tools and frameworks may run `Nmap` in the course of security\nauditing. Some normal use of this command may originate from security engineers\nand network or server administrators. Use of nmap by ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "53a5c396-6b77-478e-bc30-c055091fb318",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "c87fca17-b3a9-4e83-b545-f30746c53920",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Nmap Process Activity",
    "query": "process.name:nmap",
    "references": [
      "https://en.wikipedia.org/wiki/Nmap"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: nmap",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.206Z",
    "created_by": "elastic",
    "description": "Nping ran on a Linux host. Nping is part of the Nmap tool suite and has the\nability to construct raw packets for a wide variety of security testing\napplications, including denial of service testing.",
    "enabled": false,
    "false_positives": [
      "Some normal use of this command may originate from security engineers and\nnetwork or server administrators, but this is usually not routine or\nunannounced. Use of `Nping` by non-engineers or ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "1ae6a034-25db-46ab-a1c3-76c4a72dc66b",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0d69150b-96f8-467c-a86d-a67a3378ce77",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Nping Process Activity",
    "query": "process.name:nping and event.action:executed",
    "references": [
      "https://en.wikipedia.org/wiki/Nmap"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: nping and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.205Z",
    "created_by": "elastic",
    "description": "Detects events that may indicate use of a PPTP VPN connection. Some threat\nactors use these types of connections to tunnel their traffic while avoiding\ndetection.",
    "enabled": false,
    "false_positives": [
      "Some networks may utilize PPTP protocols but this is uncommon as more modern VPN\ntechnologies are available. Usage that is unfamiliar to local network\nadministrators can be unexpected and suspicious. Torrenting applications may use\nthis port. Because this port is in the ephemeral range, this rule may false\nunder certain conditions, such as when an application server replies to a client\nthat used this port by coincidence. This is uncommon but such servers can be\nexcluded."
    ],
    "from": "now-6m",
    "id": "1b99bed0-d811-4f05-9c73-264f248a6f59",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "d2053495-8fe7-4168-b3df-dad844046be3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "PPTP (Point to Point Tunneling Protocol) Activity",
    "query": "network.transport:tcp and destination.port:1723",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        }
      ]
    },
    "last_update": "7.6.1",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.793Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Permission Theft. Click the Elastic Endpoint icon in\nthe `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "56b1a9f3-6e13-4283-b28b-61327ccffa3e",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "c3167e1b-f73c-41be-b60b-87f4df707fe3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Permission Theft - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:token_protection_event or endgame.event_subtype_full:token_protection_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:token_protection_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.818Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Permission Theft. Click the Elastic Endpoint icon in\nthe `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "229b9888-4994-464d-be31-ee631b615a82",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "453f659e-0429-40b1-bfdb-b6957286e04b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Permission Theft - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:token_protection_event or endgame.event_subtype_full:token_protection_event)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:token_protection_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.309Z",
    "created_by": "elastic",
    "description": "Identifies loadable kernel module errors, which are often indicative of\npotential persistence attempts.",
    "enabled": false,
    "false_positives": [
      "Security tools and device drivers may run these programs in order to load\nlegitimate kernel modules. Use of these programs by ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "aa00cb57-360f-4397-8056-61e184e65f30",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "81cc58f5-8062-49a2-ba84-5cc4b4d31c40",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Persistence via Kernel Module Modification",
    "query": "process.name:(insmod or kmod or modprobe or rmod) and event.action:executed",
    "references": [
      "https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/techniques/TA0003/"
        },
        "technique": [
          {
            "id": "T1215",
            "name": "Kernel Modules and Extensions",
            "reference": "https://attack.mitre.org/techniques/T1215/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: (insmod or kmod or modprobe or rmod) and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.513Z",
    "updated_at": "2020-06-03T06:15:24.494Z",
    "created_by": "elastic",
    "description": "The Application Shim was created to allow for backward compatibility of software\nas the operating system codebase changes over time. This Windows functionality\nhas been abused by attackers to stealthily gain persistence and arbitrary code\nexecution in legitimate Windows processes.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "cd3c3c9e-71a3-4b05-9021-8a02340ecc8d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fd4a992d-6130-4802-9ff8-829b89ae801f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Potential Application Shimming via Sdbinst",
    "query": "event.code:1 and process.name:sdbinst.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1138",
            "name": "Application Shimming",
            "reference": "https://attack.mitre.org/techniques/T1138/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1138",
            "name": "Application Shimming",
            "reference": "https://attack.mitre.org/techniques/T1138/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.code:1 and process.name:sdbinst.exe",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.051Z",
    "created_by": "elastic",
    "description": "Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over\nthe DNS protocol to circumvent firewalls, network security groups, and network\naccess lists while evading detection.",
    "enabled": false,
    "false_positives": [
      "Normal use of Iodine is uncommon apart from security testing and research. Use\nby non-security engineers is very uncommon."
    ],
    "from": "now-6m",
    "id": "b0990484-8a4b-4783-96a3-a42b6bf9b7b2",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "041d4d41-9589-43e2-ba13-5680af75ebc2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Potential DNS Tunneling via Iodine",
    "query": "process.name:(iodine or iodined) and event.action:executed",
    "references": [
      "https://code.kryo.se/iodine/"
    ],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: (iodine or iodined) and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.502Z",
    "updated_at": "2020-06-03T06:15:24.112Z",
    "created_by": "elastic",
    "description": "Identifies potential attempts to disable Security-Enhanced Linux (SELinux), which is a Linux kernel security feature to support access control policies. Adversaries may disable security tools to avoid possible detection of their tools and activities.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "a47db396-64d9-431b-b706-28a6272da37a",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "eb9eb8ba-a983-41d9-9c93-a1c05112ca5e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Potential Disabling of SELinux",
    "query": "event.action:executed and process.name:setenforce and process.args:0",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.510Z",
    "updated_at": "2020-06-03T06:15:24.604Z",
    "created_by": "elastic",
    "description": "The Filter Manager Control Program (fltMC.exe) binary may be abused by\nadversaries to unload a filter driver and evade defenses.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "6067b182-49bc-4190-baa0-23a46246f283",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "06dceabf-adca-48af-ac79-ffdf4c3b1e9a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Potential Evasion via Filter Manager",
    "query": "event.code:1 and process.name:fltMC.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1222",
            "name": "File and Directory Permissions Modification",
            "reference": "https://attack.mitre.org/techniques/T1222/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.code:1 and process.name:fltMC.exe",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.514Z",
    "updated_at": "2020-06-03T06:15:24.310Z",
    "created_by": "elastic",
    "description": "Windows contains accessibility features that may be launched with a key\ncombination before a user has logged in. An adversary can modify the way these\nprograms are launched to get a command prompt or backdoor without logging in to\nthe system.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "912d014a-cca4-4e88-a473-447f08e2f060",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "7405ddf1-6c8e-41ce-818f-48bea6bcaed8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Potential Modification of Accessibility Binaries",
    "query": "event.code:1 and process.parent.name:winlogon.exe and process.name:(atbroker.exe or displayswitch.exe or magnify.exe or narrator.exe or osk.exe or sethc.exe or utilman.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1015",
            "name": "Accessibility Features",
            "reference": "https://attack.mitre.org/techniques/T1015/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1015",
            "name": "Accessibility Features",
            "reference": "https://attack.mitre.org/techniques/T1015/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.code:1 and process.parent.name:winlogon.exe and (process.name:atbroker.exe or process.name:displayswitch.exe or process.name:magnify.exe or process.name:narrator.exe or process.name:osk.exe or process.name:sethc.exe or process.name:utilman.exe)",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.095Z",
    "created_by": "elastic",
    "description": "Identifies suspicious commands executed via a web server, which may suggest a\nvulnerability and remote shell access.",
    "enabled": false,
    "false_positives": [
      "Network monitoring or management products may have a web server component that\nruns shell commands as part of normal behavior."
    ],
    "from": "now-6m",
    "id": "78d57328-5686-4d78-88af-914cf35d0d6f",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "231876e7-4d1f-4d63-a47c-47dd1acdc1cb",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Potential Shell via Web Server",
    "query": "process.name:(bash or dash) and user.name:(apache or nginx or www or \"www-data\") and event.action:executed",
    "references": [
      "https://pentestlab.blog/tag/web-shell/"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/techniques/TA0003/"
        },
        "technique": [
          {
            "id": "T1100",
            "name": "Web Shell",
            "reference": "https://attack.mitre.org/techniques/T1100/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "pre_query": "process.name: bash and user.name: (apache or www or \"wwww-data\") and event.action:executed",
          "doc_text": "Updated query."
        },
        {
          "version": 3,
          "updated": "7.8.0",
          "pre_query": "process.name:bash and user.name:(apache or www or www-data) and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.8.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.509Z",
    "updated_at": "2020-06-03T06:15:24.614Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious parent child process relationship with `cmd.exe`\ndescending from `PowerShell.exe`.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "fc1d3da3-06ff-4e82-9d03-3b61c7e430d5",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0f616aee-8161-4120-857e-742366f5eeb3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "PowerShell spawning Cmd",
    "query": "process.parent.name:powershell.exe and process.name:cmd.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1086",
            "name": "PowerShell",
            "reference": "https://attack.mitre.org/techniques/T1086/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.parent.name:powershell.exe and process.name:cmd.exe",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.511Z",
    "updated_at": "2020-06-03T06:15:24.603Z",
    "created_by": "elastic",
    "description": "Compiled HTML files (`.chm`) are commonly distributed as part of the Microsoft\nHTML Help system. Adversaries may conceal malicious code in a CHM file and\ndeliver it to a victim for execution. CHM content is loaded by the HTML Help\nexecutable program (`hh.exe`).",
    "enabled": false,
    "false_positives": [
      "The HTML Help executable program (`hh.exe`) runs whenever a user clicks a\ncompiled help (`.chm`) file or menu item that opens the help file inside the\nHelp Viewer. This is not always malicious, but adversaries may abuse this\ntechnology to conceal malicious code."
    ],
    "from": "now-6m",
    "id": "f98e278b-5701-4f6a-acb8-8a8e22fc6ee8",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "e3343ab9-4245-4715-b344-e11c56b0a47f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Process Activity via Compiled HTML File",
    "query": "event.code:1 and process.name:hh.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.code:1 and process.name:hh.exe",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.514Z",
    "updated_at": "2020-06-03T06:15:24.620Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to get information about running processes on a system.",
    "enabled": false,
    "false_positives": [
      "Administrators may use the tasklist command to display a list of currently\nrunning processes. By itself, it does not indicate malicious activity. After\nobtaining a foothold, it's possible adversaries may use discovery commands like\ntasklist to get information about running processes."
    ],
    "from": "now-6m",
    "id": "8d51b00f-7117-4693-b795-cefdf7de31f8",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "cc16f774-59f9-462d-8b98-d27ccd4519ec",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Process Discovery via Tasklist",
    "query": "event.code:1 and process.name:tasklist.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1057",
            "name": "Process Discovery",
            "reference": "https://attack.mitre.org/techniques/T1057/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.code:1 and process.name:tasklist.exe",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.996Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Process Injection. Click the Elastic Endpoint icon in\nthe `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "74d74c43-0314-40db-a7bd-d1d883e4a30b",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "80c52164-c82a-402c-9964-852533d58be1",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Process Injection - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:kernel_shellcode_event or endgame.event_subtype_full:kernel_shellcode_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:kernel_shellcode_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:24.035Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Process Injection. Click the Elastic Endpoint icon in\nthe `event.module` column or the link in the `rule.reference` column in the\nExternal Alerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "5b16c9a4-8952-4e56-bf94-2e871e86f8e8",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "990838aa-a953-4f3e-b3cb-6ddf7584de9e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Process Injection - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:kernel_shellcode_event or endgame.event_subtype_full:kernel_shellcode_event)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:kernel_shellcode_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.512Z",
    "updated_at": "2020-06-03T06:15:24.596Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, created a thread in another\nprocess. This technique is sometimes used to evade detection or elevate\nprivileges.",
    "enabled": false,
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers\nis unusual."
    ],
    "from": "now-6m",
    "id": "46724266-1b2b-4e72-8001-8f0975340ee3",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae9",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Process Injection by the Microsoft Build Engine",
    "query": "process.name:MSBuild.exe and event.action:\"CreateRemoteThread detected (rule: CreateRemoteThread)\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1055",
            "name": "Process Injection",
            "reference": "https://attack.mitre.org/techniques/T1055/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1055",
            "name": "Process Injection",
            "reference": "https://attack.mitre.org/techniques/T1055/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.394Z",
    "created_by": "elastic",
    "description": "Detects events that may describe network events of proxy use to the Internet. It\nincludes popular HTTP proxy ports and SOCKS proxy ports. Typically, environments\nwill use an internal IP address for a proxy server. It can also be used to\ncircumvent network controls and detection mechanisms.",
    "enabled": false,
    "false_positives": [
      "Some proxied applications may use these ports but this usually occurs in local\ntraffic using private IPs which this rule does not match. Proxies are widely\nused as a security technology but in enterprise environments this is usually\nlocal traffic which this rule does not match. Internet proxy services using\nthese ports can be white-listed if desired. Some screen recording applications\nmay use these ports.\n\nProxy port activity involving an unusual source or\ndestination may be more suspicious. Some cloud environments may use this port\nwhen VPNs or direct connects are not in use and cloud instances are accessed\nacross the Internet. Because these ports are in the ephemeral range, this rule\nmay false under certain conditions such as when a NATed web server replies to a\nclient which has used a port in the range by coincidence. In this case, such\nservers can be excluded."
    ],
    "from": "now-6m",
    "id": "3fe91108-8877-4c7d-ad5c-810cce5ec417",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "ad0e5e75-dd89-4875-8d0a-dfdc1828b5f3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Proxy Port Activity to the Internet",
    "query": "network.transport:tcp and destination.port:(1080 or 3128 or 8080) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: (3128 or 8080 or 1080) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.499Z",
    "updated_at": "2020-06-03T06:15:24.038Z",
    "created_by": "elastic",
    "description": "Identifies use of the SysInternals tool `PsExec.exe` making a network\nconnection. This could be an indication of lateral movement.",
    "enabled": false,
    "false_positives": [
      "PsExec is a dual-use tool that can be used for benign or malicious activity.\nIt's important to baseline your environment to determine the amount of noise to\nexpect from this tool."
    ],
    "from": "now-6m",
    "id": "95243798-3055-4ed8-aae1-4d8af4b493ae",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "55d551c6-333b-4665-ab7e-5d14a59715ce",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "PsExec Network Connection",
    "query": "process.name:PsExec.exe and event.action:\"Network connection detected (rule: NetworkConnect)\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1035",
            "name": "Service Execution",
            "reference": "https://attack.mitre.org/techniques/T1035/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1035",
            "name": "Service Execution",
            "reference": "https://attack.mitre.org/techniques/T1035/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name:PsExec.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" ",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.211Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of RDP traffic from the\nInternet. RDP is commonly used by system administrators to remotely control a\nsystem for maintenance or to use shared resources. It should almost never be\ndirectly exposed to the Internet, as it is frequently targeted and exploited by\nthreat actors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "Some network security policies allow RDP directly from the Internet but usage\nthat is unfamiliar to server or network owners can be unexpected and suspicious.\nRDP services may be exposed directly to the Internet in some networks such as\ncloud environments. In such cases, only RDP gateways, bastions or jump servers\nmay be expected expose RDP directly to the Internet and can be exempted from\nthis rule. RDP may be required by some workflows such as remote access and\nsupport for specialized software products and servers. Such work- flows are\nusually known and not unexpected."
    ],
    "from": "now-6m",
    "id": "f563dd1a-7e16-4747-a38c-dad02944b72b",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "8c1bdde8-4204-45c0-9e0c-c85ca3902488",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "RDP (Remote Desktop Protocol) from the Internet",
    "query": "network.transport:tcp and destination.port:3389 and not source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: 3389 and (\n network.direction: inbound or (\n not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n and destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.218Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of RDP traffic to the Internet.\nRDP is commonly used by system administrators to remotely control a system for\nmaintenance or to use shared resources. It should almost never be directly\nexposed to the Internet, as it is frequently targeted and exploited by threat\nactors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "RDP connections may be made directly to Internet destinations in order to access\nWindows cloud server instances but such connections are usually made only by\nengineers. In such cases, only RDP gateways, bastions or jump servers may be\nexpected Internet destinations and can be exempted from this rule. RDP may be\nrequired by some workflows such as remote access and support for specialized\nsoftware products and servers. Such workflows are usually known and not\nunexpected. Usage that is unfamiliar to server or network owners can be\nunexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "d529ee5f-31f0-4af6-a841-fadc6623bd3e",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "e56993d2-759c-4120-984c-9ec9bb940fd5",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "RDP (Remote Desktop Protocol) to the Internet",
    "query": "network.transport:tcp and destination.port:3389 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: 3389 and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.321Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of RPC traffic from the\nInternet. RPC is commonly used by system administrators to remotely control a\nsystem for maintenance or to use shared resources. It should almost never be\ndirectly exposed to the Internet, as it is frequently targeted and exploited by\nthreat actors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "3034de5a-a0db-491f-b73c-d5e727102525",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "143cb236-0956-4f42-a706-814bcaa0cf5a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "RPC (Remote Procedure Call) from the Internet",
    "query": "network.transport:tcp and destination.port:135 and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: 135 and (\n network.direction: inbound or (\n not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.202Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of RPC traffic to the Internet.\nRPC is commonly used by system administrators to remotely control a system for\nmaintenance or to use shared resources. It should almost never be directly\nexposed to the Internet, as it is frequently targeted and exploited by threat\nactors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "507ab96d-ae1d-46aa-9226-960aa885fd5c",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "32923416-763a-4531-bb35-f33b9232ecdb",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "RPC (Remote Procedure Call) to the Internet",
    "query": "network.transport:tcp and destination.port:135 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: 135 and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.497Z",
    "updated_at": "2020-06-03T06:15:23.892Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Ransomware. Click the Elastic Endpoint icon in the\n`event.module` column or the link in the `rule.reference` column in the External\nAlerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "12416dcd-3ac1-4098-a5ae-9a7e34474609",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "8cb4f625-7743-4dfb-ae1b-ad92be9df7bd",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 99,
    "name": "Ransomware - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:ransomware_event or endgame.event_subtype_full:ransomware_event)",
    "references": [],
    "severity": "critical",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:ransomware_event and endgame.metadata.type:detection",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.498Z",
    "updated_at": "2020-06-03T06:15:23.894Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Ransomware. Click the Elastic Endpoint icon in the\n`event.module` column or the link in the `rule.reference` column in the External\nAlerts tab of the SIEM *Detections* page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-15m",
    "id": "d3ff521f-895c-484b-b55f-b4d209f0c275",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "e3c5d5cb-41d5-4206-805c-f30561eae3ac",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Ransomware - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:ransomware_event or endgame.event_subtype_full:ransomware_event)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.kind:alert and event.module:endgame and event.action:ransomware_event and endgame.metadata.type:prevention",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.117Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of Windows file sharing (also\ncalled SMB or CIFS) traffic to the Internet. SMB is commonly used within\nnetworks to share files, printers, and other system resources amongst trusted\nsystems. It should almost never be directly exposed to the Internet, as it is\nfrequently targeted and exploited by threat actors as an initial access or back-\ndoor vector or for data exfiltration.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "07f5d8dc-a706-4d9a-9277-5a1d8221cf2a",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "c82b2bd8-d701-420c-ba43-f11a155b681a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "SMB (Windows File Sharing) Activity to the Internet",
    "query": "network.transport:tcp and destination.port:(139 or 445) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: (139 or 445) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.406Z",
    "created_by": "elastic",
    "description": "Detects events that may indicate use of SMTP on TCP port 26. This port is\ncommonly used by several popular mail transfer agents to deconflict with the\ndefault SMTP port 25. This port has also been used by a malware family called\nBadPatch for command and control of Windows systems.",
    "enabled": false,
    "false_positives": [
      "Servers that process email traffic may cause false positives and should be\nexcluded from this rule as this is expected behavior."
    ],
    "from": "now-6m",
    "id": "a8efff3a-03b7-405c-a8e8-a558f805e96b",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "d7e62693-aab9-4f66-a21a-3d79ecdd603d",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "SMTP on Port 26/TCP",
    "query": "network.transport:tcp and destination.port:26",
    "references": [
      "https://unit42.paloaltonetworks.com/unit42-badpatch/",
      "https://isc.sans.edu/forums/diary/Next+up+whats+up+with+TCP+port+26/25564/"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        }
      ]
    },
    "last_update": "7.6.1",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.302Z",
    "created_by": "elastic",
    "description": "Detects events that may describe SMTP traffic from internal hosts to a host\nacross the Internet. In an enterprise network, there is typically a dedicated\ninternal host that performs this function. It is also frequently abused by\nthreat actors for command and control, or data exfiltration.",
    "enabled": false,
    "false_positives": [
      "NATed servers that process email traffic may false and should be excluded from\nthis rule as this is expected behavior for them. Consumer and personal devices\nmay send email traffic to remote Internet destinations. In this case, such\ndevices or networks can be excluded from this rule if this is expected behavior."
    ],
    "from": "now-6m",
    "id": "23fa1311-bc4a-450f-95a6-86d2c126d643",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "67a9beba-830d-4035-bfe8-40b7e28f8ac4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "SMTP to the Internet",
    "query": "network.transport:tcp and destination.port:(25 or 465 or 587) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: (25 or 465 or 587) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.107Z",
    "created_by": "elastic",
    "description": "Detects events that may describe database traffic (MS SQL, Oracle, MySQL, and\nPostgresql) across the Internet. Databases should almost never be directly\nexposed to the Internet, as they are frequently targeted by threat actors to\ngain initial access to network resources.",
    "enabled": false,
    "false_positives": [
      "Because these ports are in the ephemeral range, this rule may false under\ncertain conditions such as when a NATed web server replies to a client which has\nused a port in the range by coincidence. In this case, such servers can be\nexcluded if desired. Some cloud environments may use this port when VPNs or\ndirect connects are not in use and database instances are accessed directly\nacross the Internet."
    ],
    "from": "now-6m",
    "id": "3f3b6863-1fa4-4b7a-9371-0963146e63ee",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "139c7458-566a-410c-a5cd-f80238d6a5cd",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "SQL Traffic to the Internet",
    "query": "network.transport:tcp and destination.port:(1433 or 1521 or 3336 or 5432) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: (1433 or 1521 or 3336 or 5432) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.697Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of SSH traffic from the\nInternet. SSH is commonly used by system administrators to remotely control a\nsystem using the command line shell. If it is exposed to the Internet, it should\nbe done with strong security controls as it is frequently targeted and exploited\nby threat actors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "Some network security policies allow SSH directly from the Internet but usage\nthat is unfamiliar to server or network owners can be unexpected and suspicious.\nSSH services may be exposed directly to the Internet in some networks such as\ncloud environments. In such cases, only SSH gateways, bastions or jump servers\nmay be expected expose SSH directly to the Internet and can be exempted from\nthis rule. SSH may be required by some workflows such as remote access and\nsupport for specialized software products and servers. Such workflows are\nusually known and not unexpected."
    ],
    "from": "now-6m",
    "id": "d7786a99-ab51-4d4d-b9b3-8591333cb60a",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "ea0784f0-a4d7-4fea-ae86-4baaf27a6f17",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "SSH (Secure Shell) from the Internet",
    "query": "network.transport:tcp and destination.port:22 and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port:22 and (\n network.direction: inbound or (\n not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.610Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of SSH traffic to the Internet.\nSSH is commonly used by system administrators to remotely control a system using\nthe command line shell. If it is exposed to the Internet, it should be done with\nstrong security controls as it is frequently targeted and exploited by threat\nactors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "SSH connections may be made directly to Internet destinations in order to access\nLinux cloud server instances but such connections are usually made only by\nengineers. In such cases, only SSH gateways, bastions or jump servers may be\nexpected Internet destinations and can be exempted from this rule. SSH may be\nrequired by some workflows such as remote access and support for specialized\nsoftware products and servers. Such workflows are usually known and not\nunexpected. Usage that is unfamiliar to server or network owners can be\nunexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "6e8d6bb0-2943-4633-aa98-dc035d303bfd",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "6f1500bc-62d7-4eb9-8601-7485e87da2f4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "SSH (Secure Shell) to the Internet",
    "query": "network.transport:tcp and destination.port:22 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port:22 and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.598Z",
    "created_by": "elastic",
    "description": "An adversary may add the setgid bit to a file or directory in order to run a file with the privileges of the owning group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setgid bit to get code running in a different user\u2019s context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "6d12e5eb-8ad6-4a26-8200-9c00505fbc66",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "3a86e085-094c-412d-97ff-2439731e59cb",
    "language": "lucene",
    "output_index": ".siem-signals-default",
    "max_signals": 33,
    "risk_score": 21,
    "name": "Setgid Bit Set via chmod",
    "query": "event.action:(executed OR process_started) AND process.name:chmod AND process.args:(g+s OR /2[0-9]{3}/) AND NOT user.name:root",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.033Z",
    "created_by": "elastic",
    "description": "An adversary may add the setuid bit to a file or directory in order to run a file with the privileges of the owning user. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid bit to get code running in a different user\u2019s context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "5a15b71c-3a0d-42cf-854e-61870bb8b19a",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "8a1b0278-0f9a-487d-96bd-d4833298e87a",
    "language": "lucene",
    "output_index": ".siem-signals-default",
    "max_signals": 33,
    "risk_score": 21,
    "name": "Setuid Bit Set via chmod",
    "query": "event.action:(executed OR process_started) AND process.name:chmod AND process.args:(u+s OR /4[0-9]{3}/) AND NOT user.name:root",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.397Z",
    "created_by": "elastic",
    "description": "A Socat process is running on a Linux host. Socat is often used as a persistence\nmechanism by exporting a reverse shell, or by serving a shell on a listening\nport. Socat is also sometimes used for lateral movement.",
    "enabled": false,
    "false_positives": [
      "Socat is a dual-use tool that can be used for benign or malicious activity. Some\nnormal use of this program, at varying levels of frequency, may originate from\nscripts, automation tools, and frameworks. Usage by web servers is more likely\nto be suspicious."
    ],
    "from": "now-6m",
    "id": "77c7abd7-d571-4adc-8ee7-225e17f1ff83",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "cd4d5754-07e1-41d4-b9a5-ef4ea6a0a126",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Socat Process Activity",
    "query": "process.name:socat and not process.args:-V and event.action:executed",
    "references": [
      "https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name:socat and not process.args:\"-V\" and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.503Z",
    "created_by": "elastic",
    "description": "Strace runs in a privileged context and can be used to escape restrictive\nenvironments by instantiating a shell in order to elevate privileges or move\nlaterally.",
    "enabled": false,
    "false_positives": [
      "Strace is a dual-use tool that can be used for benign or malicious activity.\nSome normal use of this command may originate from developers or SREs engaged in\ndebugging or system call tracing."
    ],
    "from": "now-6m",
    "id": "dd5dd0de-6b8f-45b8-924a-8d314be39aed",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "d6450d4e-81c6-46a3-bd94-079886318ed5",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Strace Process Activity",
    "query": "process.name:strace and event.action:executed",
    "references": [
      "https://en.wikipedia.org/wiki/Strace"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: strace and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.504Z",
    "updated_at": "2020-06-03T06:15:24.100Z",
    "created_by": "elastic",
    "description": "A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "4cb0e87a-5306-4af9-92b2-64d17bbdae0b",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "931e25a5-0f5e-4ae0-ba0d-9e94eff7e3a4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Sudoers File Modification",
    "query": "event.module:file_integrity and event.action:updated and file.path:/etc/sudoers",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1169",
            "name": "Sudo",
            "reference": "https://attack.mitre.org/techniques/T1169/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.499Z",
    "updated_at": "2020-06-03T06:15:24.305Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of frequently targeted Microsoft Office\napplications (Word, PowerPoint, Excel). These child processes are often launched\nduring exploitation of Office applications or from documents with malicious\nmacros.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "872b9c71-a1d4-4870-b4d5-9fedc4f2bf56",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "a624863f-a70d-417f-a7d2-7a404638d47f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious MS Office Child Process",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(\"winword.exe\" or \"excel.exe\" or \"powerpnt.exe\" or \"eqnedt32.exe\" or \"fltldr.exe\" or \"mspub.exe\" or \"msaccess.exe\") and process.name:(\"arp.exe\" or \"dsquery.exe\" or \"dsget.exe\" or \"gpresult.exe\" or \"hostname.exe\" or \"ipconfig.exe\" or \"nbtstat.exe\" or \"net.exe\" or \"net1.exe\" or \"netsh.exe\" or \"netstat.exe\" or \"nltest.exe\" or \"ping.exe\" or \"qprocess.exe\" or \"quser.exe\" or \"qwinsta.exe\" or \"reg.exe\" or \"sc.exe\" or \"systeminfo.exe\" or \"tasklist.exe\" or \"tracert.exe\" or \"whoami.exe\" or \"bginfo.exe\" or \"cdb.exe\" or \"cmstp.exe\" or \"csi.exe\" or \"dnx.exe\" or \"fsi.exe\" or \"ieexec.exe\" or \"iexpress.exe\" or \"installutil.exe\" or \"Microsoft.Workflow.Compiler.exe\" or \"msbuild.exe\" or \"mshta.exe\" or \"msxsl.exe\" or \"odbcconf.exe\" or \"rcsi.exe\" or \"regsvr32.exe\" or \"xwizard.exe\" or \"atbroker.exe\" or \"forfiles.exe\" or \"schtasks.exe\" or \"regasm.exe\" or \"regsvcs.exe\" or \"cmd.exe\" or \"cscript.exe\" or \"powershell.exe\" or \"pwsh.exe\" or \"wmic.exe\" or \"wscript.exe\" or \"bitsadmin.exe\" or \"certutil.exe\" or \"ftp.exe\") ",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:23.816Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of Microsoft Outlook. These child\nprocesses are often associated with spear phishing activity.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "55ad8857-bb27-414f-b122-be55b8dc496f",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "32f4675e-6c49-4ace-80f9-97c9259dca2e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious MS Outlook Child Process",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:outlook.exe and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:\"outlook.exe\" and process.name:(\"arp.exe\" or \"dsquery.exe\" or \"dsget.exe\" or \"gpresult.exe\" or \"hostname.exe\" or \"ipconfig.exe\" or \"nbtstat.exe\" or \"net.exe\" or \"net1.exe\" or \"netsh.exe\" or \"netstat.exe\" or \"nltest.exe\" or \"ping.exe\" or \"qprocess.exe\" or \"quser.exe\" or \"qwinsta.exe\" or \"reg.exe\" or \"sc.exe\" or \"systeminfo.exe\" or \"tasklist.exe\" or \"tracert.exe\" or \"whoami.exe\" or \"bginfo.exe\" or \"cdb.exe\" or \"cmstp.exe\" or \"csi.exe\" or \"dnx.exe\" or \"fsi.exe\" or \"ieexec.exe\" or \"iexpress.exe\" or \"installutil.exe\" or \"Microsoft.Workflow.Compiler.exe\" or \"msbuild.exe\" or \"mshta.exe\" or \"msxsl.exe\" or \"odbcconf.exe\" or \"rcsi.exe\" or \"regsvr32.exe\" or \"xwizard.exe\" or \"atbroker.exe\" or \"forfiles.exe\" or \"schtasks.exe\" or \"regasm.exe\" or \"regsvcs.exe\" or \"cmd.exe\" or \"cscript.exe\" or \"powershell.exe\" or \"pwsh.exe\" or \"wmic.exe\" or \"wscript.exe\" or \"bitsadmin.exe\" or \"certutil.exe\" or \"ftp.exe\") ",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.515Z",
    "updated_at": "2020-06-03T06:15:24.617Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of PDF reader applications. These child\nprocesses are often launched via exploitation of PDF applications or social\nengineering.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "76e3d5db-4fd8-401d-b22d-6cc3b809eb16",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "53a26770-9cbd-40c5-8b57-61d01a325e14",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious PDF Reader Child Process",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(AcroRd32.exe or Acrobat.exe or FoxitPhantomPDF.exe or FoxitReader.exe) and process.name:(arp.exe or dsquery.exe or dsget.exe or gpresult.exe or hostname.exe or ipconfig.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or ping.exe or qprocess.exe or quser.exe or qwinsta.exe or reg.exe or sc.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or installutil.exe or Microsoft.Workflow.Compiler.exe or msbuild.exe or mshta.exe or msxsl.exe or odbcconf.exe or rcsi.exe or regsvr32.exe or xwizard.exe or atbroker.exe or forfiles.exe or schtasks.exe or regasm.exe or regsvcs.exe or cmd.exe or cscript.exe or powershell.exe or pwsh.exe or wmic.exe or wscript.exe or bitsadmin.exe or certutil.exe or ftp.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1204",
            "name": "User Execution",
            "reference": "https://attack.mitre.org/techniques/T1204/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.509Z",
    "updated_at": "2020-06-03T06:15:24.410Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a PowerShell script with unusual data\ncharacteristics, such as obfuscation, that may be a characteristic of malicious\nPowerShell script text blocks.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Certain kinds of security testing may trigger this signal. PowerShell scripts\nthat use high levels of obfuscation or have unusual script block payloads may\ntrigger this signal."
    ],
    "from": "now-45m",
    "id": "2c3bfe77-4b7d-4265-98a4-3bf2d93bc378",
    "immutable": true,
    "interval": "15m",
    "rule_id": "1781d055-5c66-4adf-9d60-fc0fa58337b6",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_script",
    "risk_score": 21,
    "name": "Suspicious Powershell Script",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.510Z",
    "updated_at": "2020-06-03T06:15:24.492Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious parent-child process relationship with cmd.exe\ndescending from `svchost.exe`.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "af4ca103-b66e-4be9-91e7-8846bb2a9ce8",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fd7a6052-58fa-4397-93c3-4795249ccfa2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Svchost spawning Cmd",
    "query": "process.parent.name:svchost.exe and process.name:cmd.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.parent.name:svchost.exe and process.name:cmd.exe",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:24.215Z",
    "created_by": "elastic",
    "description": "Windows services typically run as SYSTEM and can be used as a privilege\nescalation opportunity. Malware or penetration testers may run a shell as a\nservice to gain SYSTEM permissions.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "be033772-43e2-427a-818c-36d0495cf9ad",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0022d47d-39c7-4f69-a232-4fe9dc7a3acd",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "System Shells via Services",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:services.exe and process.name:(cmd.exe or powershell.exe)",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1050",
            "name": "New Service",
            "reference": "https://attack.mitre.org/techniques/T1050/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:\"services.exe\" and process.name:(\"cmd.exe\" or \"powershell.exe\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.497Z",
    "created_by": "elastic",
    "description": "TCP Port 8000 is commonly used for development environments of web server\nsoftware. It generally should not be exposed directly to the Internet. If you\nare running software like this on the Internet, you should consider placing it\nbehind a reverse proxy.",
    "enabled": false,
    "false_positives": [
      "Because this port is in the ephemeral range, this rule may false under certain\nconditions, such as when a NATed web server replies to a client which has used a\nport in the range by coincidence. In this case, such servers can be excluded.\nSome applications may use this port but this is very uncommon and usually\nappears in local traffic using private IPs, which this rule does not match. Some\ncloud environments, particularly development environments, may use this port\nwhen VPNs or direct connects are not in use and cloud instances are accessed\nacross the Internet."
    ],
    "from": "now-6m",
    "id": "4f835a28-2360-4abe-b0c2-97ed821a83c0",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "08d5d7e2-740f-44d8-aeda-e41f4263efaf",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "TCP Port 8000 Activity to the Internet",
    "query": "network.transport:tcp and destination.port:8000 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: 8000 and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.506Z",
    "updated_at": "2020-06-03T06:15:24.500Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of Telnet traffic. Telnet is\ncommonly used by system administrators to remotely control older or embedded\nsystems using the command line shell. It should almost never be directly exposed\nto the Internet, as it is frequently targeted and exploited by threat actors as\nan initial access or back-door vector. As a plain-text protocol, it may also\nexpose usernames and passwords to anyone capable of observing the traffic.",
    "enabled": false,
    "false_positives": [
      "IoT (Internet of Things) devices and networks may use telnet and can be excluded\nif desired. Some business workflows may use Telnet for administration of older\ndevices. These often have a predictable behavior. Telnet activity involving an\nunusual source or destination may be more suspicious. Telnet activity involving\na production server that has no known associated Telnet workflow or business\nrequirement is often suspicious."
    ],
    "from": "now-6m",
    "id": "dc68db78-c89a-4dc1-a0a2-61941dd7d5a3",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "34fde489-94b0-4500-a76f-b8a157cf9269",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Telnet Port Activity",
    "query": "network.transport:tcp and destination.port:23",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        }
      ]
    },
    "last_update": "7.6.1",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.208Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of Tor traffic to the Internet.\nTor is a network protocol that sends traffic through a series of encrypted\ntunnels used to conceal a user's location and usage. Tor may be used by threat\nactors as an alternate communication pathway to conceal the actor's identity and\navoid detection.",
    "enabled": false,
    "false_positives": [
      "Tor client activity is uncommon in managed enterprise networks but may be common\nin unmanaged or public networks where few security policies apply. Because these\nports are in the ephemeral range, this rule may false under certain conditions\nsuch as when a NATed web server replies to a client which has used one of these\nports by coincidence. In this case, such servers can be excluded if desired."
    ],
    "from": "now-6m",
    "id": "9a06b751-d3f6-4b3c-ab70-f2ddec882095",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "7d2c38d7-ede7-4bdf-b140-445906e6c540",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Tor Activity to the Internet",
    "query": "network.transport:tcp and destination.port:(9001 or 9030) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1188",
            "name": "Multi-hop Proxy",
            "reference": "https://attack.mitre.org/techniques/T1188/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and destination.port: (9001 or 9030) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.512Z",
    "updated_at": "2020-06-03T06:15:24.601Z",
    "created_by": "elastic",
    "description": "Identifies possibly suspicious activity using a trusted Windows developer\nutility program.",
    "enabled": false,
    "false_positives": [
      "These programs may be used by Windows developers but use by non-engineers is\nunusual."
    ],
    "from": "now-6m",
    "id": "5f0606dd-764e-407a-a9e2-0e6858bf0e5d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae1",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Trusted Developer Application Usage",
    "query": "event.code:1 and process.name:(MSBuild.exe or msxsl.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.code:1 and (process.name:MSBuild.exe or process.name:msxsl.exe)",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.396Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a rare and unusual DNS query that indicates\nnetwork activity with unusual DNS domains. This can be due to initial access,\npersistence, command-and-control, or exfiltration activity. For example, when a\nuser clicks on a link in a phishing email or opens a malicious document, a\nrequest may be sent to download and run a payload from an uncommon domain. When\nmalware is already running, it may send requests to an uncommon DNS domain the\nmalware uses for command-and-control communication.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or\nquarterly workflow could trigger this signal. Network activity that occurs\nrarely, in small quantities, can trigger this signal. Possible examples are\nbrowsing technical support or vendor networks sparsely. A user who visits a new\nor unique web destination may trigger this signal."
    ],
    "from": "now-45m",
    "id": "fa2e6db5-5d6b-4510-b53c-c17a4547cd9a",
    "immutable": true,
    "interval": "15m",
    "rule_id": "746edc4c-c54c-49c6-97a1-651223819448",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "packetbeat_rare_dns_question",
    "risk_score": 21,
    "name": "Unusual DNS Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Packetbeat"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.050Z",
    "created_by": "elastic",
    "description": "Identifies Linux processes that do not usually use the network but have\nunexpected network activity, which can indicate command-and-control, lateral\nmovement, persistence, or data exfiltration activity. A process with unusual\nnetwork activity can denote process exploitation or injection, where the process\nis used to run persistence mechanisms that allow a malicious actor remote access\nor control of the host, data exfiltration, and execution of unauthorized network\napplications.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this\nsignal."
    ],
    "from": "now-45m",
    "id": "63a81b9a-01f9-4393-a328-44804a35477e",
    "immutable": true,
    "interval": "15m",
    "rule_id": "52afbdc5-db15-485e-bc24-f5707f820c4b",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "linux_anomalous_network_activity_ecs",
    "risk_score": 21,
    "name": "Unusual Linux Network Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate the presence of network activity from a Linux\nprocess for which network activity is rare and unusual.  Here are some possible\navenues of investigation:\n\n* Consider the IP addresses and ports. Are these used by normal but infrequent\nnetwork workflows? Are they expected or unexpected?\n* If the destination IP address is remote or external, does it associate with\nan expected domain, organization or geography?\n+\nNOTE: Avoid interacting directly with suspected malicious IP addresses. \n\n* Consider the user as identified by the username field. Is this network\nactivity part of an expected workflow for the user who ran the program?\n* Examine the history of execution. If this process manifested only\nvery recently, it might be part of a new software package. If it has a\nconsistent schedule - for example if it runs monthly or quarterly - it might be\npart of a monthly or quarterly business or maintenance process.\n* Examine the process arguments, title and working directory. These may provide\nindications as to the source of the program or the nature of the tasks it is\nperforming.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.048Z",
    "created_by": "elastic",
    "description": "Identifies unusual destination port activity that can indicate command-and-\ncontrol, persistence mechanism, or data exfiltration activity. Rarely used\ndestination port activity is generally unusual in Linux fleets, and can indicate\nunauthorized access or threat actor activity.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this\nsignal."
    ],
    "from": "now-45m",
    "id": "c46ac776-78ff-4405-ad80-5c4ca61c5988",
    "immutable": true,
    "interval": "15m",
    "rule_id": "3c7e32e6-6104-46d9-a06e-da0f8b5795a0",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "linux_anomalous_network_port_activity_ecs",
    "risk_score": 21,
    "name": "Unusual Linux Network Port Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.600Z",
    "created_by": "elastic",
    "description": "Identifies unusual listening ports on Linux instances that can indicate\nexecution of unauthorized services, backdoors, or persistence mechanisms.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this\nsignal."
    ],
    "from": "now-45m",
    "id": "2b2ae5cf-6696-4ef8-92bc-af04572abc3a",
    "immutable": true,
    "interval": "15m",
    "rule_id": "52afbdc5-db15-596e-bc35-f5707f820c4b",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "linux_anomalous_network_service",
    "risk_score": 21,
    "name": "Unusual Linux Network Service",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.496Z",
    "created_by": "elastic",
    "description": "A machine learning job detected activity for a username that is not normally\nactive, which can indicate unauthorized changes, activity by unauthorized users,\nlateral movement, or compromised credentials. In many organizations, new\nusernames are not often created apart from specific types of system activities,\nsuch as creating new accounts for new employees. These user accounts quickly\nbecome active and routine. Events from rarely used usernames can point to\nsuspicious activity. Additionally, automated Linux fleets tend to see activity\nfrom rarely used usernames only when personnel log in to make authorized or\nunauthorized changes, or threat actors have acquired credentials and log in for\nmalicious purposes. Unusual usernames can also indicate pivoting, where\ncompromised credentials are used to try and move laterally from one host to\nanother.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Uncommon user activity can be due to an engineer logging in to a server instance\nin order to perform manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "c71d1ad3-565f-4f7c-9236-1a8942b6eb15",
    "immutable": true,
    "interval": "15m",
    "rule_id": "b347b919-665f-4aac-b9e8-68369bf2340c",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "linux_anomalous_user_name_ecs",
    "risk_score": 21,
    "name": "Unusual Linux Username",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate activity for a Linux user name that is rare and\nunusual. Here are some possible avenues of investigation:\n\n* Consider the user as identified by the username field. Is this program part\nof an expected workflow for the user who ran this program on this host? Could\nthis be related to troubleshooting or debugging activity by a developer or site\nreliability engineer?\n* Examine the history of user activity. If this user manifested only very\nrecently, it might be a service account for a new software package. If it has a\nconsistent schedule - for example if it runs monthly or quarterly - it might be\npart of a monthly or quarterly business process.\n* Examine the process arguments, title and working directory. These may provide\nindications as to the source of the program or the nature of the tasks that the\nuser is performing.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.040Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual web URL request from a Linux host,\nwhich can indicate malware delivery and execution. Wget and cURL are commonly\nused by Linux programs to download code and data. Most of the time, their usage\nis entirely normal. Generally, because they use a list of URLs, they repeatedly\ndownload from the same locations. However, Wget and cURL are sometimes used to\ndeliver Linux exploit payloads, and threat actors use these tools to download\nadditional software and code. For these reasons, unusual URLs can indicate\nunauthorized downloads or threat activity.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A new and unusual program or artifact download in the course of software\nupgrades, debugging, or troubleshooting could trigger this signal."
    ],
    "from": "now-45m",
    "id": "56b051f2-dc72-49b3-8436-df2770c866f7",
    "immutable": true,
    "interval": "15m",
    "rule_id": "52afbdc5-db15-485e-bc35-f5707f820c4c",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "linux_anomalous_network_url_activity_ecs",
    "risk_score": 21,
    "name": "Unusual Linux Web Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.392Z",
    "created_by": "elastic",
    "description": "Identifies an unusually high number of authentication attempts.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Security audits may trigger this signal. Conditions that generate bursts of\nfailed logins, such as misconfigured applications or account lockouts could\ntrigger this signal."
    ],
    "from": "now-45m",
    "id": "4e6abc0f-b257-4326-95c0-142518e375df",
    "immutable": true,
    "interval": "15m",
    "rule_id": "4330272b-9724-4bc6-a3ca-f1532b81e5c2",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "suspicious_login_activity_ecs",
    "risk_score": 21,
    "name": "Unusual Login Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:24.097Z",
    "created_by": "elastic",
    "description": "Identifies unusual instances of `rundll32.exe` making outbound network\nconnections. This may indicate adversarial activity and may identify malicious\nDLLs.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "8e8c3670-68f7-49bd-90f1-b2f6866fb60d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "52aaab7b-b51c-441a-89ce-4387b3aea886",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Unusual Network Connection via RunDLL32",
    "query": "process.name:rundll32.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or 127.0.0.0/8)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1085",
            "name": "Rundll32",
            "reference": "https://attack.mitre.org/techniques/T1085/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name:rundll32.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
          "doc_text": "Updated query."
        },
        {
          "version": 3,
          "updated": "7.8.0",
          "pre_query": "process.name:rundll32.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.8.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.313Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual network destination domain name. This\ncan be due to initial access, persistence, command-and-control, or exfiltration\nactivity. For example, when a user clicks on a link in a phishing email or opens\na malicious document, a request may be sent to download and run a payload from\nan uncommon web server name. When malware is already running, it may send\nrequests to an uncommon DNS domain the malware uses for command-and-control\ncommunication.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Web activity that occurs rarely in small quantities can trigger this signal.\nPossible examples are browsing technical support or vendor URLs that are used\nvery sparsely. A user who visits a new and unique web destination may trigger\nthis signal when the activity is sparse. Web applications that generate URLs\nunique to a transaction may trigger this when they are used sparsely. Web\ndomains can be excluded in these cases."
    ],
    "from": "now-45m",
    "id": "89b18a4e-72e0-48f8-b351-3bfe76c4d4df",
    "immutable": true,
    "interval": "15m",
    "rule_id": "17e68559-b274-4948-ad0b-f8415bb31126",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "packetbeat_rare_server_domain",
    "risk_score": 21,
    "name": "Unusual Network Destination Domain Name",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Packetbeat"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:24.110Z",
    "created_by": "elastic",
    "description": "Identifies Windows programs run from unexpected parent processes. This could\nindicate masquerading or other strange activity on a system.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "4be0b082-1a3a-4608-b31f-845c80b3828e",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "35df0dd8-092d-4a83-88c1-5151a804f31b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Unusual Parent-Child Relationship",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.executable:* and (process.name:smss.exe and not process.parent.name:(System or smss.exe) or process.name:csrss.exe and not process.parent.name:(smss.exe or svchost.exe) or process.name:wininit.exe and not process.parent.name:smss.exe or process.name:winlogon.exe and not process.parent.name:smss.exe or process.name:lsass.exe and not process.parent.name:wininit.exe or process.name:LogonUI.exe and not process.parent.name:(wininit.exe or winlogon.exe) or process.name:services.exe and not process.parent.name:wininit.exe or process.name:svchost.exe and not process.parent.name:(MsMpEng.exe or services.exe) or process.name:spoolsv.exe and not process.parent.name:services.exe or process.name:taskhost.exe and not process.parent.name:(services.exe or svchost.exe) or process.name:taskhostw.exe and not process.parent.name:(services.exe or svchost.exe) or process.name:userinit.exe and not process.parent.name:(dwm.exe or winlogon.exe))",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1093",
            "name": "Process Hollowing",
            "reference": "https://attack.mitre.org/techniques/T1093/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.executable:* and ( (process.name:\"smss.exe\" and not process.parent.name:(\"System\" or \"smss.exe\")) or (process.name:\"csrss.exe\" and not process.parent.name:(\"smss.exe\" or \"svchost.exe\")) or (process.name:\"wininit.exe\" and not process.parent.name:\"smss.exe\") or (process.name:\"winlogon.exe\" and not process.parent.name:\"smss.exe\") or (process.name:\"lsass.exe\" and not process.parent.name:\"wininit.exe\") or (process.name:\"LogonUI.exe\" and not process.parent.name:(\"winlogon.exe\" or \"wininit.exe\")) or (process.name:\"services.exe\" and not process.parent.name:\"wininit.exe\") or (process.name:\"svchost.exe\" and not process.parent.name:(\"services.exe\" or \"MsMpEng.exe\")) or (process.name:\"spoolsv.exe\" and not process.parent.name:\"services.exe\") or (process.name:\"taskhost.exe\" and not process.parent.name:(\"services.exe\" or \"svchost.exe\")) or (process.name:\"taskhostw.exe\" and not process.parent.name:(\"services.exe\" or \"svchost.exe\")) or (process.name:\"userinit.exe\" and not process.parent.name:(\"dwm.exe\" or \"winlogon.exe\")) )",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.503Z",
    "updated_at": "2020-06-03T06:15:24.203Z",
    "created_by": "elastic",
    "description": "Identifies processes running in a temporary folder. This is sometimes done by\nadversaries to hide malware.",
    "enabled": false,
    "false_positives": [
      "Build systems, like Jenkins, may start processes in the `/tmp` directory. These\ncan be exempted by name or by username."
    ],
    "from": "now-6m",
    "id": "7f29cfba-fe68-4e45-966a-1faa15a8196d",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "df959768-b0c9-4d45-988c-5606a2be8e5a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Unusual Process Execution - Temp",
    "query": "process.working_directory:/tmp and event.action:executed",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.working_directory: /tmp and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.607Z",
    "created_by": "elastic",
    "description": "Identifies rare processes that do not usually run on individual hosts, which can\nindicate execution of unauthorized services, malware, or persistence mechanisms.\nProcesses are considered rare when they only run occasionally as compared with\nother processes running on the host.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or\nquarterly workflow could trigger this signal."
    ],
    "from": "now-45m",
    "id": "69fb011d-fe62-4c47-8301-d771800c9bb7",
    "immutable": true,
    "interval": "15m",
    "rule_id": "46f804f5-b289-43d6-a881-9387cf594f75",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "rare_process_by_host_linux_ecs",
    "risk_score": 21,
    "name": "Unusual Process For a Linux Host",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux",
      "ML"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate the presence of a Linux process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:\n\n* Consider the user as identified by the username field. Is this program part\nof an expected workflow for the user who ran this program on this host?\n* Examine the history of execution. If this process manifested only very\nrecently, it might be part of a new software package. If it has a consistent\nschedule - for example if it runs monthly or quarterly - it might be part of a\nmonthly or quarterly business process.\n* Examine the process arguments, title and working directory. These may\nprovide indications as to the source of the program or the nature of the tasks\nit is performing.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.513Z",
    "created_by": "elastic",
    "description": "Identifies rare processes that do not usually run on individual hosts, which can\nindicate execution of unauthorized services, malware, or persistence mechanisms.\nProcesses are considered rare when they only run occasionally as compared with\nother processes running on the host.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or\nquarterly workflow could trigger this signal."
    ],
    "from": "now-45m",
    "id": "4b0c631d-1220-4be6-9992-7d1c4464ed1a",
    "immutable": true,
    "interval": "15m",
    "rule_id": "6d448b96-c922-4adb-b51c-b767f1ea5b76",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "rare_process_by_host_windows_ecs",
    "risk_score": 21,
    "name": "Unusual Process For a Windows Host",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate the presence of a Windows process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:\n\n* Consider the user as identified by the username field. Is this program part\nof an expected workflow for the user who ran this program on this host?\n* Examine the history of execution. If this process manifested only very\nrecently, it might be part of a new software package. If it has a consistent\nschedule - for example if it runs monthly or quarterly - it might be part of a\nmonthly or quarterly business process.\n* Examine the process metadata like the values of the Company, Description and\nProduct fields which may indicate whether the program is associated with an\nexpected software vendor or package.\n* Examine arguments and working directory. These may provide indications as to\nthe source of the program or the nature of the tasks it is performing.\n* Consider the same for the parent process. If the parent process is a\nlegitimate system utility or service, this could be related to software updates\nor system management. If the parent process is something user-facing like an\nOffice application, this process could be more suspicious.\n* If you have file hash values in the event data, and you suspect malware, you\ncan optionally run a search for the file hash to see if the file is identified\nas malware by anti-malware tools.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:23.898Z",
    "created_by": "elastic",
    "description": "Identifies network activity from unexpected system applications. This may\nindicate adversarial activity as these applications are often leveraged by\nadversaries to execute code and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "95837671-f48f-4bbf-819f-9dccaf633216",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "610949a1-312f-4e04-bb55-3a79b8c95267",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Unusual Process Network Connection",
    "query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:(Microsoft.Workflow.Compiler.exe or bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or odbcconf.exe or rcsi.exe or xwizard.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:(bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or Microsoft.Workflow.Compiler.exe or odbcconf.exe or rcsi.exe or xwizard.exe)",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.699Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a rare and unusual URL that indicates unusual\nweb browsing activity. This can be due to initial access, persistence, command-\nand-control, or exfiltration activity. For example, in a strategic web\ncompromise or watering hole attack, when a trusted website is compromised to\ntarget a particular sector or organization, targeted users may receive emails\nwith uncommon URLs for trusted websites. These URLs can be used to download and\nrun a payload. When malware is already running, it may send requests to uncommon\nURLs on trusted websites the malware uses for command-and-control communication.\nWhen rare URLs are observed being requested for a local web server by a remote\nsource, these can be due to web scanning, enumeration or attack traffic, or they\ncan be due to bots and web scrapers which are part of common Internet background\ntraffic.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Web activity that occurs rarely in small quantities can trigger this signal.\nPossible examples are browsing technical support or vendor URLs that are used\nvery sparsely. A user who visits a new and unique web destination may trigger\nthis signal when the activity is sparse. Web applications that generate URLs\nunique to a transaction may trigger this when they are used sparsely. Web\ndomains can be excluded in cases such as these."
    ],
    "from": "now-45m",
    "id": "ddafdd9d-b331-4c86-afb2-9978c034da1d",
    "immutable": true,
    "interval": "15m",
    "rule_id": "91f02f01-969f-4167-8f55-07827ac3acc9",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "packetbeat_rare_urls",
    "risk_score": 21,
    "name": "Unusual Web Request",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Packetbeat"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.308Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a rare and unusual user agent indicating web\nbrowsing activity by an unusual process other than a web browser. This can be\ndue to persistence, command-and-control, or exfiltration activity. Uncommon user\nagents coming from remote sources to local destinations are often the result of\nscanners, bots, and web scrapers, which are part of common Internet background\ntraffic. Much of this is noise, but more targeted attacks on websites using\ntools like Burp or SQLmap can sometimes be discovered by spotting uncommon user\nagents. Uncommon user agents in traffic from local sources to remote\ndestinations can be any number of things, including harmless programs like\nweather monitoring or stock-trading programs. However, uncommon user agents from\nlocal sources can also be due to malware or scanning activity.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Web activity that is uncommon, like security scans, may trigger a signal and\nmay need to be excluded. A new or rarely used program that calls web services\nmay trigger a signal."
    ],
    "from": "now-45m",
    "id": "5369ad3b-99a6-47a9-889e-47a724a3fdd5",
    "immutable": true,
    "interval": "15m",
    "rule_id": "91f02f01-969f-4167-8d77-07827ac4cee0",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "packetbeat_rare_user_agent",
    "risk_score": 21,
    "name": "Unusual Web User Agent",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Packetbeat"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.127Z",
    "created_by": "elastic",
    "description": "Identifies Windows processes that do not usually use the network but have\nunexpected network activity, which can indicate command-and-control, lateral\nmovement, persistence, or data exfiltration activity. A process with unusual\nnetwork activity can denote process exploitation or injection, where the process\nis used to run persistence mechanisms that allow a malicious actor remote access\nor control of the host, data exfiltration, and execution of unauthorized network\napplications.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this\nsignal."
    ],
    "from": "now-45m",
    "id": "b62f42a9-775a-4de4-a6e3-0432d306250c",
    "immutable": true,
    "interval": "15m",
    "rule_id": "ba342eb2-583c-439f-b04d-1fdd7c1417cc",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_network_activity_ecs",
    "risk_score": 21,
    "name": "Unusual Windows Network Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate the presence of network activity from a Windows\nprocess for which network activity is very unusual.  Here are some possible\navenues of investigation:\n\n* Consider the IP addresses, protocol and ports. Are these used by normal but\ninfrequent network workflows? Are they expected or unexpected?\n* If the destination IP address is remote or external, does it associate with\nan expected domain, organization or geography? Note: avoid interacting directly\nwith suspected malicious IP addresses.\n* Consider the user as identified by the username field. Is this network\nactivity part of an expected workflow for the user who ran the program?\n* Examine the history of execution. If this process manifested only very\nrecently, it might be part of a new software package. If it has a consistent\nschedule - for example if it runs monthly or quarterly - it might be part of a\nmonthly or quarterly business process.\n* Examine the process arguments, title and working directory. These may provide\nindications as to the source of the program or the nature of the tasks it is\nperforming.\n* Consider the same for the parent process. If the parent process is a\nlegitimate system utility or service, this could be related to software updates\nor system management. If the parent process is something user-facing like an\nOffice application, this process could be more suspicious.\n* If you have file hash values in the event data, and you suspect malware, you\ncan optionally run a search for the file hash to see if the file is identified\nas malware by anti-malware tools.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.306Z",
    "created_by": "elastic",
    "description": "Identifies processes started from atypical folders in the file system, which\nmay indicate malware execution or persistence mechanisms. In corporate Windows\nenvironments, software installation is centrally managed and it is unusual for\nprograms to be executed from user or temporary directories. Processes executed\nfrom these locations can denote that a user downloaded software directly from\nthe Internet or a malicious script or macro executed malware.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A new and unusual program or artifact download in the course of software\nupgrades, debugging, or troubleshooting could trigger this signal. Users\ndownloading and running programs from unusual locations, such as temporary\ndirectories, browser caches, or profile paths could trigger this signal."
    ],
    "from": "now-45m",
    "id": "12af5edf-7ea4-4a34-9f80-9e1daf8a3736",
    "immutable": true,
    "interval": "15m",
    "rule_id": "445a342e-03fb-42d0-8656-0367eb2dead5",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_path_activity_ecs",
    "risk_score": 21,
    "name": "Unusual Windows Path Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.514Z",
    "updated_at": "2020-06-03T06:15:24.292Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual remote desktop protocol (RDP)\nusername, which can indicate account takeover or credentialed persistence using\ncompromised accounts. RDP attacks, such as BlueKeep, also tend to use unusual\nusernames.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Uncommon username activity can be due to an engineer logging in to a server\ninstance in order to perform manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "71add87f-b3bf-4cb4-a05c-de7ae9d28249",
    "immutable": true,
    "interval": "15m",
    "rule_id": "1781d055-5c66-4adf-9e93-fc0fa69550c9",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_rare_user_type10_remote_login",
    "risk_score": 21,
    "name": "Unusual Windows Remote User",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate activity for a rare and unusual Windows RDP\n(remote desktop) user. Here are some possible avenues of investigation: \n\n* Consider the user as identified by the username field. Is the user part of a\ngroup who normally logs in to Windows hosts using RDP (remote desktop\nprotocol)? Is this logon activity part of an expected workflow for the user? \n* Consider the source of the login. If the source is remote, could this be\nrelated to occasional troubleshooting or support activity by a vendor or an\nemployee working remotely?",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.509Z",
    "updated_at": "2020-06-03T06:15:24.304Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual Windows service, This can indicate\nexecution of unauthorized services, malware, or persistence mechanisms. In\ncorporate Windows environments, hosts do not generally run many rare or unique\nservices. This job helps detect malware and persistence mechanisms that have\nbeen installed and run as a service.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or\nquarterly workflow could trigger this signal."
    ],
    "from": "now-45m",
    "id": "ec932a4d-7fd9-40a9-92fd-d16142a709fc",
    "immutable": true,
    "interval": "15m",
    "rule_id": "1781d055-5c66-4adf-9c71-fc0fa58338c7",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_service",
    "risk_score": 21,
    "name": "Unusual Windows Service",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.514Z",
    "updated_at": "2020-06-03T06:15:24.115Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual user context switch, using the\n`runas` command or similar techniques, which can indicate account takeover or\nprivilege escalation using compromised accounts. Privilege elevation using\ntools like `runas` are more commonly used by domain and network administrators\nthan by regular Windows users.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Uncommon user privilege elevation activity can be due to an administrator, help\ndesk technician, or a user performing manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "4ed61161-199c-41da-b7ca-6890a92c62bf",
    "immutable": true,
    "interval": "15m",
    "rule_id": "1781d055-5c66-4adf-9d82-fc0fa58449c8",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_rare_user_runas_event",
    "risk_score": 21,
    "name": "Unusual Windows User Privilege Elevation Activity",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.509Z",
    "updated_at": "2020-06-03T06:15:24.193Z",
    "created_by": "elastic",
    "description": "A machine learning job detected activity for a username that is not normally\nactive, which can indicate unauthorized changes, activity by unauthorized users,\nlateral movement, or compromised credentials. In many organizations, new\nusernames are not often created apart from specific types of system activities,\nsuch as creating new accounts for new employees. These user accounts quickly\nbecome active and routine. Events from rarely used usernames can point to\nsuspicious activity. Unusual usernames can also indicate pivoting, where\ncompromised credentials are used to try and move laterally from one host to\nanother.",
    "enabled": false,
    "anomaly_threshold": 50,
    "false_positives": [
      "Uncommon user activity can be due to an administrator or help desk technician\nlogging in to a workstation or server to perform manual troubleshooting or\nreconfiguration."
    ],
    "from": "now-45m",
    "id": "2e5841bc-f5bb-4f70-b764-e429b664099f",
    "immutable": true,
    "interval": "15m",
    "rule_id": "1781d055-5c66-4adf-9c59-fc0fa58336a5",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "machine_learning_job_id": "windows_anomalous_user_name_ecs",
    "risk_score": 21,
    "name": "Unusual Windows Username",
    "references": [
      "https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "ML",
      "Windows"
    ],
    "to": "now",
    "type": "machine_learning",
    "threat": [],
    "throttle": "no_actions",
    "note": "Signals from this rule indicate activity for a Windows user name that is rare\nand unusual. Here are some possible avenues of investigation:\n\n* Consider the user as identified by the username field. Is this program part\nof an expected workflow for the user who ran this program on this host? Could\nthis be related to occasional troubleshooting or support activity?\n* Examine the history of user activity. If this user manifested only very\nrecently, it might be a service account for a new software package. If it has a\nconsistent schedule - for example if it runs monthly or quarterly - it might be\npart of a monthly or quarterly business process.\n* Examine the process arguments, title and working directory. These may\nprovide indications as to the source of the program or the nature of the tasks\nthat the user is performing.\n* Consider the same for the parent process. If the parent process is a\nlegitimate system utility or service, this could be related to software updates\nor system management. If the parent process is something user-facing like an\nOffice application, this process could be more suspicious.",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:24.047Z",
    "created_by": "elastic",
    "description": "Identifies attempts to create new local users. This is sometimes done by\nattackers to increase access to a system or domain.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "cb633535-5d95-4d06-b125-b471886a7270",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "1aa9181a-492b-4c01-8b16-fa0735786b2b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "User Account Creation",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:(net.exe or net1.exe) and not process.parent.name:net.exe and process.args:(user and (/ad or /add))",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1136",
            "name": "Create Account",
            "reference": "https://attack.mitre.org/techniques/T1136/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:(\"net.exe\" or \"net1.exe\") and not process.parent.name:\"net.exe\" and process.args:(\"user\" and (\"/add\" or \"/ad\")) ",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.301Z",
    "created_by": "elastic",
    "description": "The `whoami` application was executed on a Linux host. This is often used by\ntools and persistence mechanisms to test for privileged access.",
    "enabled": false,
    "false_positives": [
      "Security testing tools and frameworks may run this command. Some normal use of\nthis command may originate from automation tools and frameworks."
    ],
    "from": "now-6m",
    "id": "db32e130-5eee-4ef0-8ab5-cb9bb4491ab6",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "120559c6-5e24-49f4-9e30-8ffe697df6b9",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "User Discovery via Whoami",
    "query": "process.name:whoami and event.action:executed",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery",
            "reference": "https://attack.mitre.org/techniques/T1033/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name: whoami and event.action:executed",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.322Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of VNC traffic from the\nInternet. VNC is commonly used by system administrators to remotely control a\nsystem for maintenance or to use shared resources. It should almost never be\ndirectly exposed to the Internet, as it is frequently targeted and exploited by\nthreat actors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "VNC connections may be received directly to Linux cloud server instances but\nsuch connections are usually made only by engineers. VNC is less common than SSH\nor RDP but may be required by some workflows such as remote access and support\nfor specialized software products or servers. Such workflows are usually known\nand not unexpected. Usage that is unfamiliar to server or network owners can be\nunexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "9aea1d3d-dd06-4f36-899a-483749086a86",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "5700cb81-df44-46aa-a5d7-337798f53eb8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "VNC (Virtual Network Computing) from the Internet",
    "query": "network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1219",
            "name": "Remote Access Tools",
            "reference": "https://attack.mitre.org/techniques/T1219/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and (destination.port >= 5800 and destination.port <= 5810) and (\n network.direction: inbound or (\n not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.618Z",
    "created_by": "elastic",
    "description": "Detects network events that may indicate the use of VNC traffic to the Internet.\nVNC is commonly used by system administrators to remotely control a system for\nmaintenance or to use shared resources. It should almost never be directly\nexposed to the Internet, as it is frequently targeted and exploited by threat\nactors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "VNC connections may be made directly to Linux cloud server instances but such\nconnections are usually made only by engineers. VNC is less common than SSH or\nRDP but may be required by some work flows such as remote access and support for\nspecialized software products or servers. Such workflows are usually known and\nnot unexpected. Usage that is unfamiliar to server or network owners can be\nunexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "b472a22c-9a16-4ffb-a7f3-04f6800008f9",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "3ad49c61-7adc-42c1-b788-732eda2f5abf",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "VNC (Virtual Network Computing) to the Internet",
    "query": "network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1219",
            "name": "Remote Access Tools",
            "reference": "https://attack.mitre.org/techniques/T1219/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 3,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.6.1",
          "doc_text": "Removed auditbeat-\\*, packetbeat-*, and winlogbeat-* from the rule indices."
        },
        {
          "version": 3,
          "updated": "7.7.0",
          "pre_query": "network.transport: tcp and (destination.port >= 5800 and destination.port <= 5810) and (\n network.direction: outbound or (\n source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n )\n)\n",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.505Z",
    "updated_at": "2020-06-03T06:15:24.319Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to get detailed information about the operating system and hardware. This rule identifies common locations used to discover virtual machine hardware by a non-root user. This technique has been used by the Pupy RAT and other malware.",
    "enabled": false,
    "false_positives": [
      "Certain tools or automated software may enumerate hardware information. These tools can be exempted via user name or process arguments to eliminate potential noise."
    ],
    "from": "now-6m",
    "id": "a9b788d9-426f-445d-b6fa-d6a496fe119e",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "5b03c9fb-9945-4d2f-9568-fd690fee3fba",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Virtual Machine Fingerprinting",
    "query": "event.action:executed and process.args:(\"/sys/class/dmi/id/bios_version\" or \"/sys/class/dmi/id/product_name\" or \"/sys/class/dmi/id/chassis_vendor\" or \"/proc/scsi/scsi\" or \"/proc/ide/hd0/model\") and not user.name:root",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1082",
            "name": "System Information Discovery",
            "reference": "https://attack.mitre.org/techniques/T1082/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.8.0",
    "added": "7.8.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.500Z",
    "updated_at": "2020-06-03T06:15:24.054Z",
    "created_by": "elastic",
    "description": "Identifies use of `vssadmin.exe` for shadow copy deletion on endpoints. This\ncommonly occurs in tandem with ransomware or other destructive attacks.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "92531f8e-d9ca-4d9e-8523-cd27b98b5932",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "b5ea4bfe-a1b2-421f-9d47-22a75a6f2921",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Volume Shadow Copy Deletion via VssAdmin",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:vssadmin.exe and process.args:(delete and shadows)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery",
            "reference": "https://attack.mitre.org/techniques/T1490/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"vssadmin.exe\" and process.args:(\"delete\" and \"shadows\") ",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.105Z",
    "created_by": "elastic",
    "description": "Identifies use of `wmic.exe` for shadow copy deletion on endpoints. This\ncommonly occurs in tandem with ransomware or other destructive attacks.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "b5c09ec3-5eb7-43e8-89bd-592690fef2b0",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "dc9c1f74-dac3-48e3-b47f-eb79db358f57",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Volume Shadow Copy Deletion via WMIC",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:WMIC.exe and process.args:(delete and shadowcopy)",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"WMIC.exe\" and process.args:(\"shadowcopy\" and \"delete\")",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.507Z",
    "updated_at": "2020-06-03T06:15:24.315Z",
    "created_by": "elastic",
    "description": "A request to a web application server contained no identifying user agent\nstring.",
    "enabled": false,
    "false_positives": [
      "Some normal applications and scripts may contain no user agent. Most legitimate\nweb requests from the Internet contain a user agent string. Requests from web\nbrowsers almost always contain a user agent string. If the source is unexpected,\nthe user unauthorized, or the request unusual, these may indicate suspicious or\nmalicious activity."
    ],
    "filters": [
      {
        "$state": {
          "store": "appState"
        },
        "exists": {
          "field": "user_agent.original"
        },
        "meta": {
          "disabled": false,
          "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
          "key": "user_agent.original",
          "negate": true,
          "type": "exists",
          "value": "exists"
        }
      }
    ],
    "from": "now-6m",
    "id": "1ec89bf7-1828-4770-8dd1-9024b2a298e5",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "43303fd4-4839-4e48-b2b2-803ab060758d",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: No User Agent",
    "query": "url.path:*",
    "references": [
      "https://en.wikipedia.org/wiki/User_agent"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "APM",
      "Elastic"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "url.path: *",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.495Z",
    "updated_at": "2020-06-03T06:15:23.704Z",
    "created_by": "elastic",
    "description": "A POST request to web application returned a 403 response, which indicates the\nweb application declined to process the request because the action requested was\nnot allowed.",
    "enabled": false,
    "false_positives": [
      "Security scans and tests may result in these errors. Misconfigured or buggy\napplications may produce large numbers of these errors. If the source is\nunexpected, the user unauthorized, or the request unusual, these may indicate\nsuspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "2f3a383e-094b-4b5a-a457-ae1c2db48638",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "a87a4e42-1d82-44bd-b0bf-d9b7f91fb89e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: POST Request Declined",
    "query": "http.response.status_code:403 and http.request.method:post",
    "references": [
      "https://en.wikipedia.org/wiki/HTTP_403"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "APM",
      "Elastic"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "http.response.status_code:403 and http.request.method:post",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.496Z",
    "updated_at": "2020-06-03T06:15:23.714Z",
    "created_by": "elastic",
    "description": "A request to web application returned a 405 response which indicates the web\napplication declined to process the request because the HTTP method is not\nallowed for the resource.",
    "enabled": false,
    "false_positives": [
      "Security scans and tests may result in these errors. Misconfigured or buggy\napplications may produce large numbers of these errors. If the source is\nunexpected, the user unauthorized, or the request unusual, these may indicate\nsuspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "3e7b02ac-808d-46ec-8b9f-3bb6e0404311",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "75ee75d8-c180-481c-ba88-ee50129a6aef",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: Unauthorized Method",
    "query": "http.response.status_code:405",
    "references": [
      "https://en.wikipedia.org/wiki/HTTP_405"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "APM",
      "Elastic"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "http.response.status_code:405",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.508Z",
    "updated_at": "2020-06-03T06:15:24.623Z",
    "created_by": "elastic",
    "description": "This is an example of how to detect an unwanted web client user agent. This\nsearch matches the user agent for sqlmap 1.3.11, which is a popular FOSS tool\nfor testing web applications for SQL injection vulnerabilities.",
    "enabled": false,
    "false_positives": [
      "This rule does not indicate that a SQL injection attack occurred, only that the\n`sqlmap` tool was used. Security scans and tests may result in these errors. If\nthe source is not an authorized security tester, this is generally suspicious or\nmalicious activity."
    ],
    "from": "now-6m",
    "id": "539c80dd-ab26-4e75-a013-2c3cc343e0b8",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "d49cc73f-7a16-4def-89ce-9fc7127d7820",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: sqlmap User Agent",
    "query": "user_agent.original:\"sqlmap/1.3.11#stable (http://sqlmap.org)\"",
    "references": [
      "http://sqlmap.org/"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "APM",
      "Elastic"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "user_agent.original:\"sqlmap/1.3.11#stable (http://sqlmap.org)\"",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.515Z",
    "updated_at": "2020-06-03T06:15:24.515Z",
    "created_by": "elastic",
    "description": "Identifies use of `whoami.exe` which displays user, group, and privileges\ninformation for the user who is currently logged on to the local system.",
    "enabled": false,
    "false_positives": [
      "Some normal use of this program, at varying levels of frequency, may originate\nfrom scripts, automation tools and frameworks. Usage by non-engineers and\nordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "e0f6b635-d6c1-4ec7-8970-61aa0083e668",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "ef862985-3f13-4262-a686-5f357bbb9bc2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Whoami Process Activity",
    "query": "process.name:whoami.exe and event.code:1",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery",
            "reference": "https://attack.mitre.org/techniques/T1033/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "process.name:whoami.exe and event.code:1",
          "doc_text": "Formatting only."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.510Z",
    "updated_at": "2020-06-03T06:15:24.316Z",
    "created_by": "elastic",
    "description": "A spoofing vulnerability exists in the way Windows CryptoAPI (`Crypt32.dll`)\nvalidates Elliptic Curve Cryptography (ECC) certificates. An attacker could\nexploit the vulnerability by using a spoofed code-signing certificate to sign a\nmalicious executable, making it appear the file was from a trusted, legitimate\nsource.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "23ef4146-4e81-44b5-850c-f62cb739f266",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "56557cde-d923-4b88-adee-c61b3f3b5dc3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall)",
    "query": "event.provider:\"Microsoft-Windows-Audit-CVE\" and message:\"[CVE-2020-0601]\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1116",
            "name": "Code Signing",
            "reference": "https://attack.mitre.org/techniques/T1116/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 1,
    "last_update": "7.7.0",
    "added": "7.7.0"
  },
  {
    "actions": [],
    "created_at": "2020-06-03T06:15:23.501Z",
    "updated_at": "2020-06-03T06:15:24.098Z",
    "created_by": "elastic",
    "description": "Identifies a PowerShell process launched by either `cscript.exe` or\n`wscript.exe`. Observing Windows scripting processes executing a PowerShell\nscript, may be indicative of malicious activity.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "c7c15fd4-d8b3-46bf-a877-18c939148ad5",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "f545ff26-3c94-4fd0-bd33-3c7f95a3a0fc",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Windows Script Executing PowerShell",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(cscript.exe or wscript.exe) and process.name:powershell.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "version": 2,
    "changelog": {
      "changes": [
        {
          "version": 2,
          "updated": "7.7.0",
          "pre_query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(\"wscript.exe\" or \"cscript.exe\") and process.name:\"powershell.exe\"",
          "doc_text": "Updated query."
        }
      ]
    },
    "last_update": "7.7.0",
    "added": "7.6.0"
  }
]