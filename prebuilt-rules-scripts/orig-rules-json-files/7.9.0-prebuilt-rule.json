[
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.875Z",
    "created_by": "elastic",
    "description": "Generates a detection alert each time an Elastic Endpoint alert is received. Enabling this rule allows you to immediately begin investigating your Elastic Endpoint alerts.",
    "enabled": true,
    "exceptions_list": [
      {
        "id": "endpoint_list",
        "namespace_type": "agnostic",
        "type": "endpoint"
      }
    ],
    "false_positives": [],
    "from": "now-10m",
    "id": "f9533eb6-bea9-48f9-ad65-495114e754aa",
    "immutable": true,
    "index": ["logs-endpoint.alerts-*"],
    "interval": "5m",
    "language": "kuery",
    "last_success_at": "2020-07-19T10:20:50.736Z",
    "last_success_message": "succeeded",
    "license": "Elastic License",
    "max_signals": 10000,
    "name": "Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:(endpoint and not endgame)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [
      {
        "field": "event.risk_score",
        "operator": "equals",
        "value": ""
      }
    ],
    "rule_id": "9a1a2dae-0b5f-4c3d-8305-a268d404c306",
    "rule_name_override": "message",
    "severity": "medium",
    "severity_mapping": [
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "low",
        "value": "21"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "medium",
        "value": "47"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "high",
        "value": "73"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "critical",
        "value": "99"
      }
    ],
    "status": "going to run",
    "status_date": "2020-07-19T10:25:50.360Z",
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "timestamp_override": "event.ingested",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:19.424Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.972Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected an Exploit. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "15194811-d1fb-4b0d-9ac8-0564ad4b6d4a",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Exploit - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:exploit_event or endgame.event_subtype_full:exploit_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "2003cdc8-8d83-4aa5-b132-1f9a8eb48514",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.150Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.967Z",
    "created_by": "elastic",
    "description": "This rule detects events that may indicate use of SMTP on TCP port 26. This port is commonly used by several popular mail transfer agents to deconflict with the default SMTP port 25. This port has also been used by a malware family called BadPatch for command and control of Windows systems.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Servers that process email traffic may cause false positives and should be excluded from this rule as this is expected behavior."
    ],
    "from": "now-6m",
    "id": "96bcb3ae-6d7c-4781-bb97-1afcae31a956",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "SMTP on Port 26/TCP",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:26 or (event.dataset:zeek.smtp and destination.port:26))",
    "references": [
      "https://unit42.paloaltonetworks.com/unit42-badpatch/",
      "https://isc.sans.edu/forums/diary/Next+up+whats+up+with+TCP+port+26/25564/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "d7e62693-aab9-4f66-a21a-3d79ecdd603d",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.149Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.966Z",
    "created_by": "elastic",
    "description": "Identifies use of the netsh.exe to disable or weaken the local firewall. Attackers will use this command line tool to disable the firewall during troubleshooting or to enable network mobility.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "997376cd-fffe-49a3-8a91-edfc2416cdad",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Disable Windows Firewall Rules via Netsh",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:netsh.exe and process.args:(disable and firewall and set) or process.args:(advfirewall and off and state)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "4b438734-3793-4fda-bd42-ceeada0be8f9",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.145Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.971Z",
    "created_by": "elastic",
    "description": "Adversaries can add the 'hidden' attribute to files to hide them from the user in an attempt to evade detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "81a27263-5700-4672-abf8-3f50046dafa1",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Adding Hidden File Attribute via Attrib",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:attrib.exe and process.args:+h",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "4630d948-40d4-4cef-ac69-4002e29bc3db",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.151Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.969Z",
    "created_by": "elastic",
    "description": "This rule detects events that may describe SMTP traffic from internal hosts to a host across the Internet. In an enterprise network, there is typically a dedicated internal host that performs this function. It is also frequently abused by threat actors for command and control, or data exfiltration.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "NATed servers that process email traffic may false and should be excluded from this rule as this is expected behavior for them. Consumer and personal devices may send email traffic to remote Internet destinations. In this case, such devices or networks can be excluded from this rule if this is expected behavior."
    ],
    "from": "now-6m",
    "id": "a5c7caf8-397f-42d0-a29f-c111a05c58eb",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "SMTP to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(25 or 465 or 587) or event.dataset:zeek.smtp) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "67a9beba-830d-4035-bfe8-40b7e28f8ac4",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.150Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.966Z",
    "created_by": "elastic",
    "description": "This rule detects events that may indicate use of a PPTP VPN connection. Some threat actors use these types of connections to tunnel their traffic while avoiding detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some networks may utilize PPTP protocols but this is uncommon as more modern VPN technologies are available. Usage that is unfamiliar to local network administrators can be unexpected and suspicious. Torrenting applications may use this port. Because this port is in the ephemeral range, this rule may false under certain conditions, such as when an application server replies to a client that used this port by coincidence. This is uncommon but such servers can be excluded."
    ],
    "from": "now-6m",
    "id": "8b13b38d-ed37-4cce-8c07-f78aa0715363",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "PPTP (Point to Point Tunneling Protocol) Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and destination.port:1723",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "d2053495-8fe7-4168-b3df-dad844046be3",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.141Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.967Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of Tor traffic to the Internet. Tor is a network protocol that sends traffic through a series of encrypted tunnels used to conceal a user's location and usage. Tor may be used by threat actors as an alternate communication pathway to conceal the actor's identity and avoid detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Tor client activity is uncommon in managed enterprise networks but may be common in unmanaged or public networks where few security policies apply. Because these ports are in the ephemeral range, this rule may false under certain conditions such as when a NATed web server replies to a client which has used one of these ports by coincidence. In this case, such servers can be excluded if desired."
    ],
    "from": "now-6m",
    "id": "468f1ac4-9c03-49d4-a2f1-617a824ac28a",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Tor Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and destination.port:(9001 or 9030) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "7d2c38d7-ede7-4bdf-b140-445906e6c540",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1188",
            "name": "Multi-hop Proxy",
            "reference": "https://attack.mitre.org/techniques/T1188/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.153Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.969Z",
    "created_by": "elastic",
    "description": "Identifies the use of certutil.exe to encode or decode data. CertUtil is a native Windows component which is part of Certificate Services. CertUtil is often abused by attackers to encode or decode base64 data for stealthier command and control or exfiltration.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "14ffdb20-12e2-4ed7-b27f-7200eb643d00",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Encoding or Decoding Files via CertUtil",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:certutil.exe and process.args:(-decode or -encode or /decode or /encode)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "fd70c98a-c410-42dc-a2e3-761c71848acf",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.152Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.976Z",
    "created_by": "elastic",
    "description": "Identifies use of the SysInternals tool PsExec.exe making a network connection. This could be an indication of lateral movement.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "PsExec is a dual-use tool that can be used for benign or malicious activity. It's important to baseline your environment to determine the amount of noise to expect from this tool."
    ],
    "from": "now-6m",
    "id": "ce06310d-9eb8-4755-92b4-b8ffab745b47",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "PsExec Network Connection",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:PsExec.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "55d551c6-333b-4665-ab7e-5d14a59715ce",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1035",
            "name": "Service Execution",
            "reference": "https://attack.mitre.org/techniques/T1035/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1035",
            "name": "Service Execution",
            "reference": "https://attack.mitre.org/techniques/T1035/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.154Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.975Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Credential Manipulation. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "a06ebfa1-deab-49c8-a00b-5c5e43723193",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Credential Manipulation - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:token_manipulation_event or endgame.event_subtype_full:token_manipulation_event)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "c9e38e64-3f4c-4bf3-ad48-0e61a60ea1fa",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.158Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.968Z",
    "created_by": "elastic",
    "description": "Identifies use of the fsutil.exe to delete the volume USNJRNL. This technique is used by attackers to eliminate evidence of files created during post-exploitation activities.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "259e1efa-a2bf-4169-a5cc-0b214f47f5a0",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Delete Volume USN Journal with Fsutil",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:fsutil.exe and process.args:(deletejournal and usn)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "f675872f-6d85-40a3-b502-c0d2ef101e92",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.146Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.976Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Credential Manipulation. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "4bdef144-5ff8-4277-8aca-0728186f0ce5",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Credential Manipulation - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:token_manipulation_event or endgame.event_subtype_full:token_manipulation_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "c0be5f31-e180-48ed-aa08-96b36899d48f",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.160Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.971Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of VNC traffic from the Internet. VNC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "VNC connections may be received directly to Linux cloud server instances but such connections are usually made only by engineers. VNC is less common than SSH or RDP but may be required by some work-flows such as remote access and support for specialized software products or servers. Such work-flows are usually known and not unexpected. Usage that is unfamiliar to server or network owners can be unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "eb84a7b6-eaab-4b76-9cae-e45b2550d692",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "VNC (Virtual Network Computing) from the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "5700cb81-df44-46aa-a5d7-337798f53eb8",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1219",
            "name": "Remote Access Tools",
            "reference": "https://attack.mitre.org/techniques/T1219/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.160Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.977Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to get information about running processes on a system.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Administrators may use the tasklist command to display a list of currently running processes. By itself, it does not indicate malicious activity. After obtaining a foothold, it's possible adversaries may use discovery commands like tasklist to get information about running processes."
    ],
    "from": "now-6m",
    "id": "859fb6b3-0a56-4942-b005-dd1b266c4955",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Process Discovery via Tasklist",
    "output_index": ".siem-signals-default",
    "query": "event.code:1 and process.name:tasklist.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "cc16f774-59f9-462d-8b98-d27ccd4519ec",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1057",
            "name": "Process Discovery",
            "reference": "https://attack.mitre.org/techniques/T1057/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.166Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.979Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Malware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "df808ba1-4ef6-47c4-99fa-f6b9711b6fe2",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Malware - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:file_classification_event or endgame.event_subtype_full:file_classification_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "3b382770-efbb-44f4-beed-f5e0a051b895",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.165Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.984Z",
    "created_by": "elastic",
    "description": "Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (hh.exe).",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "9fe1424d-4c4c-4d8a-ba8f-3092f7ab3d82",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Connection via Compiled HTML File",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:hh.exe and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "b29ee2be-bf99-446c-ab1a-2dc0183394b8",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.185Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.989Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Process Injection. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "0628319c-1384-4a78-bf0c-d658c51a1a45",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Process Injection - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:kernel_shellcode_event or endgame.event_subtype_full:kernel_shellcode_event)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "990838aa-a953-4f3e-b3cb-6ddf7584de9e",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.191Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.001Z",
    "created_by": "elastic",
    "description": "A machine learning job detected activity for a username that is not normally active, which can indicate unauthorized changes, activity by unauthorized users, lateral movement, or compromised credentials. In many organizations, new usernames are not often created apart from specific types of system activities, such as creating new accounts for new employees. These user accounts quickly become active and routine. Events from rarely used usernames can point to suspicious activity. Additionally, automated Linux fleets tend to see activity from rarely used usernames only when personnel log in to make authorized or unauthorized changes, or threat actors have acquired credentials and log in for malicious purposes. Unusual usernames can also indicate pivoting, where compromised credentials are used to try and move laterally from one host to another.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Uncommon user activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "5b165402-32e4-4a63-83e4-d42255a8f12d",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "linux_anomalous_user_name_ecs",
    "max_signals": 100,
    "name": "Unusual Linux Username",
    "note": "### Investigating an Unusual Linux User ###\nDetection alerts from this rule indicate activity for a Linux user name that is rare and unusual. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host? Could this be related to troubleshooting or debugging activity by a developer or site reliability engineer?\n- Examine the history of user activity. If this user manifested only very recently, it might be a service account for a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks that the user is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "b347b919-665f-4aac-b9e8-68369bf2340c",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.190Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.998Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started by Explorer or the WMI (Windows Management Instrumentation) subsystem. This behavior is unusual and is sometimes used by malicious payloads.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "f9a163cd-116d-4b7b-ad89-9db429f2ef0f",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Microsoft Build Engine Started by a System Process",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:MSBuild.exe and process.parent.name:(explorer.exe or wmiprvse.exe)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae3",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.193Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.999Z",
    "created_by": "elastic",
    "description": "Identifies User Account Control (UAC) bypass via eventvwr.exe. Attackers bypass UAC to stealthily execute code with elevated permissions.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "84524a33-b4f0-493b-a3f9-6d5b1a7ba9a3",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Bypass UAC via Event Viewer",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:eventvwr.exe and not process.executable:(\"C:\\Windows\\SysWOW64\\mmc.exe\" or \"C:\\Windows\\System32\\mmc.exe\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "31b4c719-f2b4-41f6-a9bd-fce93c2eaf62",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1088",
            "name": "Bypass User Account Control",
            "reference": "https://attack.mitre.org/techniques/T1088/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.192Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.995Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of frequently targeted Microsoft Office applications (Word, PowerPoint, Excel). These child processes are often launched during exploitation of Office applications or from documents with malicious macros.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "9d30e54c-99f9-4967-9bf2-a505ae43b28c",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Suspicious MS Office Child Process",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "a624863f-a70d-417f-a7d2-7a404638d47f",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.193Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.995Z",
    "created_by": "elastic",
    "description": "Identifies unexpected processes making network connections over port 445. Windows File Sharing is typically implemented over Server Message Block (SMB), which communicates between hosts using port 445. When legitimate, these network connections are established by the kernel. Processes making 445/tcp connections may be port scanners, exploits, or suspicious user-level processes moving laterally.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "19d77f4e-d199-4208-bb2b-78a5a4497387",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Direct Outbound SMB Connection",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and destination.port:445 and not process.pid:4 and not destination.ip:(127.0.0.1 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "c82c7d8f-fb9e-4874-a4bd-fd9e3f9becf1",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1210",
            "name": "Exploitation of Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1210/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.194Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.007Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started by Excel or Word. This is unusual behavior for the Build Engine and could have been caused by an Excel or Word document executing a malicious script payload.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual. It is quite unusual for this program to be started by an Office application like Word or Excel."
    ],
    "from": "now-6m",
    "id": "9e875d8c-fb75-4e33-a0c7-6551910b5eff",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Microsoft Build Engine Started by an Office Application",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:MSBuild.exe and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or outlook.exe or powerpnt.exe or winword.exe)",
    "references": [
      "https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"
    ],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "c5dc3223-13a2-44a2-946c-e9dc0aa0449c",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.195Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.998Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RPC traffic to the Internet. RPC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "cd35b9e3-f9b9-4417-96c7-a803eaff2a24",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "RPC (Remote Procedure Call) to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:135 or event.dataset:zeek.dce_rpc) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "32923416-763a-4531-bb35-f33b9232ecdb",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.196Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.004Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a rare and unusual DNS query that indicate network activity with unusual DNS domains. This can be due to initial access, persistence, command-and-control, or exfiltration activity. For example, when a user clicks on a link in a phishing email or opens a malicious document, a request may be sent to download and run a payload from an uncommon domain. When malware is already running, it may send requests to an uncommon DNS domain the malware uses for command-and-control communication.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert. Network activity that occurs rarely, in small quantities, can trigger this alert. Possible examples are browsing technical support or vendor networks sparsely. A user who visits a new or unique web destination may trigger this alert."
    ],
    "from": "now-45m",
    "id": "58219afe-93b6-4d46-b05f-19342893b0fb",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "packetbeat_rare_dns_question",
    "max_signals": 100,
    "name": "Unusual DNS Activity",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "746edc4c-c54c-49c6-97a1-651223819448",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Packetbeat"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.198Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.010Z",
    "created_by": "elastic",
    "description": "Identifies an unusually high number of authentication attempts.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security audits may trigger this alert. Conditions that generate bursts of failed logins, such as misconfigured applications or account lockouts could trigger this alert."
    ],
    "from": "now-45m",
    "id": "205eeccd-599d-4978-99ca-86306a53b42c",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "suspicious_login_activity_ecs",
    "max_signals": 100,
    "name": "Unusual Login Activity",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "4330272b-9724-4bc6-a3ca-f1532b81e5c2",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.202Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.994Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious parent child process relationship with cmd.exe descending from svchost.exe",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "3479780e-30e5-4136-a619-4df8bdc5beaf",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Svchost spawning Cmd",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:svchost.exe and process.name:cmd.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "fd7a6052-58fa-4397-93c3-4795249ccfa2",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.206Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.012Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual user context switch, using the runas command or similar techniques, which can indicate account takeover or privilege escalation using compromised accounts. Privilege elevation using tools like runas are more commonly used by domain and network administrators than by regular Windows users.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Uncommon user privilege elevation activity can be due to an administrator, help desk technician, or a user performing manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "15529741-149a-49b0-82ad-0a71ffe1d223",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_rare_user_runas_event",
    "max_signals": 100,
    "name": "Unusual Windows User Privilege Elevation Activity",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "1781d055-5c66-4adf-9d82-fc0fa58449c8",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.208Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.996Z",
    "created_by": "elastic",
    "description": "Identifies a PowerShell process launched by either cscript.exe or wscript.exe. Observing Windows scripting processes executing a PowerShell script, may be indicative of malicious activity.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "2a521bda-fed8-4cb4-a089-bde2767ad755",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Windows Script Executing PowerShell",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:(cscript.exe or wscript.exe) and process.name:powershell.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "f545ff26-3c94-4fd0-bd33-3c7f95a3a0fc",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.209Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.997Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RDP traffic to the Internet. RDP is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "RDP connections may be made directly to Internet destinations in order to access Windows cloud server instances but such connections are usually made only by engineers. In such cases, only RDP gateways, bastions or jump servers may be expected Internet destinations and can be exempted from this rule. RDP may be required by some work-flows such as remote access and support for specialized software products and servers. Such work-flows are usually known and not unexpected. Usage that is unfamiliar to server or network owners can be unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "359c6601-7811-4e23-9fdc-ab38aa95cba4",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "RDP (Remote Desktop Protocol) to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:3389 or event.dataset:zeek.rdp) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "e56993d2-759c-4120-984c-9ec9bb940fd5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.210Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.006Z",
    "created_by": "elastic",
    "description": "Nmap was executed on a Linux host. Nmap is a FOSS tool for network scanning and security testing. It can map and discover networks, and identify listening services and operating systems. It is sometimes used to gather information in support of exploitation, execution or lateral movement.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security testing tools and frameworks may run `Nmap` in the course of security auditing. Some normal use of this command may originate from security engineers and network or server administrators. Use of nmap by ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "2b4bffb9-2c58-402d-a8c5-9eeb0d8ed68e",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Nmap Process Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:nmap",
    "references": ["https://en.wikipedia.org/wiki/Nmap"],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "c87fca17-b3a9-4e83-b545-f30746c53920",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.215Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.005Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Ransomware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "d93dce39-1ad9-4030-ac2d-3fb5078d5406",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Ransomware - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:ransomware_event or endgame.event_subtype_full:ransomware_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "e3c5d5cb-41d5-4206-805c-f30561eae3ac",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.223Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.024Z",
    "created_by": "elastic",
    "description": "An adversary may add the setgid bit to a file or directory in order to run a file with the privileges of the owning group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setgid bit to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "86262d31-620c-40e1-ade3-0dc177c86ad5",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "lucene",
    "license": "Elastic License",
    "max_signals": 33,
    "name": "Setgid Bit Set via chmod",
    "output_index": ".siem-signals-default",
    "query": "event.category:process AND event.type:(start or process_started) AND process.name:chmod AND process.args:(g+s OR /2[0-9]{3}/) AND NOT user.name:root",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "3a86e085-094c-412d-97ff-2439731e59cb",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.225Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.019Z",
    "created_by": "elastic",
    "description": "Identifies certutil.exe making a network connection. Adversaries could abuse certutil.exe to download a certificate, or malware, from a remote URL.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "c4583ee3-450b-4bb9-b158-956b074b2ff6",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Connection via Certutil",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:certutil.exe and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "3838e0e3-1850-4850-a411-2e8c5ba40ba8",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1105",
            "name": "Remote File Copy",
            "reference": "https://attack.mitre.org/techniques/T1105/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.229Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.033Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of a specified AWS CloudWatch log group. When a log group is deleted, all the archived log events associated with the log group are also permanently deleted.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Log group deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "39e937f4-6d6f-4171-aa0d-87cd76da246c",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudWatch Log Group Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteLogGroup and event.dataset:aws.cloudtrail and event.provider:logs.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/logs/delete-log-group.html",
      "https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_DeleteLogGroup.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "68a7a5a5-a2fc-4a76-ba9f-26849de881b4",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1485",
            "name": "Data Destruction",
            "reference": "https://attack.mitre.org/techniques/T1485/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.237Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.041Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of one or more flow logs in AWS Elastic Compute Cloud (EC2). An adversary may delete flow logs in an attempt to evade defenses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Flow log deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "afeeebb5-07b1-4130-ad44-69644e0ec09b",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS EC2 Flow Log Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteFlowLogs and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-flow-logs.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteFlowLogs.html"
    ],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "9395fd2c-9947-4472-86ef-4aceb2f7e872",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.241Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.043Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of a specified AWS Web Application Firewall (WAF) access control list.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Firewall ACL's may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Web ACL deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "47a4b9bd-b467-4cd9-b7a0-b05d5382187b",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS WAF Access Control List Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteWebACL and event.dataset:aws.cloudtrail and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/waf-regional/delete-web-acl.html",
      "https://docs.aws.amazon.com/waf/latest/APIReference/API_wafRegional_DeleteWebACL.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "91d04cd4-47a9-4334-ab14-084abe274d49",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.248Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.046Z",
    "created_by": "elastic",
    "description": "Identifies AWS IAM password recovery requests. An adversary may attempt to gain unauthorized AWS access by abusing password recovery mechanisms.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be requesting changes in your environment. Password reset attempts from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "848c5dbf-a7ab-49ef-ae80-37a61980995e",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS IAM Password Recovery Requested",
    "output_index": ".siem-signals-default",
    "query": "event.action:PasswordRecoveryRequested and event.provider:signin.amazonaws.com and event.outcome:success",
    "references": [
      "https://www.cadosecurity.com/2020/06/11/an-ongoing-aws-phishing-campaign/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "69c420e8-6c9e-4d28-86c0-8a2be2d1e78c",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.253Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.050Z",
    "created_by": "elastic",
    "description": "Identifies disabling of Amazon Elastic Block Store (EBS) encryption by default in the current region. Disabling encryption by default does not change the encryption status of your existing volumes.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Disabling encryption may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Disabling encryption by unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "df62abde-5ea4-4dd1-aa86-8892a769f235",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS EC2 Encryption Disabled",
    "output_index": ".siem-signals-default",
    "query": "event.action:DisableEbsEncryptionByDefault and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/disable-ebs-encryption-by-default.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "bb9b13b2-1700-48a8-a750-b43b0a72ab69",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1492",
            "name": "Stored Data Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1492/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.263Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.054Z",
    "created_by": "elastic",
    "description": "Identifies attempts to modify an AWS IAM Assume Role Policy. An adversary may attempt to modify the AssumeRolePolicy of a misconfigured role in order to gain the privileges of that role.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Policy updates from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "036376cf-e32f-4458-b018-931eaa9e9cb3",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS IAM Assume Role Policy Update",
    "output_index": ".siem-signals-default",
    "query": "event.module:aws and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:UpdateAssumeRolePolicy and event.outcome:success",
    "references": [
      "https://labs.bishopfox.com/tech-blog/5-privesc-attack-vectors-in-aws"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "a60326d7-dca7-4fb7-93eb-1ca03a1febbd",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.269Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 75,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.042Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an AWS API command that, while not inherently suspicious or abnormal, is being made by a user context that does not normally use the command. This can be the result of compromised credentials or keys as someone uses a valid account to persist, move laterally, or exfil data.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "New or unusual user command activity can be due to manual troubleshooting or reconfiguration; changes in cloud automation scripts or workflows; adoption of new services; or changes in the way services are used."
    ],
    "from": "now-60m",
    "id": "16090124-6edb-4c93-9bf2-505042341ab6",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "rare_method_for_a_username",
    "max_signals": 100,
    "name": "Unusual AWS Command for a User",
    "note": "### Investigating an Unusual CloudTrail Event ###\nDetection alerts from this rule indicate an AWS API command or method call that is rare and unusual for the calling IAM user. Here are some possible avenues of investigation:\n- Consider the user as identified by the `user.name` field. Is this command part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?\n- Consider the time of day. If the user is a human, not a program or script, did the activity take place during a normal time of day?\n- Examine the history of the command. If the command, which is visible in the `event.action field`, manifested only very recently, it might be part of a new automation module or script. If it has a consistent cadence - for example, if it appears in small numbers on a weekly or monthly cadence it might be part of a housekeeping or maintenance process.\n- Examine the request parameters. These may provide indications as to the source of the program or the nature of the tasks it is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "ac706eae-d5ec-4b14-b4fd-e8ba8086f0e1",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.243Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.511Z",
    "created_by": "elastic",
    "description": "Identifies an AWS configuration change to stop recording a designated set of resources.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Recording changes from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "9127563b-39a5-43c9-bbe7-d5fd3f97439e",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS Configuration Recorder Stopped",
    "output_index": ".siem-signals-default",
    "query": "event.action:StopConfigurationRecorder and event.dataset:aws.cloudtrail and event.provider:config.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/configservice/stop-configuration-recorder.html",
      "https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html"
    ],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "fbd44836-0d69-4004-a0b4-03c20370c435",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.676Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.579Z",
    "created_by": "elastic",
    "description": "A machine learning job detected AWS command activity that, while not inherently suspicious or abnormal, is sourcing from a geolocation (city) that is unusual for the command. This can be the result of compromised credentials or keys being used by a threat actor in a different geography then the authorized user(s).",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "New or unusual command and user geolocation activity can be due to manual troubleshooting or reconfiguration; changes in cloud automation scripts or workflows; adoption of new services; expansion into new regions; increased adoption of work from home policies; or users who travel frequently."
    ],
    "from": "now-60m",
    "id": "7b4bf9e1-937f-49ce-a73b-f06021250510",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "rare_method_for_a_city",
    "max_signals": 100,
    "name": "Unusual City For an AWS Command",
    "note": "### Investigating an Unusual CloudTrail Event ###\nDetection alerts from this rule indicate an AWS API command or method call that is rare and unusual for the geolocation of the source IP address. Here are some possible avenues of investigation:\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?\n- Consider the user as identified by the `user.name` field. Is this command part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the time of day. If the user is a human, not a program or script, did the activity take place during a normal time of day?\n- Examine the history of the command. If the command, which is visible in the `event.action field`, manifested only very recently, it might be part of a new automation module or script. If it has a consistent cadence - for example, if it appears in small numbers on a weekly or monthly cadence it might be part of a housekeeping or maintenance process.\n- Examine the request parameters. These may provide indications as to the source of the program or the nature of the tasks it is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "809b70d3-e2c3-455e-af1b-2626a5a1a276",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.746Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.610Z",
    "created_by": "elastic",
    "description": "Identifies suspending the recording of AWS API calls and log file delivery for the specified trail. An adversary may suspend trails in an attempt to evade defenses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Suspending the recording of a trail may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail suspensions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "083675fd-cf84-4804-8a78-a89cc49fd36c",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudTrail Log Suspended",
    "output_index": ".siem-signals-default",
    "query": "event.action:StopLogging and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_StopLogging.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/stop-logging.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "1aa8fa52-44a7-4dae-b058-f3333b91c8d7",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.779Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.624Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to modify an Okta multi-factor authentication (MFA) rule in order to remove or weaken an organization's security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if Okta MFA rules are regularly modified in your organization."
    ],
    "from": "now-6m",
    "id": "ae1551f5-5935-46e5-9670-b87d59ae4899",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Modify Okta MFA Rule",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:(policy.rule.update or policy.rule.delete)",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "000047bb-b27a-47ec-8b62-ef1a5d2c9e19",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.790Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.634Z",
    "created_by": "elastic",
    "description": "Identifies attempts to revoke an Okta API token. An adversary may attempt to revoke or delete an Okta API token to disrupt an organization's business operations.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "If the behavior of revoking Okta API tokens is expected, consider adding exceptions to this rule to filter false positives."
    ],
    "from": "now-6m",
    "id": "3517a6af-e240-4593-a437-4de10956db87",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Revoke Okta API Token",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:system.api_token.revoke",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "676cff2b-450b-4cf1-8ed2-c0c58a4a2dd7",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1531",
            "name": "Account Access Removal",
            "reference": "https://attack.mitre.org/techniques/T1531/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.800Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.639Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to delete an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to delete an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if Okta policies are regularly deleted in your organization."
    ],
    "from": "now-6m",
    "id": "9f2b8e3a-d8e1-48dd-bf28-bac8fcbb8b8e",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Delete Okta Policy",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:policy.lifecycle.delete",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "b4bb1440-0fcb-4ed1-87e5-b06d58efc5e9",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.804Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.646Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to disrupt an organization's business operations by performing a denial of service (DoS) attack against its Okta infrastructure.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "e1ad43f3-68b0-443a-b467-20e625d173f8",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Possible Okta DoS Attack",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:(application.integration.rate_limit_exceeded or system.org.rate_limit.warning or system.org.rate_limit.violation or core.concurrency.org.limit.violation)",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "e6e3ecff-03dd-48ec-acbd-54a04de10c68",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1498",
            "name": "Network Denial of Service",
            "reference": "https://attack.mitre.org/techniques/T1498/"
          },
          {
            "id": "T1499",
            "name": "Endpoint Denial of Service",
            "reference": "https://attack.mitre.org/techniques/T1499/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.809Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.645Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual error in a CloudTrail message. These can be byproducts of attempted or successful persistence, privilege escalation, defense evasion, discovery, lateral movement, or collection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Rare and unusual errors may indicate an impending service failure state. Rare and unusual user error activity can also be due to manual troubleshooting or reconfiguration attempts by insufficiently privileged users, bugs in cloud automation scripts or workflows, or changes to IAM privileges."
    ],
    "from": "now-60m",
    "id": "3736d015-c5e8-486f-936d-fd59d7675b22",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "rare_error_code",
    "max_signals": 100,
    "name": "Rare AWS Error Code",
    "note": "### Investigating Unusual CloudTrail Error Activity ###\nDetection alerts from this rule indicate a rare and unusual error code that was associated with the response to an AWS API command or method call. Here are some possible avenues of investigation:\n- Examine the history of the error. Has it manifested before? If the error, which is visible in the `aws.cloudtrail.error_code field`, manifested only very recently, it might be related to recent changes in an automation module or script.\n- Examine the request parameters. These may provide indications as to the nature of the task being performed when the error occurred. Is the error related to unsuccessful attempts to enumerate or access objects, data, or secrets? If so, this can sometimes be a byproduct of discovery, privilege escalation, or lateral movement attempts.\n- Consider the user as identified by the `user.name` field. Is this activity part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "19de8096-e2b0-4bd8-80c9-34a820813fff",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.808Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.646Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of an Amazon Relational Database Service (RDS) Aurora database cluster or global database cluster.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Clusters may be deleted by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Cluster deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "132e2425-f74f-4eb5-af9a-41427410b184",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS RDS Cluster Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:(DeleteDBCluster or DeleteGlobalCluster) and event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/delete-db-cluster.html",
      "https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_DeleteDBCluster.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/delete-global-cluster.html",
      "https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_DeleteGlobalCluster.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "9055ece6-2689-4224-a0e0-b04881e1f8ad",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1485",
            "name": "Data Destruction",
            "reference": "https://attack.mitre.org/techniques/T1485/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.811Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.653Z",
    "created_by": "elastic",
    "description": "An attempt was made to modify AWS EC2 snapshot attributes. Snapshots are sometimes shared by threat actors in order to exfiltrate bulk data from an EC2 fleet. If the permissions were modified, verify the snapshot was not shared with an unauthorized or unexpected AWS account.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "IAM users may occasionally share EC2 snapshots with another AWS account belonging to the same organization. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "7281cea9-06bd-431f-a5fa-87c2b1eb6429",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS EC2 Snapshot Activity",
    "output_index": ".siem-signals-default",
    "query": "event.module:aws and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:ModifySnapshotAttribute",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/modify-snapshot-attribute.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ModifySnapshotAttribute.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "98fd7407-0bd5-5817-cda0-3fcc33113a56",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1537",
            "name": "Transfer Data to Cloud Account",
            "reference": "https://attack.mitre.org/techniques/T1537/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.822Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.652Z",
    "created_by": "elastic",
    "description": "This rule detects when a user reports suspicious activity for their Okta account. These events should be investigated, as they can help security teams identify when an adversary is attempting to gain access to their network.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A user may report suspicious activity on their Okta account in error."
    ],
    "from": "now-6m",
    "id": "3ecdad78-4099-4b87-b860-78eb42514c3a",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Suspicious Activity Reported by Okta User",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:user.account.report_suspicious_activity_by_enduser",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "f994964f-6fce-4d75-8e79-e16ccc412588",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.824Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.651Z",
    "created_by": "elastic",
    "description": "Identifies an update to an AWS log trail setting that specifies the delivery of log files.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Trail updates may be made by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail updates from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "765a1334-45c3-4d49-816c-2a5521c428c0",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudTrail Log Updated",
    "output_index": ".siem-signals-default",
    "query": "event.action:UpdateTrail and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/update-trail.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "3e002465-876f-4f04-b016-84ef48ce7e5d",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1492",
            "name": "Stored Data Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1492/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0009",
          "name": "Collection",
          "reference": "https://attack.mitre.org/tactics/TA0009/"
        },
        "technique": [
          {
            "id": "T1530",
            "name": "Data from Cloud Storage Object",
            "reference": "https://attack.mitre.org/techniques/T1530/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.825Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.653Z",
    "created_by": "elastic",
    "description": "A machine learning job detected AWS command activity that, while not inherently suspicious or abnormal, is sourcing from a geolocation (country) that is unusual for the command. This can be the result of compromised credentials or keys being used by a threat actor in a different geography then the authorized user(s).",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "New or unusual command and user geolocation activity can be due to manual troubleshooting or reconfiguration; changes in cloud automation scripts or workflows; adoption of new services; expansion into new regions; increased adoption of work from home policies; or users who travel frequently."
    ],
    "from": "now-60m",
    "id": "b95faffe-ea72-4652-abc4-b00d1fa51aab",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "rare_method_for_a_country",
    "max_signals": 100,
    "name": "Unusual Country For an AWS Command",
    "note": "### Investigating an Unusual CloudTrail Event ###\nDetection alerts from this rule indicate an AWS API command or method call that is rare and unusual for the geolocation of the source IP address. Here are some possible avenues of investigation:\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?\n- Consider the user as identified by the `user.name` field. Is this command part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the time of day. If the user is a human, not a program or script, did the activity take place during a normal time of day?\n- Examine the history of the command. If the command, which is visible in the `event.action field`, manifested only very recently, it might be part of a new automation module or script. If it has a consistent cadence - for example, if it appears in small numbers on a weekly or monthly cadence it might be part of a housekeeping or maintenance process.\n- Examine the request parameters. These may provide indications as to the source of the program or the nature of the tasks it is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "dca28dee-c999-400f-b640-50a081cc0fd1",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.827Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.658Z",
    "created_by": "elastic",
    "description": "Identifies the deactivation of a specified multi-factor authentication (MFA) device and removes it from association with the user name for which it was originally enabled. In AWS Identity and Access Management (IAM), a device must be deactivated before it can be deleted.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A MFA device may be deactivated by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. MFA device deactivations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "bc4c443d-c99d-4a76-bdc6-b792683b20a5",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS IAM Deactivation of MFA Device",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeactivateMFADevice and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/deactivate-mfa-device.html",
      "https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeactivateMFADevice.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "d8fc1cca-93ed-43c1-bbb6-c0dd3eff2958",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1531",
            "name": "Account Access Removal",
            "reference": "https://attack.mitre.org/techniques/T1531/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.837Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.666Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to deactivate an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to deactivate an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "If the behavior of deactivating Okta policies is expected, consider adding exceptions to this rule to filter false positives."
    ],
    "from": "now-6m",
    "id": "6de267a2-12c3-4a24-b62c-caaa7d3a3a63",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Deactivate Okta Policy",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:policy.lifecycle.deactivate",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "b719a170-3bdb-4141-b0e3-13e3cf627bfe",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1098",
            "name": "Account Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1098/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.838Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.681Z",
    "created_by": "elastic",
    "description": "Identifies a successful login to the AWS Management Console by the Root user.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "It's strongly recommended that the root user is not used for everyday tasks, including the administrative ones. Verify whether the IP address, location, and/or hostname should be logging in as root in your environment. Unfamiliar root logins should be investigated immediately. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "84089f3e-c0af-4e40-8b5b-92e1f1b42b85",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS Management Console Root Login",
    "output_index": ".siem-signals-default",
    "query": "event.action:ConsoleLogin and event.module:aws and event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and aws.cloudtrail.user_identity.type:Root and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html"
    ],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "e2a67480-3b79-403d-96e3-fdd2992c50ef",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.857Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.677Z",
    "created_by": "elastic",
    "description": "Generates a detection alert for each external alert written to the configured securitySolution:defaultIndex. Enabling this rule allows you to immediately begin investigating external alerts in the app.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "fdc7dba4-fa1d-4069-bc48-55498e64682a",
    "immutable": true,
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 10000,
    "name": "External Alerts",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and not event.module:(endgame or endpoint)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [
      {
        "field": "event.risk_score",
        "operator": "equals",
        "value": ""
      }
    ],
    "rule_id": "eb079c62-4481-4d6e-9643-3ca499df7aaa",
    "rule_name_override": "message",
    "severity": "medium",
    "severity_mapping": [
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "low",
        "value": "21"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "medium",
        "value": "47"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "high",
        "value": "73"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "critical",
        "value": "99"
      }
    ],
    "tags": ["Elastic"],
    "threat": [],
    "throttle": "no_actions",
    "timestamp_override": "event.ingested",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.858Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.694Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to modify or delete the sign on policy for an Okta application in order to remove or weaken an organization's security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if sign on policies for Okta applications are regularly modified or deleted in your organization."
    ],
    "from": "now-6m",
    "id": "6c89c613-9587-4447-a70f-c244c332646c",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Modification or Removal of an Okta Application Sign-On Policy",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:(application.policy.sign_on.update or application.policy.sign_on.rule.delete)",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "cd16fb10-0261-46e8-9932-a0336278cdbe",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.859Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.695Z",
    "created_by": "elastic",
    "description": "An adversary may create an Okta API token to maintain access to an organization's network while they work to achieve their objectives. An attacker may abuse an API token to execute techniques such as creating user accounts or disabling security rules or policies.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "If the behavior of creating Okta API tokens is expected, consider adding exceptions to this rule to filter false positives."
    ],
    "from": "now-6m",
    "id": "33d79a14-1dd4-41d2-a2bb-193e7b31929f",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Create Okta API Token",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:system.api_token.create",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "96b9f4ea-0e8c-435b-8d53-2096e75fcac5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1136",
            "name": "Create Account",
            "reference": "https://attack.mitre.org/techniques/T1136/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.867Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.032Z",
    "created_by": "elastic",
    "description": "Identifies unusual listening ports on Linux instances that can indicate execution of unauthorized services, backdoors, or persistence mechanisms.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this alert."
    ],
    "from": "now-45m",
    "id": "f9c92545-16f4-4a38-9453-f4cc1928d308",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "linux_anomalous_network_service",
    "max_signals": 100,
    "name": "Unusual Linux Network Service",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "52afbdc5-db15-596e-bc35-f5707f820c4b",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.244Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.010Z",
    "created_by": "elastic",
    "description": "A machine learning job detected unusually large numbers of DNS queries for a single top-level DNS domain, which is often used for DNS tunneling. DNS tunneling can be used for command-and-control, persistence, or data exfiltration activity. For example, dnscat tends to generate many DNS questions for a top-level domain as it uses the DNS protocol to tunnel data.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "DNS domains that use large numbers of child domains, such as software or content distribution networks, can trigger this alert and such parent domains can be excluded."
    ],
    "from": "now-45m",
    "id": "1587ef6a-cffe-46d5-aeb1-6a04e97e7355",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "packetbeat_dns_tunneling",
    "max_signals": 100,
    "name": "DNS Tunneling",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "91f02f01-969f-4167-8f66-07827ac3bdd9",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Packetbeat"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.203Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.002Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Process Injection. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "9be75a74-ffdb-4f1f-9cf8-f2043709c659",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Process Injection - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:kernel_shellcode_event or endgame.event_subtype_full:kernel_shellcode_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "80c52164-c82a-402c-9964-852533d58be1",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.218Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.010Z",
    "created_by": "elastic",
    "description": "Nping ran on a Linux host. Nping is part of the Nmap tool suite and has the ability to construct raw packets for a wide variety of security testing applications, including denial of service testing.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some normal use of this command may originate from security engineers and network or server administrators, but this is usually not routine or unannounced. Use of `Nping` by non-engineers or ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "625eefac-b187-44a9-8b87-be0c476c45b2",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Nping Process Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:nping",
    "references": ["https://en.wikipedia.org/wiki/Nmap"],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "0d69150b-96f8-467c-a86d-a67a3378ce77",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.224Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.044Z",
    "created_by": "elastic",
    "description": "Identifies the creation of a new Amazon Relational Database Service (RDS) Aurora DB cluster or global database spread across multiple regions.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Valid clusters may be created by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Cluster creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "1be1c0f4-c0a4-4082-8e23-6d0bc2ee9f52",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS RDS Cluster Creation",
    "output_index": ".siem-signals-default",
    "query": "event.action:(CreateDBCluster or CreateGlobalCluster) and event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-db-cluster.html",
      "https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_CreateDBCluster.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-global-cluster.html",
      "https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_CreateGlobalCluster.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "e14c5fd7-fdd7-49c2-9e5b-ec49d817bc8d",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1108",
            "name": "Redundant Access",
            "reference": "https://attack.mitre.org/techniques/T1108/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1108",
            "name": "Redundant Access",
            "reference": "https://attack.mitre.org/techniques/T1108/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.247Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.025Z",
    "created_by": "elastic",
    "description": "Identifies use of bcdedit.exe to delete boot configuration data. This tactic is sometimes used as by malware or an attacker as a destructive technique.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "6439b069-e1c1-4679-9c66-df56cc382679",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Modification of Boot Configuration",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:bcdedit.exe and process.args:(/set and (bootstatuspolicy and ignoreallfailures or no and recoveryenabled))",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "69c251fb-a5d6-4035-b5ec-40438bd829ff",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.236Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.035Z",
    "created_by": "elastic",
    "description": "Identifies msxsl.exe making a network connection. This may indicate adversarial activity as msxsl.exe is often leveraged by adversaries to execute malicious scripts and evade detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "0ea6c5a7-d22c-4d80-8612-bf57e78e82d6",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Connection via MsXsl",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:msxsl.exe and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "b86afe07-0d98-4738-b15d-8d7465f95ff5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1220",
            "name": "XSL Script Processing",
            "reference": "https://attack.mitre.org/techniques/T1220/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.257Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.037Z",
    "created_by": "elastic",
    "description": "Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Certain programs or applications may modify files or change ownership in writable directories. These can be exempted by username."
    ],
    "from": "now-6m",
    "id": "2e48006b-7c13-446c-bf57-2a0a9ccf804e",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "File Permission Modification in Writable Directory",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(chmod or chown or chattr or chgrp) and process.working_directory:(/tmp or /var/tmp or /dev/shm) and not user.name:root",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "9f9a2a82-93a8-4b1a-8778-1780895626d4",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1222",
            "name": "File and Directory Permissions Modification",
            "reference": "https://attack.mitre.org/techniques/T1222/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.250Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.038Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of an AWS CloudWatch log stream, which permanently deletes all associated archived log events with the stream.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A log stream may be deleted by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Log stream deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "1352151a-b988-4e1b-a424-a719371ec943",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudWatch Log Stream Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteLogStream and event.dataset:aws.cloudtrail and event.provider:logs.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/logs/delete-log-stream.html",
      "https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_DeleteLogStream.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "d624f0ae-3dd1-4856-9aad-ccfe4d4bfa17",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1485",
            "name": "Data Destruction",
            "reference": "https://attack.mitre.org/techniques/T1485/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.246Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.046Z",
    "created_by": "elastic",
    "description": "Identifies the addition of a user to a specified group in AWS Identity and Access Management (IAM).",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Adding users to a specified group may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. User additions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "1b930ae9-f17a-4d29-aef8-2d9d1ec26401",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS IAM User Addition to Group",
    "output_index": ".siem-signals-default",
    "query": "event.action:AddUserToGroup and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/IAM/latest/APIReference/API_AddUserToGroup.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "333de828-8190-4cf5-8d7c-7575846f6fe0",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1098",
            "name": "Account Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1098/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1098",
            "name": "Account Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1098/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.255Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.011Z",
    "created_by": "elastic",
    "description": "Identifies unusual parent-child process relationships that can indicate malware execution or persistence mechanisms. Malicious scripts often call on other applications and processes as part of their exploit payload. For example, when a malicious Office document runs scripts as part of an exploit payload, Excel or Word may start a script interpreter process, which, in turn, runs a script that downloads and executes malware. Another common scenario is Outlook running an unusual process when malware is downloaded in an email. Monitoring and identifying anomalous process relationships is a method of detecting new and emerging malware that is not yet recognized by anti-virus scanners.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Users running scripts in the course of technical support operations of software upgrades could trigger this alert. A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."
    ],
    "from": "now-45m",
    "id": "8118da67-8453-475e-8fa0-1634ff07a95a",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_process_creation",
    "max_signals": 100,
    "name": "Anomalous Windows Process Creation",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "0b29cab4-dbbd-4a3f-9e8e-1287c7c11ae5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.205Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.003Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of Windows file sharing (also called SMB or CIFS) traffic to the Internet. SMB is commonly used within networks to share files, printers, and other system resources amongst trusted systems. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector or for data exfiltration.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "1eda8bc2-68b9-4929-8ddb-fcb52ef7dd8c",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "SMB (Windows File Sharing) Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(139 or 445) or event.dataset:zeek.smb) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "c82b2bd8-d701-420c-ba43-f11a155b681a",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.208Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.044Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to bypass the Okta multi-factor authentication (MFA) policies configured for an organization in order to obtain unauthorized access to an application. This rule detects when an Okta MFA bypass attempt occurs.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "8f7729c6-8ca1-4828-8c4c-9541052f995c",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempted Bypass of Okta MFA",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:user.mfa.attempt_bypass",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "3805c3dc-f82c-4f8d-891e-63c24d3102b0",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1111",
            "name": "Two-Factor Authentication Interception",
            "reference": "https://attack.mitre.org/techniques/T1111/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.245Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.040Z",
    "created_by": "elastic",
    "description": "Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."
    ],
    "from": "now-6m",
    "id": "a3d8a4d5-1048-4771-b73c-ee6b6414940e",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Base64 Encoding/Decoding Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(base64 or base64plain or base64url or base64mime or base64pem)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "97f22dab-84e8-409d-955e-dacd1d31670b",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1027/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.258Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.004Z",
    "created_by": "elastic",
    "description": "A scheduled task can be used by an adversary to establish persistence, move laterally, and/or escalate privileges.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Legitimate scheduled tasks may be created during installation of new software."
    ],
    "from": "now-6m",
    "id": "3b0a67f0-4ff3-4d5b-a3fb-26fa15846933",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Local Scheduled Task Commands",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:schtasks.exe and process.args:(-change or -create or -run or -s or /S or /change or /create or /run)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "afcce5ad-65de-4ed2-8516-5e093d3ac99a",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1053",
            "name": "Scheduled Task",
            "reference": "https://attack.mitre.org/techniques/T1053/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.204Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.013Z",
    "created_by": "elastic",
    "description": "A machine learning job detected activity for a username that is not normally active, which can indicate unauthorized changes, activity by unauthorized users, lateral movement, or compromised credentials. In many organizations, new usernames are not often created apart from specific types of system activities, such as creating new accounts for new employees. These user accounts quickly become active and routine. Events from rarely used usernames can point to suspicious activity. Additionally, automated Linux fleets tend to see activity from rarely used usernames only when personnel log in to make authorized or unauthorized changes, or threat actors have acquired credentials and log in for malicious purposes. Unusual usernames can also indicate pivoting, where compromised credentials are used to try and move laterally from one host to another.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Uncommon user activity can be due to an administrator or help desk technician logging onto a workstation or server in order to perform manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "f19f4ff2-8ea6-4f44-9857-345576b13adf",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_user_name_ecs",
    "max_signals": 100,
    "name": "Unusual Windows Username",
    "note": "### Investigating an Unusual Windows User ###\nDetection alerts from this rule indicate activity for a Windows user name that is rare and unusual. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host? Could this be related to occasional troubleshooting or support activity?\n- Examine the history of user activity. If this user manifested only very recently, it might be a service account for a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks that the user is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "1781d055-5c66-4adf-9c59-fc0fa58336a5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.216Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.014Z",
    "created_by": "elastic",
    "description": "Identifies attempts to create new local users. This is sometimes done by attackers to increase access to a system or domain.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "6dfc7d9c-638e-455b-89db-9413ecd9c3c1",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "User Account Creation",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(net.exe or net1.exe) and not process.parent.name:net.exe and process.args:(user and (/ad or /add))",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "1aa9181a-492b-4c01-8b16-fa0735786b2b",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1136",
            "name": "Create Account",
            "reference": "https://attack.mitre.org/techniques/T1136/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.228Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.003Z",
    "created_by": "elastic",
    "description": "Identifies use of the wbadmin.exe to delete the backup catalog. Ransomware and other malware may do this to prevent system recovery.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "4f486a77-fed1-4d4e-ba76-6a7f2a0e10f0",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Deleting Backup Catalogs with Wbadmin",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:wbadmin.exe and process.args:(catalog and delete)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "581add16-df76-42bb-af8e-c979bfb39a59",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.206Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.042Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of an Amazon GuardDuty detector. Upon deletion, GuardDuty stops monitoring the environment and all existing findings are lost.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The GuardDuty detector may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Detector deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "d33f9e8c-b69a-4136-80c5-a46e28f256c2",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS GuardDuty Detector Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteDetector and event.dataset:aws.cloudtrail and event.provider:guardduty.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/guardduty/delete-detector.html",
      "https://docs.aws.amazon.com/guardduty/latest/APIReference/API_DeleteDetector.html"
    ],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "523116c0-d89d-4d7c-82c2-39e6845a78ef",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.242Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Nick Jones", "Elastic"],
    "created_at": "2020-07-19T09:20:17.050Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to access the secrets in secrets manager to steal certificates, credentials, or other sensitive material",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be using GetSecretString API for the specified SecretId. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "fcb00fae-8c86-4626-b19b-966ecb250d43",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS Access Secret in Secrets Manager",
    "output_index": ".siem-signals-default",
    "query": "event.dataset:aws.cloudtrail and event.provider:secretsmanager.amazonaws.com and event.action:GetSecretValue",
    "references": [
      "https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_GetSecretValue.html",
      "http://detectioninthe.cloud/credential_access/access_secret_in_secrets_manager/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "a00681e3-9ed6-447c-ab2c-be648821c622",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1528",
            "name": "Steal Application Access Token",
            "reference": "https://attack.mitre.org/techniques/T1528/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.263Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.031Z",
    "created_by": "elastic",
    "description": "Identifies unusual destination port activity that can indicate command-and-control, persistence mechanism, or data exfiltration activity. Rarely used destination port activity is generally unusual in Linux fleets, and can indicate unauthorized access or threat actor activity.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this alert."
    ],
    "from": "now-45m",
    "id": "0cc70059-e039-413e-9629-8a0e08d1c276",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "linux_anomalous_network_port_activity_ecs",
    "max_signals": 100,
    "name": "Unusual Linux Network Port Activity",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "3c7e32e6-6104-46d9-a06e-da0f8b5795a0",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.249Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.044Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to remove the multi-factor authentication (MFA) factors registered on an Okta user's account in order to register new MFA factors and abuse the account to blend in with normal activity in the victim's environment.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if the MFA factors for Okta user accounts are regularly reset in your organization."
    ],
    "from": "now-6m",
    "id": "251e18c6-7dea-4ada-9aad-20e2b6f3c583",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Reset MFA Factors for Okta User Account",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:user.mfa.factor.reset_all",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "729aa18d-06a6-41c7-b175-b65b739b1181",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1098",
            "name": "Account Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1098/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.245Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.027Z",
    "created_by": "elastic",
    "description": "Identifies Windows programs run from unexpected parent processes. This could indicate masquerading or other strange activity on a system.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "59dc6b65-27bb-4e4a-92f1-1bc7bf56f132",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Unusual Parent-Child Relationship",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.executable:* and (process.name:smss.exe and not process.parent.name:(System or smss.exe) or process.name:csrss.exe and not process.parent.name:(smss.exe or svchost.exe) or process.name:wininit.exe and not process.parent.name:smss.exe or process.name:winlogon.exe and not process.parent.name:smss.exe or process.name:lsass.exe and not process.parent.name:wininit.exe or process.name:LogonUI.exe and not process.parent.name:(wininit.exe or winlogon.exe) or process.name:services.exe and not process.parent.name:wininit.exe or process.name:svchost.exe and not process.parent.name:(MsMpEng.exe or services.exe) or process.name:spoolsv.exe and not process.parent.name:services.exe or process.name:taskhost.exe and not process.parent.name:(services.exe or svchost.exe) or process.name:taskhostw.exe and not process.parent.name:(services.exe or svchost.exe) or process.name:userinit.exe and not process.parent.name:(dwm.exe or winlogon.exe))",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "35df0dd8-092d-4a83-88c1-5151a804f31b",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1093",
            "name": "Process Hollowing",
            "reference": "https://attack.mitre.org/techniques/T1093/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.238Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.041Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to deactivate an Okta multi-factor authentication (MFA) rule in order to remove or weaken an organization's security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if Okta MFA rules are regularly deactivated in your organization."
    ],
    "from": "now-6m",
    "id": "ac3683b1-3e9e-48ae-b285-43c423084bd4",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Deactivate Okta MFA Rule",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:policy.rule.deactivate",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "cc92c835-da92-45c9-9f29-b4992ad621a0",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.247Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.017Z",
    "created_by": "elastic",
    "description": "Identifies when a terminal (tty) is spawned via Python. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "e4b30613-6c38-45a7-844c-e34a83053148",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Interactive Terminal Spawned via Python",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:python and process.args:(\"import pty; pty.spawn(\\\"/bin/sh\\\")\" or \"import pty; pty.spawn(\\\"/bin/dash\\\")\" or \"import pty; pty.spawn(\\\"/bin/bash\\\")\")",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "d76b02ef-fc95-4001-9297-01cb7412232f",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.220Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.016Z",
    "created_by": "elastic",
    "description": "RegSvcs.exe and RegAsm.exe are Windows command line utilities that are used to register .NET Component Object Model (COM) assemblies. Adversaries can use RegSvcs.exe and RegAsm.exe to proxy execution of code through a trusted Windows utility.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "c7d7c8de-0891-4da9-b57e-ee6f9451cc60",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Execution via Regsvcs/Regasm",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(RegAsm.exe or RegSvcs.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "47f09343-8d1f-4bb5-8bb0-00c9d18f5010",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm",
            "reference": "https://attack.mitre.org/techniques/T1121/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm",
            "reference": "https://attack.mitre.org/techniques/T1121/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.225Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.043Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a significant spike in the rate of a particular error in the CloudTrail messages. Spikes in error messages may accompany attempts at privilege escalation, lateral movement, or discovery.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Spikes in error message activity can also be due to bugs in cloud automation scripts or workflows; changes to cloud automation scripts or workflows; adoption of new services; changes in the way services are used; or changes to IAM privileges."
    ],
    "from": "now-60m",
    "id": "9ff357f4-94b9-43e8-9eb8-0620657d1e30",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "high_distinct_count_error_message",
    "max_signals": 100,
    "name": "Spike in AWS Error Messages",
    "note": "### Investigating Spikes in CloudTrail Errors ###\nDetection alerts from this rule indicate a large spike in the number of CloudTrail log messages that contain a particular error message. The error message in question was associated with the response to an AWS API command or method call. Here are some possible avenues of investigation:\n- Examine the history of the error. Has it manifested before? If the error, which is visible in the `aws.cloudtrail.error_message` field, manifested only very recently, it might be related to recent changes in an automation module or script.\n- Examine the request parameters. These may provide indications as to the nature of the task being performed when the error occurred. Is the error related to unsuccessful attempts to enumerate or access objects, data or secrets? If so, this can sometimes be a byproduct of discovery, privilege escalation or lateral movement attempts.\n- Consider the user as identified by the user.name field. Is this activity part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "78d3d8d9-b476-451d-a9e0-7a5addd70670",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.244Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.045Z",
    "created_by": "elastic",
    "description": "Identifies the creation of an AWS Elastic Compute Cloud (EC2) network access control list (ACL) or an entry in a network ACL with a specified rule number.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Network ACL's may be created by a network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Network ACL creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "621d1a25-f10b-4422-bc8d-7773085227dd",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS EC2 Network Access Control List Creation",
    "output_index": ".siem-signals-default",
    "query": "event.action:(CreateNetworkAcl or CreateNetworkAclEntry) and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/create-network-acl.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAcl.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/create-network-acl-entry.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAclEntry.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "39144f38-5284-4f8e-a2ae-e3fd628d90b0",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1108",
            "name": "Redundant Access",
            "reference": "https://attack.mitre.org/techniques/T1108/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.255Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.012Z",
    "created_by": "elastic",
    "description": "Windows services typically run as SYSTEM and can be used as a privilege escalation opportunity. Malware or penetration testers may run a shell as a service to gain SYSTEM permissions.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "41f45471-8478-42ad-9da3-dcb04198efb9",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "System Shells via Services",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:services.exe and process.name:(cmd.exe or powershell.exe)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "0022d47d-39c7-4f69-a232-4fe9dc7a3acd",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1050",
            "name": "New Service",
            "reference": "https://attack.mitre.org/techniques/T1050/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.227Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.025Z",
    "created_by": "elastic",
    "description": "Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to non-publicly routable IP addresses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious."
    ],
    "from": "now-6m",
    "id": "6d5b189e-dc32-4ff7-af42-995d781d36e3",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Connection to Internal Network via Telnet",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:(connection or start) and process.name:telnet and destination.ip:((10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"FE80::/10\") and not (127.0.0.0/8 or \"::1/128\"))",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "1b21abcc-4d9f-4b08-a7f5-316f5f94b973",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.230Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.029Z",
    "created_by": "elastic",
    "description": "Users can mark specific files as hidden simply by putting a \".\" as the first character in the file or folder name. Adversaries can use this to their advantage to hide files and folders on the system for persistence and defense evasion. This rule looks for hidden files or folders in common writable directories.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Certain tools may create hidden temporary files or directories upon installation or as part of their normal behavior. These events can be filtered by the process arguments, username, or process name values."
    ],
    "from": "now-6m",
    "id": "3aacd881-a864-4694-b86e-62691df13f33",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "lucene",
    "license": "Elastic License",
    "max_signals": 33,
    "name": "Creation of Hidden Files and Directories",
    "output_index": ".siem-signals-default",
    "query": "event.category:process AND event.type:(start or process_started) AND process.working_directory:(\"/tmp\" or \"/var/tmp\" or \"/dev/shm\") AND process.args:/\\.[a-zA-Z0-9_\\-][a-zA-Z0-9_\\-\\.]{1,254}/ AND NOT process.name:(ls or find)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "b9666521-4742-49ce-9ddc-b8e84c35acae",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.233Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.039Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to get detailed information about the operating system and hardware. This rule identifies common locations used to discover virtual machine hardware by a non-root user. This technique has been used by the Pupy RAT and other malware.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Certain tools or automated software may enumerate hardware information. These tools can be exempted via user name or process arguments to eliminate potential noise."
    ],
    "from": "now-6m",
    "id": "5dd1ad1b-99e2-4d40-9485-f4d02083df65",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Virtual Machine Fingerprinting",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.args:(\"/sys/class/dmi/id/bios_version\" or \"/sys/class/dmi/id/product_name\" or \"/sys/class/dmi/id/chassis_vendor\" or \"/proc/scsi/scsi\" or \"/proc/ide/hd0/model\") and not user.name:root",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "5b03c9fb-9945-4d2f-9568-fd690fee3fba",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1082",
            "name": "System Information Discovery",
            "reference": "https://attack.mitre.org/techniques/T1082/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.252Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.024Z",
    "created_by": "elastic",
    "description": "Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to publicly routable IP addresses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious."
    ],
    "from": "now-6m",
    "id": "accc398f-f5f6-4802-85f4-70f7769774c1",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Connection to External Network via Telnet",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:(connection or start) and process.name:telnet and not destination.ip:(127.0.0.0/8 or 10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"FE80::/10\" or \"::1/128\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "e19e64ee-130e-4c07-961f-8a339f0b8362",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.232Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.033Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual network destination domain name. This can be due to initial access, persistence, command-and-control, or exfiltration activity. For example, when a user clicks on a link in a phishing email or opens a malicious document, a request may be sent to download and run a payload from an uncommon web server name. When malware is already running, it may send requests to an uncommon DNS domain the malware uses for command-and-control communication.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Web activity that occurs rarely in small quantities can trigger this alert. Possible examples are browsing technical support or vendor URLs that are used very sparsely. A user who visits a new and unique web destination may trigger this alert when the activity is sparse. Web applications that generate URLs unique to a transaction may trigger this when they are used sparsely. Web domains can be excluded in cases such as these."
    ],
    "from": "now-45m",
    "id": "7e619698-64f3-4feb-b0f4-6e688b179845",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "packetbeat_rare_server_domain",
    "max_signals": 100,
    "name": "Unusual Network Destination Domain Name",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "17e68559-b274-4948-ad0b-f8415bb31126",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Packetbeat"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.249Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.039Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of a specified AWS Identity and Access Management (IAM) resource group. Deleting a resource group does not delete resources that are members of the group; it only deletes the group structure.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A resource group may be deleted by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Resource group deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "91365968-9a94-400b-85ce-0bc597caf27c",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS IAM Group Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteGroup and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/delete-group.html",
      "https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteGroup.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "867616ec-41e5-4edc-ada2-ab13ab45de8a",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1531",
            "name": "Account Access Removal",
            "reference": "https://attack.mitre.org/techniques/T1531/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.242Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.040Z",
    "created_by": "elastic",
    "description": "Identifies potential attempts to disable Security-Enhanced Linux (SELinux), which is a Linux kernel security feature to support access control policies. Adversaries may disable security tools to avoid possible detection of their tools and activities.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "07b23e9a-ae2c-4be9-b576-a47942a98a95",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Potential Disabling of SELinux",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:setenforce and process.args:0",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "eb9eb8ba-a983-41d9-9c93-a1c05112ca5e",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.262Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.034Z",
    "created_by": "elastic",
    "description": "Identifies Windows processes that do not usually use the network but have unexpected network activity, which can indicate command-and-control, lateral movement, persistence, or data exfiltration activity. A process with unusual network activity can denote process exploitation or injection, where the process is used to run persistence mechanisms that allow a malicious actor remote access or control of the host, data exfiltration, and execution of unauthorized network applications.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that rarely uses the network could trigger this alert."
    ],
    "from": "now-45m",
    "id": "16d4a02d-fe68-487d-bd36-3a8682f716ec",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_network_activity_ecs",
    "max_signals": 100,
    "name": "Unusual Windows Network Activity",
    "note": "### Investigating Unusual Network Activity ###\nDetection alerts from this rule indicate the presence of network activity from a Windows process for which network activity is very unusual.  Here are some possible avenues of investigation:\n- Consider the IP addresses, protocol and ports. Are these used by normal but infrequent network workflows? Are they expected or unexpected? \n- If the destination IP address is remote or external, does it associate with an expected domain, organization or geography? Note: avoid interacting directly with suspected malicious IP addresses.\n- Consider the user as identified by the username field. Is this network activity part of an expected workflow for the user who ran the program?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.\n- If you have file hash values in the event data, and you suspect malware, you can optionally run a search for the file hash to see if the file is identified as malware by anti-malware tools.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "ba342eb2-583c-439f-b04d-1fdd7c1417cc",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.251Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.036Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of PDF reader applications. These child processes are often launched via exploitation of PDF applications or social engineering.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "4edd2238-5ba3-4b7e-a5fa-84806cee0fcc",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Suspicious PDF Reader Child Process",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:(AcroRd32.exe or Acrobat.exe or FoxitPhantomPDF.exe or FoxitReader.exe) and process.name:(arp.exe or dsquery.exe or dsget.exe or gpresult.exe or hostname.exe or ipconfig.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or ping.exe or qprocess.exe or quser.exe or qwinsta.exe or reg.exe or sc.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or installutil.exe or Microsoft.Workflow.Compiler.exe or msbuild.exe or mshta.exe or msxsl.exe or odbcconf.exe or rcsi.exe or regsvr32.exe or xwizard.exe or atbroker.exe or forfiles.exe or schtasks.exe or regasm.exe or regsvcs.exe or cmd.exe or cscript.exe or powershell.exe or pwsh.exe or wmic.exe or wscript.exe or bitsadmin.exe or certutil.exe or ftp.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "53a26770-9cbd-40c5-8b57-61d01a325e14",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1204",
            "name": "User Execution",
            "reference": "https://attack.mitre.org/techniques/T1204/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.241Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.036Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to disable the iptables or firewall service in an attempt to affect how a host is allowed to receive or send network traffic.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "51e5e651-3dfd-4fb2-8686-6c2d27d6d30d",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Disable IPTables or Firewall",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:ufw and process.args:(allow or disable or reset) or  (((process.name:service and process.args:stop) or (process.name:chkconfig and process.args:off) or (process.name:systemctl and process.args:(disable or stop or kill))) and process.args:(firewalld or ip6tables or iptables))",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "125417b8-d3df-479f-8418-12d7e034fee3",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.248Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.000Z",
    "created_by": "elastic",
    "description": "Detects writing executable files that will be automatically launched by Adobe on launch.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "a2224633-83bd-444f-be6a-fc1edc915be1",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Adobe Hijack Persistence",
    "output_index": ".siem-signals-default",
    "query": "event.category:file and event.type:creation and file.path:(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\" or \"C:\\Program Files\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\") and not process.name:msiexec.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "2bf78aa2-9c56-48de-b139-f169bf99cf86",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1044",
            "name": "File System Permissions Weakness",
            "reference": "https://attack.mitre.org/techniques/T1044/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.204Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.047Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to modify an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to modify an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if Okta policies are regularly modified in your organization."
    ],
    "from": "now-6m",
    "id": "487a611c-d50c-40e5-b55c-9b95f9b349fc",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Modify Okta Policy",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:policy.lifecycle.update",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "6731fbf2-8f28-49ed-9ab9-9a918ceb5a45",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.264Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.015Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual Windows service, This can indicate execution of unauthorized services, malware, or persistence mechanisms. In corporate Windows environments, hosts do not generally run many rare or unique services. This job helps detect malware and persistence mechanisms that have been installed and run as a service.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."
    ],
    "from": "now-45m",
    "id": "df8b4f2c-b1c6-4c3c-83a3-9d89c3551476",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_service",
    "max_signals": 100,
    "name": "Unusual Windows Service",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "1781d055-5c66-4adf-9c71-fc0fa58338c7",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.217Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.051Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of a specified AWS Web Application Firewall (WAF) rule or rule group.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "WAF rules or rule groups may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Rule deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "3b50b579-a97b-4023-a7ed-2fb7bf1438a5",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS WAF Rule or Rule Group Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.module:aws and event.dataset:aws.cloudtrail and event.action:(DeleteRule or DeleteRuleGroup) and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/waf/delete-rule-group.html",
      "https://docs.aws.amazon.com/waf/latest/APIReference/API_waf_DeleteRuleGroup.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "5beaebc1-cc13-4bfc-9949-776f9e0dc318",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.268Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.055Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of an Amazon Elastic Compute Cloud (EC2) network access control list (ACL) or one of its ingress/egress entries.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Network ACL's may be deleted by a network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Network ACL deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "3c838ee4-3b3c-438d-8f0b-830e95a84811",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS EC2 Network Access Control List Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:(DeleteNetworkAcl or DeleteNetworkAclEntry) and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-network-acl.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAcl.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-network-acl-entry.html",
      "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAclEntry.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "8623535c-1e17-44e1-aa97-7a0699c3037d",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.270Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.030Z",
    "created_by": "elastic",
    "description": "Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."
    ],
    "from": "now-6m",
    "id": "29e755bd-b8b2-4c11-859f-0085e6a3649e",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Base16 or Base32 Encoding/Decoding Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(base16 or base32 or base32plain or base32hex)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "debff20a-46bc-4a4d-bae5-5cdd14222795",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1027/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.239Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.999Z",
    "created_by": "elastic",
    "description": "Strace runs in a privileged context and can be used to escape restrictive environments by instantiating a shell in order to elevate privileges or move laterally.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Strace is a dual-use tool that can be used for benign or malicious activity. Some normal use of this command may originate from developers or SREs engaged in debugging or system call tracing."
    ],
    "from": "now-6m",
    "id": "7ae7dc20-7785-4cb6-af65-9f6ca506fc7a",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Strace Process Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:strace",
    "references": ["https://en.wikipedia.org/wiki/Strace"],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "d6450d4e-81c6-46a3-bd94-079886318ed5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.207Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.032Z",
    "created_by": "elastic",
    "description": "Identifies when a terminal (tty) is spawned via Perl. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "bc08356c-e9fe-4b40-9338-f11c7f835fef",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Interactive Terminal Spawned via Perl",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:perl and process.args:(\"exec \\\"/bin/sh\\\";\" or \"exec \\\"/bin/dash\\\";\" or \"exec \\\"/bin/bash\\\";\")",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "05e5a668-7b51-4a67-93ab-e9af405c9ef3",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.239Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.034Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual web URL request from a Linux host, which can indicate malware delivery and execution. Wget and cURL are commonly used by Linux programs to download code and data. Most of the time, their usage is entirely normal. Generally, because they use a list of URLs, they repeatedly download from the same locations. However, Wget and cURL are sometimes used to deliver Linux exploit payloads, and threat actors use these tools to download additional software and code. For these reasons, unusual URLs can indicate unauthorized downloads or threat activity.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A new and unusual program or artifact download in the course of software upgrades, debugging, or troubleshooting could trigger this alert."
    ],
    "from": "now-45m",
    "id": "67012d6b-0af2-4ce1-879c-ba2d90962cbd",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "linux_anomalous_network_url_activity_ecs",
    "max_signals": 100,
    "name": "Unusual Linux Web Activity",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "52afbdc5-db15-485e-bc35-f5707f820c4c",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.253Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.037Z",
    "created_by": "elastic",
    "description": "Kernel modules are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This rule identifies attempts to remove a kernel module.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "There is usually no reason to remove modules, but some buggy modules require it. These can be exempted by username. Note that some Linux distributions are not built to support the removal of modules at all."
    ],
    "from": "now-6m",
    "id": "fa7e7f08-c750-40b4-a792-f4481431f46f",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Kernel Module Removal",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.args:((rmmod and sudo) or (modprobe and sudo and (\"--remove\" or \"-r\")))",
    "references": ["http://man7.org/linux/man-pages/man8/modprobe.8.html"],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "cd66a5af-e34b-4bb0-8931-57d0a043f2ef",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1215",
            "name": "Kernel Modules and Extensions",
            "reference": "https://attack.mitre.org/techniques/T1215/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.250Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.015Z",
    "created_by": "elastic",
    "description": "A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "e424ac08-012d-48ac-ac7e-b91b2160b6ea",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Sudoers File Modification",
    "output_index": ".siem-signals-default",
    "query": "event.category:file and event.type:change and file.path:/etc/sudoers",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "931e25a5-0f5e-4ae0-ba0d-9e94eff7e3a4",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1169",
            "name": "Sudo",
            "reference": "https://attack.mitre.org/techniques/T1169/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.219Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.973Z",
    "created_by": "elastic",
    "description": "The Filter Manager Control Program (fltMC.exe) binary may be abused by adversaries to unload a filter driver and evade defenses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "d1e98cbb-5ebf-41b2-83e1-de6e3d73a8c3",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Potential Evasion via Filter Manager",
    "output_index": ".siem-signals-default",
    "query": "event.code:1 and process.name:fltMC.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "06dceabf-adca-48af-ac79-ffdf4c3b1e9a",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1222",
            "name": "File and Directory Permissions Modification",
            "reference": "https://attack.mitre.org/techniques/T1222/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.161Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.970Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of SSH traffic from the Internet. SSH is commonly used by system administrators to remotely control a system using the command line shell. If it is exposed to the Internet, it should be done with strong security controls as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some network security policies allow SSH directly from the Internet but usage that is unfamiliar to server or network owners can be unexpected and suspicious. SSH services may be exposed directly to the Internet in some networks such as cloud environments. In such cases, only SSH gateways, bastions or jump servers may be expected expose SSH directly to the Internet and can be exempted from this rule. SSH may be required by some work-flows such as remote access and support for specialized software products and servers. Such work-flows are usually known and not unexpected."
    ],
    "from": "now-6m",
    "id": "4579abf7-dfd5-4bfc-b78c-8e7b7821f1a0",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "SSH (Secure Shell) from the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:22 or event.dataset:zeek.ssh) and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "ea0784f0-a4d7-4fea-ae86-4baaf27a6f17",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.159Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.972Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected an Adversary Behavior. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "96658704-6b74-468f-8c53-0e01c413acbe",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Adversary Behavior - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and (event.action:rules_engine_event or endgame.event_subtype_full:rules_engine_event)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "77a3c3df-8ec4-4da4-b758-878f551dee69",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.162Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.973Z",
    "created_by": "elastic",
    "description": "This rule detects events that may describe database traffic (MS SQL, Oracle, MySQL, and Postgresql) across the Internet. Databases should almost never be directly exposed to the Internet, as they are frequently targeted by threat actors to gain initial access to network resources.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Because these ports are in the ephemeral range, this rule may false under certain conditions such as when a NATed web server replies to a client which has used a port in the range by coincidence. In this case, such servers can be excluded if desired. Some cloud environments may use this port when VPNs or direct connects are not in use and database instances are accessed directly across the Internet."
    ],
    "from": "now-6m",
    "id": "8e644028-b883-4d82-8730-46a69edf9cc4",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "SQL Traffic to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(1433 or 1521 or 3306 or 5432) or event.dataset:zeek.mysql) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "139c7458-566a-410c-a5cd-f80238d6a5cd",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.162Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.974Z",
    "created_by": "elastic",
    "description": "Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Adversaries may use these binaries to 'live off the land' and execute malicious files that could bypass application allowlists and signature validation.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "acf8bbee-38ee-4f99-a508-a98fa9eac1ed",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Connection via Signed Binary",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:(expand.exe or extrac.exe or ieexec.exe or makecab.exe) and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "63e65ec3-43b1-45b0-8f2d-45b34291dc44",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.163Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.975Z",
    "created_by": "elastic",
    "description": "Identifies use of wmic.exe for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "5187dd95-7c94-4834-beb7-b1b6ecb23af6",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Volume Shadow Copy Deletion via WMIC",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:WMIC.exe and process.args:(delete and shadowcopy)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "dc9c1f74-dac3-48e3-b47f-eb79db358f57",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.164Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.979Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented an Exploit. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "ab3dffe5-269c-4c2f-bd47-10c0f78d5ca6",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Exploit - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:exploit_event or endgame.event_subtype_full:exploit_event)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "2863ffeb-bf77-44dd-b7a5-93ef94b72036",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.164Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.978Z",
    "created_by": "elastic",
    "description": "Identifies use of vssadmin.exe for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "54ccf8ed-3028-4f2a-884b-9fb988034d68",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Volume Shadow Copy Deletion via VssAdmin",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:vssadmin.exe and process.args:(delete and shadows)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "b5ea4bfe-a1b2-421f-9d47-22a75a6f2921",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery",
            "reference": "https://attack.mitre.org/techniques/T1490/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.166Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.982Z",
    "created_by": "elastic",
    "description": "Identifies the native Windows tools regsvr32.exe and regsvr64.exe making a network connection. This may be indicative of an attacker bypassing allowlists or running arbitrary scripts via a signed Microsoft binary.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security testing may produce events like this. Activity of this kind performed by non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "663e0d27-72cf-4447-921b-68a1524849ce",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Connection via Regsvr",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:(regsvr32.exe or regsvr64.exe) and not destination.ip:(10.0.0.0/8 or 169.254.169.254 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "fb02b8d3-71ee-4af1-bacd-215d23f17efa",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1117",
            "name": "Regsvr32",
            "reference": "https://attack.mitre.org/techniques/T1117/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1117",
            "name": "Regsvr32",
            "reference": "https://attack.mitre.org/techniques/T1117/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.167Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.980Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Ransomware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "2c3cf985-4e69-4203-a906-7e7531be519b",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Ransomware - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:ransomware_event or endgame.event_subtype_full:ransomware_event)",
    "references": [],
    "risk_score": 99,
    "risk_score_mapping": [],
    "rule_id": "8cb4f625-7743-4dfb-ae1b-ad92be9df7bd",
    "severity": "critical",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.168Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.981Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Credential Dumping. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "5e7bb47c-417e-4068-8fea-ced870d36964",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Credential Dumping - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "571afc56-5ed9-465d-a2a9-045f099f6e7e",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.169Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.982Z",
    "created_by": "elastic",
    "description": "Identifies use of sc.exe to create, modify, or start services on remote hosts. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "5c13c077-335f-48f4-a543-504ea3d637e0",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Local Service Commands",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:sc.exe and process.args:(config or create or failure or start)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "e8571d5f-bea1-46c2-9f56-998de2d3ed95",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.168Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.981Z",
    "created_by": "elastic",
    "description": "Identifies attempts to clear Windows event log stores. This is often done by attackers in an attempt to evade detection or destroy forensic evidence on a system.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "5987ccd4-2589-4601-a191-eb30a6931e40",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Clearing Windows Event Logs",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:wevtutil.exe and process.args:cl or process.name:powershell.exe and process.args:Clear-EventLog",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "d331bbe2-6db4-4941-80a5-8270db72eb61",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host",
            "reference": "https://attack.mitre.org/techniques/T1070/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.170Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.978Z",
    "created_by": "elastic",
    "description": "This rule detects events that may describe network events of proxy use to the Internet. It includes popular HTTP proxy ports and SOCKS proxy ports. Typically, environments will use an internal IP address for a proxy server. It can also be used to circumvent network controls and detection mechanisms.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some proxied applications may use these ports but this usually occurs in local traffic using private IPs which this rule does not match. Proxies are widely used as a security technology but in enterprise environments this is usually local traffic which this rule does not match. If desired, internet proxy services using these ports can be added to allowlists. Some screen recording applications may use these ports. Proxy port activity involving an unusual source or destination may be more suspicious. Some cloud environments may use this port when VPNs or direct connects are not in use and cloud instances are accessed across the Internet. Because these ports are in the ephemeral range, this rule may false under certain conditions such as when a NATed web server replies to a client which has used a port in the range by coincidence. In this case, such servers can be excluded if desired."
    ],
    "from": "now-6m",
    "id": "4826cc56-4e5c-46cc-8187-7f0f56cd0aa3",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Proxy Port Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(1080 or 3128 or 8080) or event.dataset:zeek.socks) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "ad0e5e75-dd89-4875-8d0a-dfdc1828b5f3",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.170Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.984Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious parent child process relationship with cmd.exe descending from PowerShell.exe.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "ebae833d-964e-46b6-8e80-6ccc15ff89d7",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "PowerShell spawning Cmd",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:powershell.exe and process.name:cmd.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "0f616aee-8161-4120-857e-742366f5eeb3",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1086",
            "name": "PowerShell",
            "reference": "https://attack.mitre.org/techniques/T1086/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.171Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.983Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Permission Theft. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "2c0d8291-d3ff-4052-b2ab-02fd10f86d88",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Permission Theft - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:token_protection_event or endgame.event_subtype_full:token_protection_event)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "c3167e1b-f73c-41be-b60b-87f4df707fe3",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.172Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.986Z",
    "created_by": "elastic",
    "description": "A netcat process is engaging in network activity on a Linux host. Netcat is often used as a persistence mechanism by exporting a reverse shell or by serving a shell on a listening port. Netcat is also sometimes used for data exfiltration.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Netcat is a dual-use tool that can be used for benign or malicious activity. Netcat is included in some Linux distributions so its presence is not necessarily suspicious. Some normal use of this program, while uncommon, may originate from scripts, automation tools, and frameworks."
    ],
    "from": "now-6m",
    "id": "543bb2f2-cc6b-4deb-9b19-74a8c8c89fbe",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Netcat Network Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:(access or connection or start) and process.name:(nc or ncat or netcat or netcat.openbsd or netcat.traditional)",
    "references": [
      "http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet",
      "https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf",
      "https://en.wikipedia.org/wiki/Netcat"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "adb961e0-cb74-42a0-af9e-29fc41f88f5f",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.177Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.983Z",
    "created_by": "elastic",
    "description": "Identifies processes running in a temporary folder. This is sometimes done by adversaries to hide malware.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Build systems, like Jenkins, may start processes in the `/tmp` directory. These can be exempted by name or by username."
    ],
    "from": "now-6m",
    "id": "fb1d76c4-098c-4806-932f-b2368346cee3",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Unusual Process Execution - Temp",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.working_directory:/tmp",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "df959768-b0c9-4d45-988c-5606a2be8e5a",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.177Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.987Z",
    "created_by": "elastic",
    "description": "Identifies network activity from unexpected system applications. This may indicate adversarial activity as these applications are often leveraged by adversaries to execute code and evade detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "69e56518-21f5-44c6-8eea-d437301634a7",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Unusual Process Network Connection",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:(Microsoft.Workflow.Compiler.exe or bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or odbcconf.exe or rcsi.exe or xwizard.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "610949a1-312f-4e04-bb55-3a79b8c95267",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.178Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.985Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Malware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "dbbfbfde-e1ea-4949-a4e4-65e35c1f4fc6",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Malware - Detected - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:file_classification_event or endgame.event_subtype_full:file_classification_event)",
    "references": [],
    "risk_score": 99,
    "risk_score_mapping": [],
    "rule_id": "0a97b20f-4144-49ea-be32-b540ecc445de",
    "severity": "critical",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.180Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.994Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started after being renamed. This is uncommon behavior and may indicate an attempt to run unnoticed or undetected.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "46dfeb4f-de33-4a08-91c0-381f1615a4d2",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Microsoft Build Engine Using an Alternate Name",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and (pe.original_file_name:MSBuild.exe or winlog.event_data.OriginalFileName:MSBuild.exe) and not process.name: MSBuild.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae4",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1036",
            "name": "Masquerading",
            "reference": "https://attack.mitre.org/techniques/T1036/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.179Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.985Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of Microsoft Outlook. These child processes are often associated with spear phishing activity.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "b99db37f-67fa-4f60-a4c9-ff2de4386dcf",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Suspicious MS Outlook Child Process",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:outlook.exe and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or  bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "32f4675e-6c49-4ace-80f9-97c9259dca2e",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.181Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.001Z",
    "created_by": "elastic",
    "description": "A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates. An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "f4e163c0-64ae-4289-a4b7-76cf11c85386",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall)",
    "output_index": ".siem-signals-default",
    "query": "event.provider:\"Microsoft-Windows-Audit-CVE\" and message:\"[CVE-2020-0601]\"",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "56557cde-d923-4b88-adee-c61b3f3b5dc3",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1116",
            "name": "Code Signing",
            "reference": "https://attack.mitre.org/techniques/T1116/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.182Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.987Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RPC traffic from the Internet. RPC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "bbe2e2d3-31c0-41cb-bcac-751865cad99a",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "RPC (Remote Procedure Call) from the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:135 or event.dataset:zeek.dce_rpc) and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "143cb236-0956-4f42-a706-814bcaa0cf5a",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.182Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.990Z",
    "created_by": "elastic",
    "description": "Identifies MsBuild.exe making outbound network connections. This may indicate adversarial activity as MsBuild is often leveraged by adversaries to execute code and evade detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "d98e7480-2931-4602-bafe-f07eb055fd04",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "MsBuild Making Network Connections",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:MSBuild.exe and not destination.ip:(127.0.0.1 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "0e79980b-4250-4a50-a509-69294c14e84b",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.183Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.988Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Permission Theft. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "134335c5-bc1d-4e48-9d53-30d54faa8f09",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Permission Theft - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:token_protection_event or endgame.event_subtype_full:token_protection_event)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "453f659e-0429-40b1-bfdb-b6957286e04b",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.185Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.991Z",
    "created_by": "elastic",
    "description": "A Socat process is running on a Linux host. Socat is often used as a persistence mechanism by exporting a reverse shell, or by serving a shell on a listening port. Socat is also sometimes used for lateral movement.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Socat is a dual-use tool that can be used for benign or malicious activity. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. Usage by web servers is more likely to be suspicious."
    ],
    "from": "now-6m",
    "id": "45e5affe-b43a-4ef2-8dd1-f9aea7cfc088",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Socat Process Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:socat and not process.args:-V",
    "references": [
      "https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "cd4d5754-07e1-41d4-b9a5-ef4ea6a0a126",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.184Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.005Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a rare and unusual URL that indicates unusual web browsing activity. This can be due to initial access, persistence, command-and-control, or exfiltration activity. For example, in a strategic web compromise or watering hole attack, when a trusted website is compromised to target a particular sector or organization, targeted users may receive emails with uncommon URLs for trusted websites. These URLs can be used to download and run a payload. When malware is already running, it may send requests to uncommon URLs on trusted websites the malware uses for command-and-control communication. When rare URLs are observed being requested for a local web server by a remote source, these can be due to web scanning, enumeration or attack traffic, or they can be due to bots and web scrapers which are part of common Internet background traffic.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Web activity that occurs rarely in small quantities can trigger this alert. Possible examples are browsing technical support or vendor URLs that are used very sparsely. A user who visits a new and unique web destination may trigger this alert when the activity is sparse. Web applications that generate URLs unique to a transaction may trigger this when they are used sparsely. Web domains can be excluded in cases such as these."
    ],
    "from": "now-45m",
    "id": "098b1445-898c-4ed2-b932-b6a3a61e925e",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "packetbeat_rare_urls",
    "max_signals": 100,
    "name": "Unusual Web Request",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "91f02f01-969f-4167-8f55-07827ac3acc9",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Packetbeat"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.186Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.996Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, was started by a script or the Windows command interpreter. This behavior is unusual and is sometimes used by malicious payloads.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "1f64ae73-a888-4d20-bd13-8a9fe6f95ef0",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Microsoft Build Engine Started by a Script Process",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type: start and process.name:MSBuild.exe and process.parent.name:(cmd.exe or powershell.exe or cscript.exe or wscript.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae2",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.187Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.990Z",
    "created_by": "elastic",
    "description": "The Linux mknod program is sometimes used in the command payload of a remote command injection (RCI) and other exploits. It is used to export a command shell when the traditional version of netcat is not available to the payload.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Mknod is a Linux system program. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. Usage by web servers is more likely to be suspicious."
    ],
    "from": "now-6m",
    "id": "99d796f4-a2e8-4128-95c7-cdb12261654f",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Mknod Process Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:mknod",
    "references": [
      "https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "61c31c14-507f-4627-8c31-072556b89a9c",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.188Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.989Z",
    "created_by": "elastic",
    "description": "Identifies unusual instances of rundll32.exe making outbound network connections. This may indicate adversarial activity and may identify malicious DLLs.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "b2b2dfc6-b612-4cf6-baad-61cd927d8817",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Unusual Network Connection via RunDLL32",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:rundll32.exe and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or 127.0.0.0/8)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "52aaab7b-b51c-441a-89ce-4387b3aea886",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1085",
            "name": "Rundll32",
            "reference": "https://attack.mitre.org/techniques/T1085/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.189Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.986Z",
    "created_by": "elastic",
    "description": "Identifies mshta.exe making a network connection. This may indicate adversarial activity as mshta.exe is often leveraged by adversaries to execute malicious scripts and evade detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "def267b5-24ef-4f90-b603-b86ed705cf1d",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Connection via Mshta",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:mshta.exe",
    "references": [
      "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "a4ec1382-4557-452b-89ba-e413b22ed4b8",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1170",
            "name": "Mshta",
            "reference": "https://attack.mitre.org/techniques/T1170/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.189Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.009Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a rare and unusual user agent indicating web browsing activity by an unusual process other than a web browser. This can be due to persistence, command-and-control, or exfiltration activity. Uncommon user agents coming from remote sources to local destinations are often the result of scanners, bots, and web scrapers, which are part of common Internet background traffic. Much of this is noise, but more targeted attacks on websites using tools like Burp or SQLmap can sometimes be discovered by spotting uncommon user agents. Uncommon user agents in traffic from local sources to remote destinations can be any number of things, including harmless programs like weather monitoring or stock-trading programs. However, uncommon user agents from local sources can also be due to malware or scanning activity.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Web activity that is uncommon, like security scans, may trigger this alert and may need to be excluded. A new or rarely used program that calls web services may trigger this alert."
    ],
    "from": "now-45m",
    "id": "1a08635d-6f40-4309-8d61-8692c0b227e8",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "packetbeat_rare_user_agent",
    "max_signals": 100,
    "name": "Unusual Web User Agent",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "91f02f01-969f-4167-8d77-07827ac4cee0",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Packetbeat"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.196Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.008Z",
    "created_by": "elastic",
    "description": "Identifies the SYSTEM account using the Net utility. The Net utility is a component of the Windows operating system. It is used in command line operations for control of users, groups, services, and network connections.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "3e81e18d-ac7e-49b1-bbf4-765b37750108",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Net command via SYSTEM account",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and (process.name:net.exe or process.name:net1.exe and not process.parent.name:net.exe) and user.name:SYSTEM",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "2856446a-34e6-435b-9fb5-f8f040bfa7ed",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1087",
            "name": "Account Discovery",
            "reference": "https://attack.mitre.org/techniques/T1087/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.197Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.002Z",
    "created_by": "elastic",
    "description": "Identifies loadable kernel module errors, which are often indicative of potential persistence attempts.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security tools and device drivers may run these programs in order to load legitimate kernel modules. Use of these programs by ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "1fd2116b-a290-405c-82a5-1cbfcda37a7e",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Persistence via Kernel Module Modification",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(insmod or kmod or modprobe or rmod)",
    "references": [
      "https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "81cc58f5-8062-49a2-ba84-5cc4b4d31c40",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1215",
            "name": "Kernel Modules and Extensions",
            "reference": "https://attack.mitre.org/techniques/T1215/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.198Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.008Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, started a PowerShell script or the Visual C# Command Line Compiler. This technique is sometimes used to deploy a malicious payload using the Build Engine.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual. If a build system triggers this rule it can be exempted by process, user or host name."
    ],
    "from": "now-6m",
    "id": "a7775948-31f5-461c-830f-42d41cff86b3",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Microsoft Build Engine Started an Unusual Process",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.parent.name:MSBuild.exe and process.name:(csc.exe or iexplore.exe or powershell.exe)",
    "references": [
      "https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae6",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1500",
            "name": "Compile After Delivery",
            "reference": "https://attack.mitre.org/techniques/T1500/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.200Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.997Z",
    "created_by": "elastic",
    "description": "Identifies cmd.exe making a network connection. Adversaries could abuse cmd.exe to download or execute malware from a remote URL.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Administrators may use the command prompt for regular administrative tasks. It's important to baseline your environment for network connections being made from the command prompt to determine any abnormal use of this tool."
    ],
    "from": "now-6m",
    "id": "f3512a7c-8ae5-4a4e-9429-6ec5deb7dc12",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Command Prompt Network Connection",
    "output_index": ".siem-signals-default",
    "query": "event.category:network and event.type:connection and process.name:cmd.exe and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "89f9a4b0-9f8f-4ee0-8823-c4751a6d6696",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1105",
            "name": "Remote File Copy",
            "reference": "https://attack.mitre.org/techniques/T1105/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.200Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.006Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, created a thread in another process. This technique is sometimes used to evade detection or elevate privileges.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "c65364bb-cc63-4710-8374-dc6d7b54e7e6",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Process Injection by the Microsoft Build Engine",
    "output_index": ".siem-signals-default",
    "query": "process.name:MSBuild.exe and event.action:\"CreateRemoteThread detected (rule: CreateRemoteThread)\"",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae9",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1055",
            "name": "Process Injection",
            "reference": "https://attack.mitre.org/techniques/T1055/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1055",
            "name": "Process Injection",
            "reference": "https://attack.mitre.org/techniques/T1055/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.199Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.000Z",
    "created_by": "elastic",
    "description": "Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over the DNS protocol to circumvent firewalls, network security groups, and network access lists while evading detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Normal use of Iodine is uncommon apart from security testing and research. Use by non-security engineers is very uncommon."
    ],
    "from": "now-6m",
    "id": "1d05d447-5ebf-47bb-8eeb-3baf582e64f1",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Potential DNS Tunneling via Iodine",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(iodine or iodined)",
    "references": ["https://code.kryo.se/iodine/"],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "041d4d41-9589-43e2-ba13-5680af75ebc2",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.203Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.011Z",
    "created_by": "elastic",
    "description": "Windows contains accessibility features that may be launched with a key combination before a user has logged in. An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "53671d49-46fe-4643-b002-e6c2aadbf42b",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Potential Modification of Accessibility Binaries",
    "output_index": ".siem-signals-default",
    "query": "event.code:1 and process.parent.name:winlogon.exe and process.name:(atbroker.exe or displayswitch.exe or magnify.exe or narrator.exe or osk.exe or sethc.exe or utilman.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "7405ddf1-6c8e-41ce-818f-48bea6bcaed8",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1015",
            "name": "Accessibility Features",
            "reference": "https://attack.mitre.org/techniques/T1015/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1015",
            "name": "Accessibility Features",
            "reference": "https://attack.mitre.org/techniques/T1015/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.221Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.014Z",
    "created_by": "elastic",
    "description": "A machine learning job detected an unusual remote desktop protocol (RDP) username, which can indicate account takeover or credentialed persistence using compromised accounts. RDP attacks, such as BlueKeep, also tend to use unusual usernames.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Uncommon username activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."
    ],
    "from": "now-45m",
    "id": "0185753d-3995-442d-87ed-8ca62720da4b",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_rare_user_type10_remote_login",
    "max_signals": 100,
    "name": "Unusual Windows Remote User",
    "note": "### Investigating an Unusual Windows User ###\nDetection alerts from this rule indicate activity for a rare and unusual Windows RDP (remote desktop) user. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is the user part of a group who normally logs into Windows hosts using RDP (remote desktop protocol)? Is this logon activity part of an expected workflow for the user? \n- Consider the source of the login. If the source is remote, could this be related to occasional troubleshooting or support activity by a vendor or an employee working remotely?",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "1781d055-5c66-4adf-9e93-fc0fa69550c9",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.217Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.047Z",
    "created_by": "elastic",
    "description": "Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if Oyour organization's Okta network zones are regularly modified."
    ],
    "from": "now-6m",
    "id": "80b220ea-2bf7-415f-8897-105adff64492",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Modify Okta Network Zone",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:(zone.update or zone.deactivate or zone.delete or network_zone.rule.disabled or zone.remove_blacklist)",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "e48236ca-b67a-4b4e-840c-fdc7782bc0c3",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.266Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.028Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to clear the bash command line history in an attempt to evade detection or forensic investigations.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "e272adae-5e17-4b3c-baac-cf0672b4ecef",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "lucene",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Deletion of Bash Command Line History",
    "output_index": ".siem-signals-default",
    "query": "event.category:process AND event.type:(start or process_started) AND process.name:rm AND process.args:/\\/(home\\/.{1,255}|root)\\/\\.bash_history/",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "7bcbb3ac-e533-41ad-a612-d6c3bf666aba",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1146",
            "name": "Clear Command History",
            "reference": "https://attack.mitre.org/techniques/T1146/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.235Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.030Z",
    "created_by": "elastic",
    "description": "An instance of MSBuild, the Microsoft Build Engine, loaded DLLs (dynamically linked libraries) responsible for Windows credential management. This technique is sometimes used for credential dumping.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "95922a94-9301-404c-9439-02d35f1b9cc9",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Microsoft Build Engine Loading Windows Credential Libraries",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:change and (winlog.event_data.OriginalFileName:(vaultcli.dll or SAMLib.DLL) or dll.name:(vaultcli.dll or SAMLib.DLL)) and process.name: MSBuild.exe",
    "references": [],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae5",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1003",
            "name": "Credential Dumping",
            "reference": "https://attack.mitre.org/techniques/T1003/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.240Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.029Z",
    "created_by": "elastic",
    "description": "Malware or other files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "d845dddd-fdfd-42dc-8d37-e65d44ed7cdf",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "File Deletion via Shred",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:shred and process.args:(\"-u\" or \"--remove\" or \"-z\" or \"--zero\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "a1329140-8de3-4445-9f87-908fb6d824f4",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.232Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.017Z",
    "created_by": "elastic",
    "description": "A machine learning job detected a PowerShell script with unusual data characteristics, such as obfuscation, that may be a characteristic of malicious PowerShell script text blocks.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Certain kinds of security testing may trigger this alert. PowerShell scripts that use high levels of obfuscation or have unusual script block payloads may trigger this alert."
    ],
    "from": "now-45m",
    "id": "2bbc8736-ebad-4f00-a392-22a634fe014f",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_script",
    "max_signals": 100,
    "name": "Suspicious Powershell Script",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "1781d055-5c66-4adf-9d60-fc0fa58337b6",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.219Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.997Z",
    "created_by": "elastic",
    "description": "Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (hh.exe).",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "The HTML Help executable program (hh.exe) runs whenever a user clicks a compiled help (.chm) file or menu item that opens the help file inside the Help Viewer. This is not always malicious, but adversaries may abuse this technology to conceal malicious code."
    ],
    "from": "now-6m",
    "id": "5397ba68-b8f4-4ba1-ac27-a98f7570bd1e",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Process Activity via Compiled HTML File",
    "output_index": ".siem-signals-default",
    "query": "event.code:1 and process.name:hh.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "e3343ab9-4245-4715-b344-e11c56b0a47f",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.215Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.027Z",
    "created_by": "elastic",
    "description": "An adversary may add the setuid bit to a file or directory in order to run a file with the privileges of the owning user. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid bit to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "ce067c1a-8b41-44b7-bd4b-f5e7a29114e6",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "lucene",
    "license": "Elastic License",
    "max_signals": 33,
    "name": "Setuid Bit Set via chmod",
    "output_index": ".siem-signals-default",
    "query": "event.category:process AND event.type:(start or process_started) AND process.name:chmod AND process.args:(u+s OR /4[0-9]{3}/) AND NOT user.name:root",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "8a1b0278-0f9a-487d-96bd-d4833298e87a",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid",
            "reference": "https://attack.mitre.org/techniques/T1166/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.231Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.014Z",
    "created_by": "elastic",
    "description": "Identifies Linux processes that do not usually use the network but have unexpected network activity, which can indicate command-and-control, lateral movement, persistence, or data exfiltration activity. A process with unusual network activity can denote process exploitation or injection, where the process is used to run persistence mechanisms that allow a malicious actor remote access or control of the host, data exfiltration, and execution of unauthorized network applications.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-45m",
    "id": "9f7760c5-3b20-45a9-83f3-3f0a6a8314a4",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "linux_anomalous_network_activity_ecs",
    "max_signals": 100,
    "name": "Unusual Linux Network Activity",
    "note": "### Investigating Unusual Network Activity ###\nDetection alerts from this rule indicate the presence of network activity from a Linux process for which network activity is rare and unusual.  Here are some possible avenues of investigation:\n- Consider the IP addresses and ports. Are these used by normal but infrequent network workflows? Are they expected or unexpected? \n- If the destination IP address is remote or external, does it associate with an expected domain, organization or geography? Note: avoid interacting directly with suspected malicious IP addresses.\n- Consider the user as identified by the username field. Is this network activity part of an expected workflow for the user who ran the program?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business or maintenance process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "52afbdc5-db15-485e-bc24-f5707f820c4b",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.221Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.045Z",
    "created_by": "elastic",
    "description": "An adversary may attempt to assign administrator privileges to an Okta group in order to assign additional permissions to compromised user accounts.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Consider adding exceptions to this rule to filter false positives if administrator privileges are regularly assigned to Okta groups in your organization."
    ],
    "from": "now-6m",
    "id": "bf4ca222-d90a-4218-b203-248793315b96",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Administrator Privileges Assigned to Okta Group",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:group.privilege.grant",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "b8075894-0b62-46e5-977c-31275da34419",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1098",
            "name": "Account Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1098/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.256Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.051Z",
    "created_by": "elastic",
    "description": "Identifies the creation of a group in AWS Identity and Access Management (IAM). Groups specify permissions for multiple users. Any user in a group automatically has the permissions that are assigned to the group.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A group may be created by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Group creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "3f16619e-67dc-497b-9191-21d6c7e8e6eb",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS IAM Group Creation",
    "output_index": ".siem-signals-default",
    "query": "event.action:CreateGroup and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/create-group.html",
      "https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateGroup.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "169f3a93-efc7-4df2-94d6-0d9438c310d1",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1108",
            "name": "Redundant Access",
            "reference": "https://attack.mitre.org/techniques/T1108/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.265Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.031Z",
    "created_by": "elastic",
    "description": "Identifies that an Amazon Relational Database Service (RDS) cluster or instance has been stopped.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Valid clusters or instances may be stopped by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Cluster or instance stoppages from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "eb90872a-f33c-4114-a52a-08764dabcfb1",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS RDS Instance/Cluster Stoppage",
    "output_index": ".siem-signals-default",
    "query": "event.action:(StopDBCluster or StopDBInstance) and event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/stop-db-cluster.html",
      "https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_StopDBCluster.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/stop-db-instance.html",
      "https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_StopDBInstance.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "ecf2b32c-e221-4bd4-aa3b-c7d59b3bc01d",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0040",
          "name": "Impact",
          "reference": "https://attack.mitre.org/tactics/TA0040/"
        },
        "technique": [
          {
            "id": "T1489",
            "name": "Service Stop",
            "reference": "https://attack.mitre.org/techniques/T1489/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.237Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.049Z",
    "created_by": "elastic",
    "description": "Identifies the execution of commands and scripts via System Manager. Execution methods such as RunShellScript, RunPowerShellScript, and alike can be abused by an authenticated attacker to install a backdoor or to interact with a compromised instance via reverse-shell using system only commands.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Suspicious commands from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "71083d80-dc78-443c-8beb-a56883494548",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS Execution via System Manager",
    "output_index": ".siem-signals-default",
    "query": "event.module:aws and event.dataset:aws.cloudtrail and event.provider:ssm.amazonaws.com and event.action:SendCommand and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-plugins.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "37b211e8-4e2f-440f-86d8-06cc8f158cfa",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1064",
            "name": "Scripting",
            "reference": "https://attack.mitre.org/techniques/T1064/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1086",
            "name": "PowerShell",
            "reference": "https://attack.mitre.org/techniques/T1086/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.264Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.036Z",
    "created_by": "elastic",
    "description": "Loadable Kernel Modules (or LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This identifies attempts to enumerate information about a kernel module.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security tools and device drivers may run these programs in order to enumerate kernel modules. Use of these programs by ordinary users is uncommon. These can be exempted by process name or username."
    ],
    "from": "now-6m",
    "id": "77b8912b-1e35-4c5c-bd43-c91248ba2d8f",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Enumeration of Kernel Modules",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.args:(kmod and list and sudo or sudo and (depmod or lsmod or modinfo))",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "2d8043ed-5bda-4caf-801c-c1feb7410504",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1082",
            "name": "System Information Discovery",
            "reference": "https://attack.mitre.org/techniques/T1082/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.254Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.054Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of various Amazon Simple Storage Service (S3) bucket configuration components.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Bucket components may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Bucket component deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "af27995a-e4ed-4909-a818-b43ec7c02fd1",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS S3 Bucket Configuration Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:(DeleteBucketPolicy or DeleteBucketReplication or DeleteBucketCors or DeleteBucketEncryption or DeleteBucketLifecycle) and event.dataset:aws.cloudtrail and event.provider:s3.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketPolicy.html",
      "https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketReplication.html",
      "https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketCors.html",
      "https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketEncryption.html",
      "https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketLifecycle.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "227dc608-e558-43d9-b521-150772250bae",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host",
            "reference": "https://attack.mitre.org/techniques/T1070/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.269Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.053Z",
    "created_by": "elastic",
    "description": "Identifies attempts to login to AWS as the root user without using multi-factor authentication (MFA). Amazon AWS best practices indicate that the root user should be protected by MFA.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some organizations allow login with the root user without MFA, however this is not considered best practice by AWS and increases the risk of compromised credentials."
    ],
    "from": "now-60m",
    "id": "faef7b74-74c7-420e-99ef-5493a28b2c16",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS Root Login Without MFA",
    "output_index": ".siem-signals-default",
    "query": "event.module:aws and event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:ConsoleLogin and aws.cloudtrail.user_identity.type:Root and aws.cloudtrail.console_login.additional_eventdata.mfa_used:false and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "bc0c6f0d-dab0-47a3-b135-0925f0a333bc",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1078",
            "name": "Valid Accounts",
            "reference": "https://attack.mitre.org/techniques/T1078/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.267Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.048Z",
    "created_by": "elastic",
    "description": "This rule detects when Okta ThreatInsight identifies a request from a malicious IP address. Investigating requests from IP addresses identified as malicious by Okta ThreatInsight can help security teams monitor for and respond to credential based attacks against their organization, such as brute force and password spraying attacks.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "54b7f835-ee6a-4fae-8c1a-0006a7f07cb8",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Threat Detected by Okta ThreatInsight",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:security.threat.detected",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "6885d2ae-e008-4762-b98a-e8e1cd3a81e9",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.267Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.029Z",
    "created_by": "elastic",
    "description": "An adversary may deactivate multi-factor authentication (MFA) for an Okta user account in order to weaken the authentication requirements for the account.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "If the behavior of deactivating MFA for Okta user accounts is expected, consider adding exceptions to this rule to filter false positives."
    ],
    "from": "now-6m",
    "id": "6d0f7584-cf4c-49ea-8cf0-8f5205f265a7",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Deactivate MFA for Okta User Account",
    "output_index": ".siem-signals-default",
    "query": "event.module:okta and event.dataset:okta.system and event.action:user.mfa.factor.deactivate",
    "references": [
      "https://developer.okta.com/docs/reference/api/system-log/",
      "https://developer.okta.com/docs/reference/api/event-types/"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "cd89602e-9db0-48e3-9391-ae3bf241acd8",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Okta"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1098",
            "name": "Account Manipulation",
            "reference": "https://attack.mitre.org/techniques/T1098/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.233Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.038Z",
    "created_by": "elastic",
    "description": "Identifies processes started from atypical folders in the file system, which might indicate malware execution or persistence mechanisms. In corporate Windows environments, software installation is centrally managed and it is unusual for programs to be executed from user or temporary directories. Processes executed from these locations can denote that a user downloaded software directly from the Internet or a malicious script or macro executed malware.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A new and unusual program or artifact download in the course of software upgrades, debugging, or troubleshooting could trigger this alert. Users downloading and running programs from unusual locations, such as temporary directories, browser caches, or profile paths could trigger this alert."
    ],
    "from": "now-45m",
    "id": "e0e66278-c2ee-4d32-9d2f-c6e616647917",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_path_activity_ecs",
    "max_signals": 100,
    "name": "Unusual Windows Path Activity",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "445a342e-03fb-42d0-8656-0367eb2dead5",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.257Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.048Z",
    "created_by": "elastic",
    "description": "Identifies the creation of an AWS log trail that specifies the settings for delivery of log data.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Trail creations may be made by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "eac5d090-8bdc-4cb5-9c86-0452a1a7f46d",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudTrail Log Created",
    "output_index": ".siem-signals-default",
    "query": "event.action:CreateTrail and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_CreateTrail.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/create-trail.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "594e0cbf-86cc-45aa-9ff7-ff27db27d3ed",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0009",
          "name": "Collection",
          "reference": "https://attack.mitre.org/tactics/TA0009/"
        },
        "technique": [
          {
            "id": "T1530",
            "name": "Data from Cloud Storage Object",
            "reference": "https://attack.mitre.org/techniques/T1530/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.265Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.009Z",
    "created_by": "elastic",
    "description": "Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."
    ],
    "from": "now-45m",
    "id": "3d47403e-9969-4251-8722-b7d53a726dcb",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "rare_process_by_host_windows_ecs",
    "max_signals": 100,
    "name": "Unusual Process For a Windows Host",
    "note": "### Investigating an Unusual Windows Process ###\nDetection alerts from this rule indicate the presence of a Windows process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process metadata like the values of the Company, Description and Product fields which may indicate whether the program is associated with an expected software vendor or package. \n- Examine arguments and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.\n- If you have file hash values in the event data, and you suspect malware, you can optionally run a search for the file hash to see if the file is identified as malware by anti-malware tools. ",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "6d448b96-c922-4adb-b51c-b767f1ea5b76",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.201Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:18.168Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of an AWS CloudWatch alarm. An adversary may delete alarms in an attempt to evade defenses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Alarm deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "4b87412b-279a-4d94-8046-e35ac62d7721",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudWatch Alarm Deletion",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteAlarms and event.dataset:aws.cloudtrail and event.provider:monitoring.amazonaws.com and event.outcome:success",
    "references": [
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudwatch/delete-alarms.html",
      "https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_DeleteAlarms.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "f772ec8a-e182-483c-91d2-72058f76a44c",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:18.342Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.026Z",
    "created_by": "elastic",
    "description": "Searches for rare processes running on multiple hosts in an entire fleet or network. This reduces the detection of false positives since automated maintenance processes usually only run occasionally on a single machine but are common to all or many hosts in a fleet.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."
    ],
    "from": "now-45m",
    "id": "7f19c4e7-0a03-43c7-81cc-f705f5acd858",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "windows_anomalous_process_all_hosts_ecs",
    "max_signals": 100,
    "name": "Anomalous Process For a Windows Population",
    "note": "### Investigating an Unusual Windows Process ###\nDetection alerts from this rule indicate the presence of a Windows process that is rare and unusual for all of the Windows hosts for which Winlogbeat data is available. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process metadata like the values of the Company, Description and Product fields which may indicate whether the program is associated with an expected software vendor or package.\n- Examine arguments and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.\n- If you have file hash values in the event data, and you suspect malware, you can optionally run a search for the file hash to see if the file is identified as malware by anti-malware tools. ",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "6e40d56f-5c0e-4ac6-aece-bee96645b172",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "ML", "Windows"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.236Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.026Z",
    "created_by": "elastic",
    "description": "Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."
    ],
    "from": "now-45m",
    "id": "472fc2e1-7891-4e6c-aacb-916deead9432",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "rare_process_by_host_linux_ecs",
    "max_signals": 100,
    "name": "Unusual Process For a Linux Host",
    "note": "### Investigating an Unusual Linux Process ###\nDetection alerts from this rule indicate the presence of a Linux process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "46f804f5-b289-43d6-a881-9387cf594f75",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.235Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.950Z",
    "created_by": "elastic",
    "description": "This rule detects events that could be describing IPSEC NAT Traversal traffic. IPSEC is a VPN technology that allows one system to talk to another using encrypted tunnels. NAT Traversal enables these tunnels to communicate over the Internet where one of the sides is behind a NAT router gateway. This may be common on your network, but this technique is also used by threat actors to avoid detection.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some networks may utilize these protocols but usage that is unfamiliar to local network administrators can be unexpected and suspicious. Because this port is in the ephemeral range, this rule may false under certain conditions, such as when an application server with a public IP address replies to a client which has used a UDP port in the range by coincidence. This is uncommon but such servers can be excluded."
    ],
    "from": "now-6m",
    "id": "516c4f66-46ef-433d-ba10-d739c2dd0d2a",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "IPSEC NAT Traversal Port Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:udp and destination.port:4500",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "a9cb3641-ff4b-4cdc-a063-b4b8d02a67c7",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.130Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.952Z",
    "created_by": "elastic",
    "description": "Identifies use of whoami.exe which displays user, group, and privileges information for the user who is currently logged on to the local system.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools and frameworks. Usage by non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "cdf263a5-50f4-4425-b2b4-384a9524537b",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Whoami Process Activity",
    "output_index": ".siem-signals-default",
    "query": "process.name:whoami.exe and event.code:1",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "ef862985-3f13-4262-a686-5f357bbb9bc2",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery",
            "reference": "https://attack.mitre.org/techniques/T1033/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.131Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.951Z",
    "created_by": "elastic",
    "description": "This rule detects events that use common ports for Internet Relay Chat (IRC) to the Internet. IRC is a common protocol that can be used for chat and file transfers. This protocol is also a good candidate for remote control of malware and data transfers to and from a network.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "IRC activity may be normal behavior for developers and engineers but is unusual for non-engineering end users. IRC activity involving an unusual source or destination may be more suspicious. IRC activity involving a production server is often suspicious. Because these ports are in the ephemeral range, this rule may false under certain conditions, such as when a NAT-ed web server replies to a client which has used a port in the range by coincidence. In this case, these servers can be excluded. Some legacy applications may use these ports, but this is very uncommon and usually only appears in local traffic using private IPs, which does not match this rule's conditions."
    ],
    "from": "now-6m",
    "id": "4dc6ea91-82c9-460a-a38d-0a8535720491",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "IRC (Internet Relay Chat) Protocol Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(6667 or 6697) or event.dataset:zeek.irc) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "c6474c34-4953-447a-903e-9fcb7b6661aa",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.129Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.953Z",
    "created_by": "elastic",
    "description": "TCP Port 8000 is commonly used for development environments of web server software. It generally should not be exposed directly to the Internet. If you are running software like this on the Internet, you should consider placing it behind a reverse proxy.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Because this port is in the ephemeral range, this rule may false under certain conditions, such as when a NATed web server replies to a client which has used a port in the range by coincidence. In this case, such servers can be excluded. Some applications may use this port but this is very uncommon and usually appears in local traffic using private IPs, which this rule does not match. Some cloud environments, particularly development environments, may use this port when VPNs or direct connects are not in use and cloud instances are accessed across the Internet."
    ],
    "from": "now-6m",
    "id": "79249d73-ddc3-4959-a625-833f69eb856d",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "TCP Port 8000 Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and destination.port:8000 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "08d5d7e2-740f-44d8-aeda-e41f4263efaf",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.132Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.959Z",
    "created_by": "elastic",
    "description": "The Tcpdump program ran on a Linux host. Tcpdump is a network monitoring or packet sniffing tool that can be used to capture insecure credentials or data in motion. Sniffing can also be used to discover details of network services as a prelude to lateral movement or defense evasion.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some normal use of this command may originate from server or network administrators engaged in network troubleshooting."
    ],
    "from": "now-6m",
    "id": "e6ad0bff-bde4-4b17-b24d-b559a5364eaa",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Network Sniffing via Tcpdump",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:tcpdump",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "7a137d76-ce3d-48e2-947d-2747796a78c0",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1040",
            "name": "Network Sniffing",
            "reference": "https://attack.mitre.org/techniques/T1040/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1040",
            "name": "Network Sniffing",
            "reference": "https://attack.mitre.org/techniques/T1040/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.135Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.952Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RDP traffic from the Internet. RDP is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some network security policies allow RDP directly from the Internet but usage that is unfamiliar to server or network owners can be unexpected and suspicious. RDP services may be exposed directly to the Internet in some networks such as cloud environments. In such cases, only RDP gateways, bastions or jump servers may be expected expose RDP directly to the Internet and can be exempted from this rule. RDP may be required by some work-flows such as remote access and support for specialized software products and servers. Such work-flows are usually known and not unexpected."
    ],
    "from": "now-6m",
    "id": "6fc4e1c3-7a83-45a7-8464-7f4bc38877b7",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "RDP (Remote Desktop Protocol) from the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:3389 or event.dataset:zeek.rdp) and not source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "8c1bdde8-4204-45c0-9e0c-c85ca3902488",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.133Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.960Z",
    "created_by": "elastic",
    "description": "The whoami application was executed on a Linux host. This is often used by tools and persistence mechanisms to test for privileged access.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security testing tools and frameworks may run this command. Some normal use of this command may originate from automation tools and frameworks."
    ],
    "from": "now-6m",
    "id": "99cb893b-4882-4cf3-993b-1639f6360305",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "User Discovery via Whoami",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:whoami",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "120559c6-5e24-49f4-9e30-8ffe697df6b9",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery",
            "reference": "https://attack.mitre.org/techniques/T1033/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.134Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.961Z",
    "created_by": "elastic",
    "description": "Identifies possibly suspicious activity using trusted Windows developer activity.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "These programs may be used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "9796ca95-2a76-4d7f-999c-5ee0c703f9c3",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Trusted Developer Application Usage",
    "output_index": ".siem-signals-default",
    "query": "event.code:1 and process.name:(MSBuild.exe or msxsl.exe)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae1",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.136Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.945Z",
    "created_by": "elastic",
    "description": "This rule detects events that may indicate the use of FTP network connections to the Internet. The File Transfer Protocol (FTP) has been around in its current form since the 1980s. It can be a common and efficient procedure on your network to send and receive files. Because of this, adversaries will also often use this protocol to exfiltrate data from your network or download new tools. Additionally, FTP is a plain-text protocol which, if intercepted, may expose usernames and passwords. FTP activity involving servers subject to regulations or compliance standards may be unauthorized.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "FTP servers should be excluded from this rule as this is expected behavior. Some business workflows may use FTP for data exchange. These workflows often have expected characteristics such as users, sources, and destinations. FTP activity involving an unusual source or destination may be more suspicious. FTP activity involving a production server that has no known associated FTP workflow or business requirement is often suspicious."
    ],
    "from": "now-6m",
    "id": "4a61a65b-b217-4d6f-b20a-4031d4d9b48f",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "FTP (File Transfer Protocol) Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(20 or 21) or event.dataset:zeek.ftp) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "87ec6396-9ac4-4706-bcf0-2ebb22002f43",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.112Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.947Z",
    "created_by": "elastic",
    "description": "A request to a web application server contained no identifying user agent string.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Some normal applications and scripts may contain no user agent. Most legitimate web requests from the Internet contain a user agent string. Requests from web browsers almost always contain a user agent string. If the source is unexpected, the user unauthorized, or the request unusual, these may indicate suspicious or malicious activity."
    ],
    "filters": [
      {
        "$state": {
          "store": "appState"
        },
        "exists": {
          "field": "user_agent.original"
        },
        "meta": {
          "disabled": false,
          "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
          "key": "user_agent.original",
          "negate": true,
          "type": "exists",
          "value": "exists"
        }
      }
    ],
    "from": "now-6m",
    "id": "ab59e1f0-a034-4430-bfb6-2450add4e8c5",
    "immutable": true,
    "index": ["apm-*-transaction*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Web Application Suspicious Activity: No User Agent",
    "output_index": ".siem-signals-default",
    "query": "url.path:*",
    "references": ["https://en.wikipedia.org/wiki/User_agent"],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "43303fd4-4839-4e48-b2b2-803ab060758d",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["APM", "Elastic"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.117Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.947Z",
    "created_by": "elastic",
    "description": "This is an example of how to detect an unwanted web client user agent. This search matches the user agent for sqlmap 1.3.11, which is a popular FOSS tool for testing web applications for SQL injection vulnerabilities.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "This rule does not indicate that a SQL injection attack occurred, only that the `sqlmap` tool was used. Security scans and tests may result in these errors. If the source is not an authorized security tester, this is generally suspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "68c6d1c7-bdfc-4aaa-8783-c62993e5d0b8",
    "immutable": true,
    "index": ["apm-*-transaction*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Web Application Suspicious Activity: sqlmap User Agent",
    "output_index": ".siem-signals-default",
    "query": "user_agent.original:\"sqlmap/1.3.11#stable (http://sqlmap.org)\"",
    "references": ["http://sqlmap.org/"],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "d49cc73f-7a16-4def-89ce-9fc7127d7820",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["APM", "Elastic"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.118Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.948Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of Telnet traffic. Telnet is commonly used by system administrators to remotely control older or embed ed systems using the command line shell. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector. As a plain-text protocol, it may also expose usernames and passwords to anyone capable of observing the traffic.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "IoT (Internet of Things) devices and networks may use telnet and can be excluded if desired. Some business work-flows may use Telnet for administration of older devices. These often have a predictable behavior. Telnet activity involving an unusual source or destination may be more suspicious. Telnet activity involving a production server that has no known associated Telnet work-flow or business requirement is often suspicious."
    ],
    "from": "now-6m",
    "id": "df069d76-52b8-476b-8c0f-182475abc086",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Telnet Port Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and destination.port:23",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "34fde489-94b0-4500-a76f-b8a157cf9269",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.126Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.949Z",
    "created_by": "elastic",
    "description": "This rule detects when an internal network client sends DNS traffic directly to the Internet. This is atypical behavior for a managed network, and can be indicative of malware, exfiltration, command and control, or, simply, misconfiguration. This DNS activity also impacts your organization's ability to provide enterprise monitoring and logging of DNS, and opens your network to a variety of abuses and malicious communications.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Exclude DNS servers from this rule as this is expected behavior. Endpoints usually query local DNS servers defined in their DHCP scopes, but this may be overridden if a user configures their endpoint to use a remote DNS server. This is uncommon in managed enterprise networks because it could break intranet name resolution when split horizon DNS is utilized. Some consumer VPN services and browser plug-ins may send DNS traffic to remote Internet destinations. In that case, such devices or networks can be excluded from this rule when this is expected behavior."
    ],
    "from": "now-6m",
    "id": "1cdea00b-cce2-4b21-8317-849f3911cc50",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "DNS Activity to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and (event.type:connection or type:dns) and (destination.port:53 or event.dataset:zeek.dns) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.169.254/32 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or 224.0.0.252 or 255.255.255.255 or \"::1\" or \"ff02::fb\")",
    "references": [
      "https://www.us-cert.gov/ncas/alerts/TA15-240A",
      "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "6ea71ff0-9e95-475b-9506-2580d1ce6154",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.128Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.965Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of SSH traffic from the Internet. SSH is commonly used by system administrators to remotely control a system using the command line shell. If it is exposed to the Internet, it should be done with strong security controls as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "SSH connections may be made directly to Internet destinations in order to access Linux cloud server instances but such connections are usually made only by engineers. In such cases, only SSH gateways, bastions or jump servers may be expected Internet destinations and can be exempted from this rule. SSH may be required by some work-flows such as remote access and support for specialized software products and servers. Such work-flows are usually known and not unexpected. Usage that is unfamiliar to server or network owners can be unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "4e23f7df-b228-4bf6-a567-8021b0d44de5",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "SSH (Secure Shell) to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and (destination.port:22 or event.dataset:zeek.ssh) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "6f1500bc-62d7-4eb9-8601-7485e87da2f4",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.137Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.968Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Credential Dumping. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-15m",
    "id": "bd2179bc-38c1-4d77-ba4f-77e4a1a8103b",
    "immutable": true,
    "index": ["endgame-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Credential Dumping - Prevented - Elastic Endpoint",
    "output_index": ".siem-signals-default",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "db8c33a8-03cd-4988-9e2c-d0a4863adb13",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Endpoint"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.138Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.016Z",
    "created_by": "elastic",
    "description": "The Application Shim was created to allow for backward compatibility of software as the operating system codebase changes over time. This Windows functionality has been abused by attackers to stealthily gain persistence and arbitrary code execution in legitimate Windows processes.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "c32260bf-1070-41cc-952f-2a8fe7222cbe",
    "immutable": true,
    "index": ["winlogbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Potential Application Shimming via Sdbinst",
    "output_index": ".siem-signals-default",
    "query": "event.code:1 and process.name:sdbinst.exe",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "fd4a992d-6130-4802-9ff8-829b89ae801f",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Windows"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1138",
            "name": "Application Shimming",
            "reference": "https://attack.mitre.org/techniques/T1138/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1138",
            "name": "Application Shimming",
            "reference": "https://attack.mitre.org/techniques/T1138/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.229Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "anomaly_threshold": 50,
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.035Z",
    "created_by": "elastic",
    "description": "Searches for rare processes running on multiple Linux hosts in an entire fleet or network. This reduces the detection of false positives since automated maintenance processes usually only run occasionally on a single machine but are common to all or many hosts in a fleet.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."
    ],
    "from": "now-45m",
    "id": "550c7643-688c-43f2-b318-a0786cf0afa5",
    "immutable": true,
    "interval": "15m",
    "license": "Elastic License",
    "machine_learning_job_id": "linux_anomalous_process_all_hosts_ecs",
    "max_signals": 100,
    "name": "Anomalous Process For a Linux Population",
    "note": "### Investigating an Unusual Linux Process ###\nDetection alerts from this rule indicate the presence of a Linux process that is rare and unusual for all of the monitored Linux hosts for which Auditbeat data is available. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.",
    "output_index": ".siem-signals-default",
    "references": [
      "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
    ],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "647fc812-7996-4795-8869-9c4ea595fe88",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux", "ML"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "machine_learning",
    "updated_at": "2020-07-19T09:20:17.254Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.049Z",
    "created_by": "elastic",
    "description": "Identifies attempts to delete an AWS Config Service rule. An adversary may tamper with Config rules in order to reduce visibiltiy into the security posture of an account and / or its workload instances.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Privileged IAM users with security responsibilities may be expected to make changes to the Config rules in order to align with local security policies and requirements. Automation, orchestration, and security tools may also make changes to the Config service, where they are used to automate setup or configuration of AWS accounts. Other kinds of user or service contexts do not commonly make changes to this service."
    ],
    "from": "now-60m",
    "id": "7108acfc-e6c4-4a94-a965-e283c5e228fb",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS Config Service Tampering",
    "output_index": ".siem-signals-default",
    "query": "event.dataset: aws.cloudtrail and event.action: DeleteConfigRule and event.provider: config.amazonaws.com",
    "references": [
      "https://docs.aws.amazon.com/config/latest/developerguide/how-does-config-work.html",
      "https://docs.aws.amazon.com/config/latest/APIReference/API_Operations.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "7024e2a0-315d-4334-bb1a-552d604f27bc",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.266Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.019Z",
    "created_by": "elastic",
    "description": "Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."
    ],
    "from": "now-6m",
    "id": "6bfa509e-76d3-4a1b-b7f4-5841e19aa690",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Hex Encoding/Decoding Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(hexdump or od or xxd)",
    "references": [],
    "risk_score": 21,
    "risk_score_mapping": [],
    "rule_id": "a9198571-b135-4a76-b055-e3e5a476fd83",
    "severity": "low",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1027/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.224Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.054Z",
    "created_by": "elastic",
    "description": "Identifies the deletion of an AWS log trail. An adversary may delete trails in an attempt to evade defenses.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Trail deletions may be made by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
    ],
    "from": "now-60m",
    "id": "d045f068-51ef-40ac-8e71-777e2f047cc6",
    "immutable": true,
    "index": ["filebeat-*"],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "AWS CloudTrail Log Deleted",
    "output_index": ".siem-signals-default",
    "query": "event.action:DeleteTrail and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success",
    "references": [
      "https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_DeleteTrail.html",
      "https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/delete-trail.html"
    ],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "7024e2a0-315d-4334-bb1a-441c593e16ab",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["AWS", "Elastic"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.270Z",
    "updated_by": "elastic",
    "version": 1
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.007Z",
    "created_by": "elastic",
    "description": "Hping ran on a Linux host. Hping is a FOSS command-line packet analyzer and has the ability to construct network packets for a wide variety of network security testing applications, including scanning and firewall auditing.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Normal use of hping is uncommon apart from security testing and research. Use by non-security engineers is very uncommon."
    ],
    "from": "now-6m",
    "id": "cbc88f1a-6217-4440-b896-6a21e56c255a",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Hping Process Activity",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(hping or hping2 or hping3)",
    "references": ["https://en.wikipedia.org/wiki/Hping"],
    "risk_score": 73,
    "risk_score_mapping": [],
    "rule_id": "90169566-2260-4824-b8e4-8615c3b4ed52",
    "severity": "high",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.226Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.013Z",
    "created_by": "elastic",
    "description": "Identifies suspicious commands executed via a web server, which may suggest a vulnerability and remote shell access.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Network monitoring or management products may have a web server component that runs shell commands as part of normal behavior."
    ],
    "from": "now-6m",
    "id": "1ca2bee6-d65e-44c2-9d7c-395c56852e07",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Potential Shell via Web Server",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and process.name:(bash or dash) and user.name:(apache or nginx or www or \"www-data\")",
    "references": ["https://pentestlab.blog/tag/web-shell/"],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "231876e7-4d1f-4d63-a47c-47dd1acdc1cb",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1100",
            "name": "Web Shell",
            "reference": "https://attack.mitre.org/techniques/T1100/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.227Z",
    "updated_by": "elastic",
    "version": 4
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:17.028Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to disable the syslog service in an attempt to an attempt to disrupt event logging and evade detection by security controls.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [],
    "from": "now-6m",
    "id": "b84c0069-21b0-4ba9-8d7c-a2dd2f3788b8",
    "immutable": true,
    "index": ["auditbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Attempt to Disable Syslog Service",
    "output_index": ".siem-signals-default",
    "query": "event.category:process and event.type:(start or process_started) and ((process.name:service and process.args:stop) or (process.name:chkconfig and process.args:off) or (process.name:systemctl and process.args:(disable or stop or kill))) and process.args:(syslog or rsyslog or \"syslog-ng\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "2f8a1226-5720-437d-9c20-e0029deb6194",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Linux"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.234Z",
    "updated_by": "elastic",
    "version": 2
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.939Z",
    "created_by": "elastic",
    "description": "A POST request to web application returned a 403 response, which indicates the web application declined to process the request because the action requested was not allowed",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security scans and tests may result in these errors. Misconfigured or buggy applications may produce large numbers of these errors. If the source is unexpected, the user unauthorized, or the request unusual, these may indicate suspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "6ccd661b-35cf-4ba0-91a6-af81501c6805",
    "immutable": true,
    "index": ["apm-*-transaction*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Web Application Suspicious Activity: POST Request Declined",
    "output_index": ".siem-signals-default",
    "query": "http.response.status_code:403 and http.request.method:post",
    "references": ["https://en.wikipedia.org/wiki/HTTP_403"],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "a87a4e42-1d82-44bd-b0bf-d9b7f91fb89e",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["APM", "Elastic"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.104Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.946Z",
    "created_by": "elastic",
    "description": "A request to web application returned a 405 response which indicates the web application declined to process the request because the HTTP method is not allowed for the resource",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "Security scans and tests may result in these errors. Misconfigured or buggy applications may produce large numbers of these errors. If the source is unexpected, the user unauthorized, or the request unusual, these may indicate suspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "a346ea9b-c2bb-4d66-8aba-f9539ce38371",
    "immutable": true,
    "index": ["apm-*-transaction*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "Web Application Suspicious Activity: Unauthorized Method",
    "output_index": ".siem-signals-default",
    "query": "http.response.status_code:405",
    "references": ["https://en.wikipedia.org/wiki/HTTP_405"],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "75ee75d8-c180-481c-ba88-ee50129a6aef",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["APM", "Elastic"],
    "threat": [],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.116Z",
    "updated_by": "elastic",
    "version": 3
  },
  {
    "actions": [],
    "author": ["Elastic"],
    "created_at": "2020-07-19T09:20:16.950Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of VNC traffic to the Internet. VNC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "exceptions_list": [],
    "false_positives": [
      "VNC connections may be made directly to Linux cloud server instances but such connections are usually made only by engineers. VNC is less common than SSH or RDP but may be required by some work flows such as remote access and support for specialized software products or servers. Such work-flows are usually known and not unexpected. Usage that is unfamiliar to server or network owners can be unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "45b48415-e78b-444c-9b3d-20adfa669366",
    "immutable": true,
    "index": ["filebeat-*", "packetbeat-*"],
    "interval": "5m",
    "language": "kuery",
    "license": "Elastic License",
    "max_signals": 100,
    "name": "VNC (Virtual Network Computing) to the Internet",
    "output_index": ".siem-signals-default",
    "query": "event.category:(network or network_traffic) and network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or \"::1\")",
    "references": [],
    "risk_score": 47,
    "risk_score_mapping": [],
    "rule_id": "3ad49c61-7adc-42c1-b788-732eda2f5abf",
    "severity": "medium",
    "severity_mapping": [],
    "tags": ["Elastic", "Network"],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1219",
            "name": "Remote Access Tools",
            "reference": "https://attack.mitre.org/techniques/T1219/"
          }
        ]
      }
    ],
    "throttle": "no_actions",
    "to": "now",
    "type": "query",
    "updated_at": "2020-07-19T09:20:17.127Z",
    "updated_by": "elastic",
    "version": 4
  }
]
