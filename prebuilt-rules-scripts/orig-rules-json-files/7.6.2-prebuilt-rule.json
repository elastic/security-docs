[
  {
    "created_at": "2020-03-05T08:16:14.300Z",
    "updated_at": "2020-03-05T08:16:14.377Z",
    "created_by": "elastic",
    "description": "Identifies unusual instances of rundll32.exe making outbound network connections. This may indicate adversarial activity and may identify malicious DLLs.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "9bb303a9-0ccd-40dd-83c2-0c138d3293a2",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "52aaab7b-b51c-441a-89ce-4387b3aea886",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Unusual Network Connection via RunDLL32",
    "query": "process.name:rundll32.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1085",
            "name": "Rundll32",
            "reference": "https://attack.mitre.org/techniques/T1085/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.306Z",
    "updated_at": "2020-03-05T08:16:14.384Z",
    "created_by": "elastic",
    "description": "Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (hh.exe).",
    "enabled": false,
    "false_positives": [
      "The HTML Help executable program (hh.exe) runs whenever a user clicks a compiled help (.chm) file or menu item that opens the help file inside the Help Viewer. This is not always malicious, but adversaries may abuse this technology to conceal malicious code."
    ],
    "from": "now-6m",
    "id": "89bc729d-2270-48e9-8a8d-ee0c217c2bb1",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "e3343ab9-4245-4715-b344-e11c56b0a47f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Process Activity via Compiled HTML File",
    "query": "event.code:1 and process.name:hh.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.300Z",
    "updated_at": "2020-03-05T08:16:14.376Z",
    "created_by": "elastic",
    "description": "This rule detects events that may indicate the use of FTP network connections to the Internet.\nThe File Transfer Protocol (FTP) has been around in its current form since the\n1980s. It can be a common and efficient procedure on your network to send and\nreceive files. Because of this, adversaries will also often use this protocol\nto exfiltrate data from your network or download new tools. Additionally, FTP\nis a plain-text protocol which, if intercepted, may expose usernames and\npasswords. FTP activity involving servers subject to regulations or compliance\nstandards may be unauthorized.\n",
    "enabled": false,
    "false_positives": [
      "FTP servers should be excluded from this rule as this is expected behavior. Some business workflows may use FTP for data exchange. These workflows often have expected characteristics such as users, sources, and destinations. FTP activity involving an unusual source or destination may be more suspicious. FTP activity involving a production server that has no known associated FTP workflow or business requirement is often suspicious."
    ],
    "from": "now-6m",
    "id": "25cee747-2d93-47e4-b861-4e03074b9754",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "87ec6396-9ac4-4706-bcf0-2ebb22002f43",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "FTP (File Transfer Protocol) Activity to the Internet",
    "query": "network.transport: tcp and destination.port: (20 or 21) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.303Z",
    "updated_at": "2020-03-05T08:16:14.381Z",
    "created_by": "elastic",
    "description": "Hping ran on a Linux host. Hping is a FOSS command-line packet analyzer and has the ability to construct network packets for a wide variety of network security testing applications, including scanning and firewall auditing.",
    "enabled": false,
    "false_positives": [
      "Normal use of hping is uncommon apart from security testing and research. Use by non-security engineers is very uncommon."
    ],
    "from": "now-6m",
    "id": "39b97915-7017-4615-a101-d9ec18e2a7d4",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "90169566-2260-4824-b8e4-8615c3b4ed52",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Hping Process Activity",
    "query": "process.name: (hping3 or hping2 or hping) and event.action:executed",
    "references": [
      "https://en.wikipedia.org/wiki/Hping"
    ],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.302Z",
    "updated_at": "2020-03-05T08:16:14.380Z",
    "created_by": "elastic",
    "description": "A request to web application returned a 405 response which indicates the web application declined to process the request because the HTTP method is not allowed for the resource",
    "enabled": false,
    "false_positives": [
      "Security scans and tests may result in these errors. Misconfigured or buggy applications may produce large numbers of these errors. If the source is unexpected, the user unauthorized, or the request unusual, these may indicate suspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "bf88b7c1-98e2-427a-931d-ea2cd7452c30",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "75ee75d8-c180-481c-ba88-ee50129a6aef",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: Unauthorized Method",
    "query": "http.response.status_code:405",
    "references": [
      "https://en.wikipedia.org/wiki/HTTP_405"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "APM"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.301Z",
    "updated_at": "2020-03-05T08:16:14.378Z",
    "created_by": "elastic",
    "description": "Identifies loadable kernel module errors, which are often indicative of potential persistence attempts.",
    "enabled": false,
    "false_positives": [
      "Security tools and device drivers may run these programs in order to load legitimate kernel modules. Use of these programs by ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "ec4c9bac-f6a2-4843-aa25-8917f5fd6339",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "81cc58f5-8062-49a2-ba84-5cc4b4d31c40",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Persistence via Kernel Module Modification",
    "query": "process.name: (insmod or kmod or modprobe or rmod) and event.action:executed",
    "references": [
      "https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/techniques/TA0003/"
        },
        "technique": [
          {
            "id": "T1215",
            "name": "Kernel Modules and Extensions",
            "reference": "https://attack.mitre.org/techniques/T1215/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.302Z",
    "updated_at": "2020-03-05T08:16:14.379Z",
    "created_by": "elastic",
    "description": "Identifies MsBuild.exe making outbound network connections. This may indicate adversarial activity as MsBuild is often leveraged by adversaries to execute code and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "94d5529e-6a5a-4ee1-9840-289fc2060e02",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0e79980b-4250-4a50-a509-69294c14e84b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "MsBuild Making Network Connections",
    "query": " event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:MSBuild.exe and not destination.ip:(\"127.0.0.1\" or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.304Z",
    "updated_at": "2020-03-05T08:16:14.383Z",
    "created_by": "elastic",
    "description": "Identifies Windows programs run from unexpected parent processes. This could indicate masquerading or other strange activity on a system.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "0580a56d-96ef-4e6f-82ab-776ce2b462cf",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "35df0dd8-092d-4a83-88c1-5151a804f31b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Unusual Parent-Child Relationship",
    "query": "   event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.executable:* and   (      (process.name:\"smss.exe\" and not process.parent.name:(\"System\" or \"smss.exe\")) or       (process.name:\"csrss.exe\" and not process.parent.name:(\"smss.exe\" or \"svchost.exe\")) or       (process.name:\"wininit.exe\" and not process.parent.name:\"smss.exe\") or       (process.name:\"winlogon.exe\" and not process.parent.name:\"smss.exe\") or       (process.name:\"lsass.exe\" and not process.parent.name:\"wininit.exe\") or       (process.name:\"LogonUI.exe\" and not process.parent.name:(\"winlogon.exe\" or \"wininit.exe\")) or       (process.name:\"services.exe\" and not process.parent.name:\"wininit.exe\") or       (process.name:\"svchost.exe\" and not process.parent.name:(\"services.exe\" or \"MsMpEng.exe\")) or      (process.name:\"spoolsv.exe\" and not process.parent.name:\"services.exe\") or       (process.name:\"taskhost.exe\" and not process.parent.name:(\"services.exe\" or \"svchost.exe\")) or       (process.name:\"taskhostw.exe\" and not process.parent.name:(\"services.exe\" or \"svchost.exe\")) or       (process.name:\"userinit.exe\" and not process.parent.name:(\"dwm.exe\" or \"winlogon.exe\"))    )",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1093",
            "name": "Process Hollowing",
            "reference": "https://attack.mitre.org/techniques/T1093/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.306Z",
    "updated_at": "2020-03-05T08:16:14.384Z",
    "created_by": "elastic",
    "description": "The Filter Manager Control Program (fltMC.exe) binary may be abused by adversaries to unload a filter driver and evade defenses.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "a4e965b6-7810-48d6-8b4b-d0cb5c61440f",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "06dceabf-adca-48af-ac79-ffdf4c3b1e9a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Potential Evasion via Filter Manager",
    "query": "event.code:1 and process.name:fltMC.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1222",
            "name": "File and Directory Permissions Modification",
            "reference": "https://attack.mitre.org/techniques/T1222/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.307Z",
    "updated_at": "2020-03-05T08:16:14.385Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RDP traffic\nto the Internet. RDP is commonly used by system administrators to remotely\ncontrol a system for maintenance or to use shared resources. It should almost\nnever be directly exposed to the Internet, as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [
      "RDP connections may be made directly to Internet destinations in order to access\n    Windows cloud server instances but such connections are usually made only by engineers.\n    In such cases, only RDP gateways, bastions or jump servers may be expected Internet\n    destinations and can be exempted from this rule. RDP may be required by some work-flows\n    such as remote access and support for specialized software products and servers. Such\n    work-flows are usually known and not unexpected. Usage that is unfamiliar to server or\n    network owners can be unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "a7b9a7aa-deff-424b-a764-9ffb2e3dbfbe",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "e56993d2-759c-4120-984c-9ec9bb940fd5",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "RDP (Remote Desktop Protocol) to the Internet",
    "query": "network.transport: tcp and destination.port: 3389 and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.305Z",
    "updated_at": "2020-03-05T08:16:14.382Z",
    "created_by": "elastic",
    "description": "The whoami application was executed on a Linux host. This is often used by  tools and persistence mechanisms to test for privileged access.",
    "enabled": false,
    "false_positives": [
      "Security testing tools and frameworks may run this command. Some normal use of this command may originate from automation tools and frameworks."
    ],
    "from": "now-6m",
    "id": "0d473dcb-b088-403b-926c-89498c77cc0c",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "120559c6-5e24-49f4-9e30-8ffe697df6b9",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "User Discovery via Whoami",
    "query": "process.name: whoami and event.action:executed",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery",
            "reference": "https://attack.mitre.org/techniques/T1033/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.308Z",
    "updated_at": "2020-03-05T08:16:14.387Z",
    "created_by": "elastic",
    "description": "Identifies possibly suspicious activity using trusted Windows developer activity.",
    "enabled": false,
    "false_positives": [
      "These programs may be used by Windows developers but use by non-engineers is unusual."
    ],
    "from": "now-6m",
    "id": "188f56a9-7422-447c-8e3d-cc310b051e4d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae1",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Trusted Developer Application Usage",
    "query": "event.code:1 and (process.name:MSBuild.exe or process.name:msxsl.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.309Z",
    "updated_at": "2020-03-05T08:16:14.386Z",
    "created_by": "elastic",
    "description": "Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Adversaries may use these binaries to 'live off the land' and execute malicious files that could bypass application whitelisting and signature validation.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "a5daf9b3-0f15-4c88-93cf-570ae7b4a0ba",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "63e65ec3-43b1-45b0-8f2d-45b34291dc44",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Signed Binary",
    "query": "(process.name:expand.exe or process.name:extrac.exe or process.name:ieexec.exe or process.name:makecab.exe) and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.338Z",
    "updated_at": "2020-03-05T08:16:14.440Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious parent child process relationship with cmd.exe descending from svchost.exe",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "e890463b-7b74-49c2-ae6d-b2dd060bd4b9",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fd7a6052-58fa-4397-93c3-4795249ccfa2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Svchost spawning Cmd",
    "query": "process.parent.name:svchost.exe and process.name:cmd.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.311Z",
    "updated_at": "2020-03-05T08:16:14.390Z",
    "created_by": "elastic",
    "description": "Detects writing executable files that will be automatically launched by Adobe on launch.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "c7252439-966a-48dc-ad7e-deccc034e12c",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "2bf78aa2-9c56-48de-b139-f169bf99cf86",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Adobe Hijack Persistence",
    "query": "file.path:(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\" or \"C:\\Program Files\\Adobe\\Acrobat Reader DC\\Reader\\AcroCEF\\RdrCEF.exe\") and event.action:\"File created (rule: FileCreate)\" and not process.name:msiexec.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1044",
            "name": "File System Permissions Weakness",
            "reference": "https://attack.mitre.org/techniques/T1044/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.308Z",
    "updated_at": "2020-03-05T08:16:14.388Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of Microsoft Outlook. These child processes are often associated with spear phishing activity.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "77b2376a-d56a-4c94-ac21-886da6a1f362",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "32f4675e-6c49-4ace-80f9-97c9259dca2e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious MS Outlook Child Process",
    "query": "  event.action:\"Process Create (rule: ProcessCreate)\" and  process.parent.name:\"outlook.exe\" and    process.name:(\"arp.exe\" or \"dsquery.exe\" or \"dsget.exe\" or \"gpresult.exe\" or \"hostname.exe\" or \"ipconfig.exe\" or \"nbtstat.exe\" or \"net.exe\" or \"net1.exe\" or \"netsh.exe\" or \"netstat.exe\" or \"nltest.exe\" or \"ping.exe\" or \"qprocess.exe\" or \"quser.exe\" or \"qwinsta.exe\" or \"reg.exe\" or \"sc.exe\" or \"systeminfo.exe\" or \"tasklist.exe\" or \"tracert.exe\" or \"whoami.exe\" or \"bginfo.exe\" or \"cdb.exe\" or \"cmstp.exe\" or \"csi.exe\" or \"dnx.exe\" or \"fsi.exe\" or \"ieexec.exe\" or \"iexpress.exe\" or \"installutil.exe\" or \"Microsoft.Workflow.Compiler.exe\" or \"msbuild.exe\" or \"mshta.exe\" or \"msxsl.exe\" or \"odbcconf.exe\" or \"rcsi.exe\" or \"regsvr32.exe\" or \"xwizard.exe\" or \"atbroker.exe\" or \"forfiles.exe\" or \"schtasks.exe\" or \"regasm.exe\" or \"regsvcs.exe\" or \"cmd.exe\" or \"cscript.exe\" or \"powershell.exe\" or \"pwsh.exe\" or \"wmic.exe\" or \"wscript.exe\" or \"bitsadmin.exe\" or \"certutil.exe\" or \"ftp.exe\") ",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.296Z",
    "updated_at": "2020-03-05T08:16:14.393Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Malware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "cc454625-a059-4658-a27e-59e92d070e1c",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "3b382770-efbb-44f4-beed-f5e0a051b895",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Malware - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:file_classification_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.364Z",
    "updated_at": "2020-03-05T08:16:14.471Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of SSH traffic\nfrom the Internet. SSH is commonly used by system administrators to remotely\ncontrol a system using the command line shell. If it is exposed to the Internet,\nit should be done with strong security controls as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [
      "Some network security policies allow SSH directly from the Internet but usage that is\n    unfamiliar to server or network owners can be unexpected and suspicious. SSH services may\n    be exposed directly to the Internet in some networks such as cloud environments. In such\n    cases, only SSH gateways, bastions or jump servers may be expected expose SSH directly to\n    the Internet and can be exempted from this rule. SSH may be required by some work-flows\n    such as remote access and support for specialized software products and servers. Such\n    work-flows are usually known and not unexpected."
    ],
    "from": "now-6m",
    "id": "e14d6d08-97ec-4d3a-ad13-389f3c0fedec",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "ea0784f0-a4d7-4fea-ae86-4baaf27a6f17",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "SSH (Secure Shell) from the Internet",
    "query": "network.transport: tcp and destination.port:22 and (\n    network.direction: inbound or (\n        not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.347Z",
    "updated_at": "2020-03-05T08:16:14.462Z",
    "created_by": "elastic",
    "description": "Identifies use of the SysInternals tool PsExec.exe making a network connection. This could be an indication of lateral movement.",
    "enabled": false,
    "false_positives": [
      "PsExec is a dual-use tool that can be used for benign or malicious activity. It's important to baseline your environment to determine the amount of noise to expect from this tool."
    ],
    "from": "now-6m",
    "id": "e241b508-9fc0-4c0d-a324-2695ade56980",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "55d551c6-333b-4665-ab7e-5d14a59715ce",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "PsExec Network Connection",
    "query": "process.name:PsExec.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" ",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1035",
            "name": "Service Execution",
            "reference": "https://attack.mitre.org/techniques/T1035/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1035",
            "name": "Service Execution",
            "reference": "https://attack.mitre.org/techniques/T1035/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.351Z",
    "updated_at": "2020-03-05T08:16:14.482Z",
    "created_by": "elastic",
    "description": "Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Adversaries may use these binaries to 'live off the land' and execute malicious files that could bypass application whitelisting and signature validation.",
    "enabled": false,
    "false_positives": [
      "Security testing may produce events like this. Activity of this kind performed by non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "dd8a9be2-de91-47ab-8124-c6a74d2450a5",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "7edb573f-1f9b-4161-8c19-c7c383bb17f2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Execution via Signed Binary",
    "query": "event.code:1 and http and (process.name:certutil.exe or process.name:msiexec.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution",
            "reference": "https://attack.mitre.org/techniques/T1218/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.345Z",
    "updated_at": "2020-03-05T08:16:14.481Z",
    "created_by": "elastic",
    "description": "Identifies suspicious commands executed via a web server, which may suggest a vulnerability and remote shell access.",
    "enabled": false,
    "false_positives": [
      "Network monitoring or management products may have a web server component that runs shell commands as part of normal behavior."
    ],
    "from": "now-6m",
    "id": "bed3de05-25c1-4742-8749-cbf665ae9166",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "231876e7-4d1f-4d63-a47c-47dd1acdc1cb",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Potential Shell via Web Server",
    "query": "process.name: bash and user.name: (apache or www or \"www-data\") and event.action:executed",
    "references": [
      "https://pentestlab.blog/tag/web-shell/"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/techniques/TA0003/"
        },
        "technique": [
          {
            "id": "T1100",
            "name": "Web Shell",
            "reference": "https://attack.mitre.org/techniques/T1100/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.343Z",
    "updated_at": "2020-03-05T08:16:14.443Z",
    "created_by": "elastic",
    "description": "Nping ran on a Linux host. Nping is part of the Nmap tool suite and has  the ability to construct raw packets for a wide variety of security testing applications, including denial of service testing.",
    "enabled": false,
    "false_positives": [
      "Some normal use of this command may originate from security engineers and network or server administrators, but this is usually not routine or  unannounced. Use of `Nping` by non-engineers or ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "fdedc6ec-9794-4e8e-a6de-42c50f953f08",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0d69150b-96f8-467c-a86d-a67a3378ce77",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Nping Process Activity",
    "query": "process.name: nping and event.action:executed",
    "references": [
      "https://en.wikipedia.org/wiki/Nmap"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.298Z",
    "updated_at": "2020-03-05T08:16:14.394Z",
    "created_by": "elastic",
    "description": "Identifies network activity from unexpected system applications. This may indicate adversarial activity as these applications are often leveraged by adversaries to execute code and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "1c39fb6e-ec54-4d72-986a-1d2d6f8fc1b6",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "610949a1-312f-4e04-bb55-3a79b8c95267",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Unusual Process Network Connection",
    "query": " event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:(bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or Microsoft.Workflow.Compiler.exe or odbcconf.exe or rcsi.exe or xwizard.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities",
            "reference": "https://attack.mitre.org/techniques/T1127/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.318Z",
    "updated_at": "2020-03-05T08:16:14.469Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RPC traffic\nfrom the Internet. RPC is commonly used by system administrators to remotely\ncontrol a system for maintenance or to use shared resources. It should almost\nnever be directly exposed to the Internet, as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "76eae3b6-6343-483a-b8f5-232af7fea254",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "143cb236-0956-4f42-a706-814bcaa0cf5a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "RPC (Remote Procedure Call) from the Internet",
    "query": "network.transport: tcp and destination.port: 135 and (\n    network.direction: inbound or (\n        not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.310Z",
    "updated_at": "2020-03-05T08:16:14.389Z",
    "created_by": "elastic",
    "description": "Identifies use of sc.exe to create, modify, or start services on remote hosts. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "bc5e97fd-686d-4eda-8026-962d3e1ef387",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "e8571d5f-bea1-46c2-9f56-998de2d3ed95",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Local Service Commands",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and  process.name:sc.exe and process.args:(\"create\" or \"config\" or \"failure\" or \"start\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.304Z",
    "updated_at": "2020-03-05T08:16:14.571Z",
    "created_by": "elastic",
    "description": "Identifies mshta.exe making a network connection. This may indicate adversarial activity as mshta.exe is often leveraged by adversaries to execute malicious scripts and evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "d29ede38-4a60-4908-992b-830ad96e2350",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "a4ec1382-4557-452b-89ba-e413b22ed4b8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Network Connection via Mshta",
    "query": "event.action:\"Network connection detected (rule: NetworkConnect)\" and process.name:\"mshta.exe\"",
    "references": [
      "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1170",
            "name": "Mshta",
            "reference": "https://attack.mitre.org/techniques/T1170/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.344Z",
    "updated_at": "2020-03-05T08:16:14.481Z",
    "created_by": "elastic",
    "description": "A netcat process is engaging in network activity on a Linux host. Netcat is often used as a persistence mechanism by exporting a reverse shell or by serving a shell on a listening port. Netcat is also sometimes used for data exfiltration.",
    "enabled": false,
    "false_positives": [
      "Netcat is a dual-use tool that can be used for benign or malicious activity. Netcat is included in some Linux distributions so its presence is not necessarily suspicious. Some normal use of this program, while uncommon, may originate from scripts, automation tools, and frameworks."
    ],
    "from": "now-6m",
    "id": "761099dd-f5bd-4ef5-ba27-b8c768359e21",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "adb961e0-cb74-42a0-af9e-29fc41f88f5f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Netcat Network Activity",
    "query": "process.name: (nc or ncat or netcat or netcat.openbsd or netcat.traditional) and event.action: (connected-to or bound-socket or socket_opened)",
    "references": [
      "http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet",
      "https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf",
      "https://en.wikipedia.org/wiki/Netcat"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.298Z",
    "updated_at": "2020-03-05T08:16:14.439Z",
    "created_by": "elastic",
    "description": "Identifies unexpected processes making network connections over port 445. Windows File Sharing is typically implemented over Server Message Block (SMB), which communicates between hosts using port 445. When legitimate, these network connections are established by the kernel. Processes making 445/tcp connections may be port scanners, exploits, or suspicious user-level processes moving laterally.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "e2a436dd-d8ee-4d15-bd8b-d5ca7674cf7c",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "c82c7d8f-fb9e-4874-a4bd-fd9e3f9becf1",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Direct Outbound SMB Connection",
    "query": " event.action:\"Network connection detected (rule: NetworkConnect)\" and destination.port:445 and   not process.pid:4 and not destination.ip:(\"127.0.0.1\" or \"::1\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1210",
            "name": "Exploitation of Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1210/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.317Z",
    "updated_at": "2020-03-05T08:16:14.543Z",
    "created_by": "elastic",
    "description": "This is an example of how to detect an unwanted web client user agent. This search matches the user agent for sqlmap 1.3.11, which is a popular FOSS tool for testing web applications for SQL injection vulnerabilities.",
    "enabled": false,
    "false_positives": [
      "This rule does not indicate that a SQL injection attack occurred, only that the `sqlmap` tool was used. Security scans and tests may result in these errors. If the source is not an authorized security tester, this is generally suspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "9869a0c9-6b50-4123-8cdd-16181e93e8ea",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "d49cc73f-7a16-4def-89ce-9fc7127d7820",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: sqlmap User Agent",
    "query": "user_agent.original:\"sqlmap/1.3.11#stable (http://sqlmap.org)\"",
    "references": [
      "http://sqlmap.org/"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "APM"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.358Z",
    "updated_at": "2020-03-05T08:16:14.547Z",
    "created_by": "elastic",
    "description": "Identifies suspicious child processes of frequently targeted Microsoft Office applications (Word, PowerPoint, Excel). These child processes are often launched during exploitation of Office applications or from documents with malicious macros.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "be89c8b2-871b-49e2-81f9-9b814f2fef11",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "a624863f-a70d-417f-a7d2-7a404638d47f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious MS Office Child Process",
    "query": " event.action:\"Process Create (rule: ProcessCreate)\" and    process.parent.name:(\"winword.exe\" or \"excel.exe\" or \"powerpnt.exe\" or \"eqnedt32.exe\" or \"fltldr.exe\" or \"mspub.exe\" or \"msaccess.exe\") and process.name:(\"arp.exe\" or \"dsquery.exe\" or \"dsget.exe\" or \"gpresult.exe\" or \"hostname.exe\" or \"ipconfig.exe\" or \"nbtstat.exe\" or \"net.exe\" or \"net1.exe\" or \"netsh.exe\" or \"netstat.exe\" or \"nltest.exe\" or \"ping.exe\" or \"qprocess.exe\" or \"quser.exe\" or \"qwinsta.exe\" or \"reg.exe\" or \"sc.exe\" or \"systeminfo.exe\" or \"tasklist.exe\" or \"tracert.exe\" or \"whoami.exe\" or \"bginfo.exe\" or \"cdb.exe\" or \"cmstp.exe\" or \"csi.exe\" or \"dnx.exe\" or \"fsi.exe\" or \"ieexec.exe\" or \"iexpress.exe\" or \"installutil.exe\" or \"Microsoft.Workflow.Compiler.exe\" or \"msbuild.exe\" or \"mshta.exe\" or \"msxsl.exe\" or \"odbcconf.exe\" or \"rcsi.exe\" or \"regsvr32.exe\" or \"xwizard.exe\" or \"atbroker.exe\" or \"forfiles.exe\" or \"schtasks.exe\" or \"regasm.exe\" or \"regsvcs.exe\" or \"cmd.exe\" or \"cscript.exe\" or \"powershell.exe\" or \"pwsh.exe\" or \"wmic.exe\" or \"wscript.exe\" or \"bitsadmin.exe\" or \"certutil.exe\" or \"ftp.exe\") ",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.345Z",
    "updated_at": "2020-03-05T08:16:14.463Z",
    "created_by": "elastic",
    "description": "Identifies attempts to create new local users. This is sometimes done by attackers to increase access to a system or domain.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "8f9a616c-d810-4359-a173-9f9efaba64d1",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "1aa9181a-492b-4c01-8b16-fa0735786b2b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "User Account Creation",
    "query": " event.action:\"Process Create (rule: ProcessCreate)\" and process.name:(\"net.exe\" or \"net1.exe\") and not process.parent.name:\"net.exe\" and process.args:(\"user\" and (\"/add\" or \"/ad\")) ",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1136",
            "name": "Create Account",
            "reference": "https://attack.mitre.org/techniques/T1136/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.343Z",
    "updated_at": "2020-03-05T08:16:14.473Z",
    "created_by": "elastic",
    "description": "Identifies use of the netsh.exe to disable or weaken the local firewall. Attackers will use this command line tool to disable the firewall during troubleshooting or to enable network mobility.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "6dd80102-27cd-4111-a682-d03c0e062550",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "4b438734-3793-4fda-bd42-ceeada0be8f9",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Disable Windows Firewall Rules via Netsh",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"netsh.exe\" and process.args:(\"firewall\" and \"set\" and \"disable\") or process.args:(\"advfirewall\" and \"state\" and \"off\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools",
            "reference": "https://attack.mitre.org/techniques/T1089/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.356Z",
    "updated_at": "2020-03-05T08:16:14.596Z",
    "created_by": "elastic",
    "description": "This rule detects events that may indicate use of a PPTP VPN connection. Some\nthreat actors use these types of connections to tunnel their traffic while\navoiding detection.\n",
    "enabled": false,
    "false_positives": [
      "Some networks may utilize PPTP protocols but this is uncommon as more modern VPN technologies are available. Usage that is unfamiliar to local network administrators can be unexpected and suspicious. Torrenting applications may use this port. Because this port is in the ephemeral range, this rule may false under certain conditions, such as when an application server replies to a client that used this port by coincidence. This is uncommon but such servers can be excluded."
    ],
    "from": "now-6m",
    "id": "e128f0d2-597c-4e9a-8a45-5533b6913100",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "d2053495-8fe7-4168-b3df-dad844046be3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "PPTP (Point to Point Tunneling Protocol) Activity",
    "query": "network.transport: tcp and destination.port: 1723\n",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.363Z",
    "updated_at": "2020-03-05T08:16:14.556Z",
    "created_by": "elastic",
    "description": "Identifies use of vssadmin.exe for shadow copy deletion on endpoints.  This commonly occurs in tandem with ransomware or other destructive attacks.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "9b2cc1ee-3380-4c45-8387-0d11fe19a6ea",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "b5ea4bfe-a1b2-421f-9d47-22a75a6f2921",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Volume Shadow Copy Deletion via VssAdmin",
    "query": "  event.action:\"Process Create (rule: ProcessCreate)\"  and process.name:\"vssadmin.exe\" and process.args:(\"delete\" and \"shadows\") ",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery",
            "reference": "https://attack.mitre.org/techniques/T1490/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.319Z",
    "updated_at": "2020-03-05T08:16:14.465Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Permission Theft. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "b287eb36-2545-4064-9a10-b44c5558ebb3",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "453f659e-0429-40b1-bfdb-b6957286e04b",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Permission Theft - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:token_protection_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.295Z",
    "updated_at": "2020-03-05T08:16:14.552Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected an Exploit. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "e276afbb-c56e-4994-9789-c30ddfa6540e",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "2003cdc8-8d83-4aa5-b132-1f9a8eb48514",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Exploit - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:exploit_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.294Z",
    "updated_at": "2020-03-05T08:16:14.395Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Credential Dumping. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "4044e090-20b6-4baf-895b-74c138ad8e26",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "db8c33a8-03cd-4988-9e2c-d0a4863adb13",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Credential Dumping - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:cred_theft_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.297Z",
    "updated_at": "2020-03-05T08:16:14.470Z",
    "created_by": "elastic",
    "description": "Identifies use of the fsutil.exe to delete the volume USNJRNL. This technique is used by attackers to eliminate evidence of files created during post-exploitation activities.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "df4dd99f-a92c-4124-a010-85cbdd978d8e",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "f675872f-6d85-40a3-b502-c0d2ef101e92",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Delete Volume USN Journal with Fsutil",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\"  and   process.name:\"fsutil.exe\" and    process.args:(\"usn\" and \"deletejournal\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.342Z",
    "updated_at": "2020-03-05T08:16:14.442Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Malware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "4741cebb-45a5-416b-b8ce-5bb59ed754bb",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "0a97b20f-4144-49ea-be32-b540ecc445de",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 99,
    "name": "Malware - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:file_classification_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "critical",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.347Z",
    "updated_at": "2020-03-05T08:16:14.471Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Ransomware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "85288ad5-0866-4371-8b4a-f029d4288c94",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "e3c5d5cb-41d5-4206-805c-f30561eae3ac",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Ransomware - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:ransomware_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.359Z",
    "updated_at": "2020-03-05T08:16:14.581Z",
    "created_by": "elastic",
    "description": "Identifies scrobj.dll loaded into unusual Microsoft processes. This may indicate a malicious scriptlet is being executed in the target process.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "5fcffca0-d68d-4461-ad6d-d476ed680b41",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "b7333d08-be4b-4cb4-b81e-924ae37b3143",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious Script Object Execution",
    "query": "event.code: 1 and scrobj.dll and (process.name:certutil.exe or process.name:regsvr32.exe or process.name:rundll32.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1064",
            "name": "Scripting",
            "reference": "https://attack.mitre.org/techniques/T1064/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1064",
            "name": "Scripting",
            "reference": "https://attack.mitre.org/techniques/T1064/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.339Z",
    "updated_at": "2020-03-05T08:16:14.441Z",
    "created_by": "elastic",
    "description": "Identifies the use of certutil.exe to encode or decode data. CertUtil is a native Windows component which is part of Certificate Services. CertUtil is often abused by attackers to encode or decode base64 data for stealthier command and control or exfiltration.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "6d178e4c-5a62-489d-92c9-689bf14a9822",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fd70c98a-c410-42dc-a2e3-761c71848acf",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Encoding or Decoding Files via CertUtil",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and    process.name:\"certutil.exe\" and    process.args:(\"-encode\" or \"/encode\" or \"-decode\" or \"/decode\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information",
            "reference": "https://attack.mitre.org/techniques/T1140/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.349Z",
    "updated_at": "2020-03-05T08:16:14.464Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected an Adversary Behavior. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "4282d910-067d-4da6-8eae-9e1ae61e1308",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "77a3c3df-8ec4-4da4-b758-878f551dee69",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Adversary Behavior - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:rules_engine_event",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.294Z",
    "updated_at": "2020-03-05T08:16:14.392Z",
    "created_by": "elastic",
    "description": "A POST request to web application returned a 403 response, which indicates the web application declined to process the request because the action requested was not allowed",
    "enabled": false,
    "false_positives": [
      "Security scans and tests may result in these errors. Misconfigured or buggy applications may produce large numbers of these errors. If the source is unexpected, the user unauthorized, or the request unusual, these may indicate suspicious or malicious activity."
    ],
    "from": "now-6m",
    "id": "98ee80de-3054-4fce-a73d-6adc91abfe4f",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "a87a4e42-1d82-44bd-b0bf-d9b7f91fb89e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: POST Request Declined",
    "query": "http.response.status_code:403 and http.request.method:post",
    "references": [
      "https://en.wikipedia.org/wiki/HTTP_403"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "APM"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.320Z",
    "updated_at": "2020-03-05T08:16:14.568Z",
    "created_by": "elastic",
    "description": "Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over the DNS protocol to circumvent firewalls, network security groups, and network access lists while evading detection.",
    "enabled": false,
    "false_positives": [
      "Normal use of Iodine is uncommon apart from security testing and research. Use by non-security engineers is very uncommon."
    ],
    "from": "now-6m",
    "id": "7246a6ee-4d72-40c5-8746-35da12a6b73b",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "041d4d41-9589-43e2-ba13-5680af75ebc2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Potential DNS Tunneling via Iodine",
    "query": "process.name: (iodine or iodined) and event.action:executed",
    "references": [
      "https://code.kryo.se/iodine/"
    ],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.340Z",
    "updated_at": "2020-03-05T08:16:14.472Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of Telnet traffic.\nTelnet is commonly used by system administrators to remotely control older or embed ed\nsystems using the command line shell. It should almost never be directly exposed to\nthe Internet, as it is frequently targeted and exploited by threat actors as an\ninitial access or back-door vector. As a plain-text protocol, it may also expose\nusernames and passwords to anyone capable of observing the traffic.\n",
    "enabled": false,
    "false_positives": [
      "IoT (Internet of Things) devices and networks may use telnet and can be excluded if\n    desired. Some business work-flows may use Telnet for administration of older devices. These\n    often have a predictable behavior. Telnet activity involving an unusual source or destination\n    may be more suspicious. Telnet activity involving a production server that has no known\n    associated Telnet work-flow or business requirement is often suspicious."
    ],
    "from": "now-6m",
    "id": "e052fcf8-b7e0-4a3d-9937-d32115cf8ab2",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "34fde489-94b0-4500-a76f-b8a157cf9269",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Telnet Port Activity",
    "query": "network.transport: tcp and destination.port: 23",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.337Z",
    "updated_at": "2020-03-05T08:16:14.541Z",
    "created_by": "elastic",
    "description": "Identifies attempts to clear Windows event log stores. This is often done by attackers in an attempt to evade detection or destroy forensic evidence on a system.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "290a650b-4145-4b99-91f3-2d71e0ec34b0",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "d331bbe2-6db4-4941-80a5-8270db72eb61",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Clearing Windows Event Logs",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and (process.name:\"wevtutil.exe\" and process.args:\"cl\") or (process.name:\"powershell.exe\" and process.args:\"Clear-EventLog\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host",
            "reference": "https://attack.mitre.org/techniques/T1070/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.354Z",
    "updated_at": "2020-03-05T08:16:14.548Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Process Injection. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "d0c4bd1c-fd4a-45e0-a307-0e6f48931861",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "80c52164-c82a-402c-9964-852533d58be1",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Process Injection - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:kernel_shellcode_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.310Z",
    "updated_at": "2020-03-05T08:16:14.393Z",
    "created_by": "elastic",
    "description": "A scheduled task can be used by an adversary to establish persistence, move laterally, and/or escalate privileges.",
    "enabled": false,
    "false_positives": [
      "Legitimate scheduled tasks may be created during installation of new software."
    ],
    "from": "now-6m",
    "id": "8fa7f116-95c5-43ac-bd8d-762d29b0a394",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "afcce5ad-65de-4ed2-8516-5e093d3ac99a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Local Scheduled Task Commands",
    "query": " event.action:\"Process Create (rule: ProcessCreate)\" and process.name:schtasks.exe and process.args:(\"/create\" or \"-create\" or \"/S\" or \"-s\" or \"/run\" or \"-run\" or \"/change\" or \"-change\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1053",
            "name": "Scheduled Task",
            "reference": "https://attack.mitre.org/techniques/T1053/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.351Z",
    "updated_at": "2020-03-05T08:16:14.546Z",
    "created_by": "elastic",
    "description": "The Linux mknod program is sometimes used in the command payload of a remote command injection (RCI) and other exploits. It is used to export a command  shell when the traditional version of netcat is not available to the payload.",
    "enabled": false,
    "false_positives": [
      "Mknod is a Linux system program. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. Usage by web servers is more likely to be suspicious."
    ],
    "from": "now-6m",
    "id": "b97932f7-acfe-4da2-b0a7-593dd112e7a8",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "61c31c14-507f-4627-8c31-072556b89a9c",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Mknod Process Activity",
    "query": "process.name: mknod and event.action:executed",
    "references": [
      "https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.362Z",
    "updated_at": "2020-03-05T08:16:14.582Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of SSH traffic\nfrom the Internet. SSH is commonly used by system administrators to remotely\ncontrol a system using the command line shell. If it is exposed to the Internet,\nit should be done with strong security controls as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [
      "SSH connections may be made directly to Internet destinations in order to access Linux\n    cloud server instances but such connections are usually made only by engineers. In such cases,\n    only SSH gateways, bastions or jump servers may be expected Internet destinations and can be\n    exempted from this rule. SSH may be required by some work-flows such as remote access and support\n    for specialized software products and servers. Such work-flows are usually known and not unexpected.\n    Usage that is unfamiliar to server or network owners can be unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "d3beb080-f063-47cc-b513-26e00bbe31e4",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "6f1500bc-62d7-4eb9-8601-7485e87da2f4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "SSH (Secure Shell) to the Internet",
    "query": "network.transport: tcp and destination.port:22 and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.355Z",
    "updated_at": "2020-03-05T08:16:14.566Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Permission Theft. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "80717dba-691c-4707-92f9-97b682a1124f",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "c3167e1b-f73c-41be-b60b-87f4df707fe3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Permission Theft - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:token_protection_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.365Z",
    "updated_at": "2020-03-05T08:16:14.540Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Ransomware. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "eab14943-b9df-45c7-8993-0469def4bc2b",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "8cb4f625-7743-4dfb-ae1b-ad92be9df7bd",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 99,
    "name": "Ransomware - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:ransomware_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "critical",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.360Z",
    "updated_at": "2020-03-05T08:16:14.584Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Credential Dumping. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "26a77f6d-9faa-4523-a925-4df4b8c522f7",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "571afc56-5ed9-465d-a2a9-045f099f6e7e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Credential Dumping - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:cred_theft_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.361Z",
    "updated_at": "2020-03-05T08:16:14.551Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint detected Credential Manipulation. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "34b8dbb9-8f45-4650-91cc-a1ac646ed285",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "c0be5f31-e180-48ed-aa08-96b36899d48f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Credential Manipulation - Detected - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:token_manipulation_event and endgame.metadata.type:detection",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.318Z",
    "updated_at": "2020-03-05T08:16:14.542Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious process being spawned from a script interpreter, which could be indicative of a potential phishing attack.",
    "enabled": false,
    "false_positives": [
      "Security testing may produce events like this. Activity of this kind performed by non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "547f0dd9-c402-4b7c-8aef-41f0e2a9824d",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "89db767d-99f9-479f-8052-9205fd3090c4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Suspicious Process spawning from Script Interpreter",
    "query": "(process.parent.name:cmd.exe or process.parent.name:cscript.exe or process.parent.name:mshta.exe or process.parent.name:powershell.exe or process.parent.name:rundll32.exe or process.parent.name:wscript.exe or process.parent.name:wmiprvse.exe) and (process.name:bitsadmin.exe or process.name:certutil.exe or mshta.exe or process.name:nslookup.exe or process.name:schtasks.exe) and event.code:1",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1064",
            "name": "Scripting",
            "reference": "https://attack.mitre.org/techniques/T1064/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1064",
            "name": "Scripting",
            "reference": "https://attack.mitre.org/techniques/T1064/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.365Z",
    "updated_at": "2020-03-05T08:16:14.564Z",
    "created_by": "elastic",
    "description": "Nmap was executed on a Linux host. Nmap is a FOSS tool for network scanning  and security testing. It can map and discover networks, and identify listening  services and operating systems. It is sometimes used to gather information in  support of exploitation, execution or lateral movement.",
    "enabled": false,
    "false_positives": [
      "Security testing tools and frameworks may run `Nmap` in the course of security auditing. Some normal use of this command may originate from security engineers and network or server administrators. Use of nmap by ordinary users is uncommon."
    ],
    "from": "now-6m",
    "id": "82895ba7-f9e5-4c75-867e-ea193b967b1b",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "c87fca17-b3a9-4e83-b545-f30746c53920",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Nmap Process Activity",
    "query": "process.name: nmap",
    "references": [
      "https://en.wikipedia.org/wiki/Nmap"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.361Z",
    "updated_at": "2020-03-05T08:16:14.553Z",
    "created_by": "elastic",
    "description": "Identifies use of whoami.exe which displays user, group, and privileges information for the user who is currently logged on to the local system.",
    "enabled": false,
    "false_positives": [
      "Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools and frameworks. Usage by non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "0d32b89b-5a3a-4d4a-843d-e439cb4f4b01",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "ef862985-3f13-4262-a686-5f357bbb9bc2",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Whoami Process Activity",
    "query": "process.name:whoami.exe and event.code:1",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery",
            "reference": "https://attack.mitre.org/techniques/T1033/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.293Z",
    "updated_at": "2020-03-05T08:16:14.440Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Credential Manipulation. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "3b36a6ca-4110-47fe-affa-a8fb3cf0fb23",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "c9e38e64-3f4c-4bf3-ad48-0e61a60ea1fa",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Credential Manipulation - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:token_manipulation_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.366Z",
    "updated_at": "2020-03-05T08:16:14.468Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented an Exploit. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "797046d4-0d5d-4392-a972-985f0d655585",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "2863ffeb-bf77-44dd-b7a5-93ef94b72036",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Exploit - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:exploit_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.312Z",
    "updated_at": "2020-03-05T08:16:14.391Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of VNC traffic\nto the Internet. VNC is commonly used by system administrators to remotely\ncontrol a system for maintenance or to use shared resources. It should almost\nnever be directly exposed to the Internet, as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.",
    "enabled": false,
    "false_positives": [
      "VNC connections may be made directly to Linux cloud server instances but such\n    connections are usually made only by engineers. VNC is less common than SSH or RDP\n    but may be required by some work flows such as remote access and support for\n    specialized software products or servers. Such work-flows are usually known and not\n    unexpected. Usage that is unfamiliar to server or network owners can be unexpected\n    and suspicious."
    ],
    "from": "now-6m",
    "id": "5fc84697-38a1-416c-a99f-5778eb80e242",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "3ad49c61-7adc-42c1-b788-732eda2f5abf",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "VNC (Virtual Network Computing) to the Internet",
    "query": "network.transport: tcp and (destination.port >= 5800 and destination.port <= 5810) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1219",
            "name": "Remote Access Tools",
            "reference": "https://attack.mitre.org/techniques/T1219/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:14.299Z",
    "updated_at": "2020-03-05T08:16:14.476Z",
    "created_by": "elastic",
    "description": "Identifies use of wmic.exe for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "1df098f5-9014-44ed-9542-c0e25680f742",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "dc9c1f74-dac3-48e3-b47f-eb79db358f57",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "Volume Shadow Copy Deletion via WMIC",
    "query": "  event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"WMIC.exe\" and process.args:(\"shadowcopy\" and \"delete\")",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.296Z",
    "updated_at": "2020-03-05T08:16:14.396Z",
    "created_by": "elastic",
    "description": "Adversaries may attempt to get information about running processes on a system.",
    "enabled": false,
    "false_positives": [
      "Administrators may use the tasklist command to display a list of currently running processes. By itself, it does not indicate malicious activity. After obtaining a foothold, it's possible adversaries may use discovery commands like tasklist to get information about running processes."
    ],
    "from": "now-6m",
    "id": "f43ca56f-4d47-41bb-9368-9c7af2f99343",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "cc16f774-59f9-462d-8b98-d27ccd4519ec",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Process Discovery via Tasklist",
    "query": "event.code:1 and process.name:tasklist.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1057",
            "name": "Process Discovery",
            "reference": "https://attack.mitre.org/techniques/T1057/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:14.339Z",
    "updated_at": "2020-03-05T08:16:14.474Z",
    "created_by": "elastic",
    "description": "This rule detects events that may describe database traffic\n(MS SQL, Oracle, MySQL, and Postgresql) across the Internet. Databases\nshould almost never be directly exposed to the Internet, as they are\nfrequently targeted by threat actors to gain initial access to network resources.\n",
    "enabled": false,
    "false_positives": [
      "Because these ports are in the ephemeral range, this rule may false under certain conditions\n    such as when a NATed web server replies to a client which has used a port in the range by\n    coincidence. In this case, such servers can be excluded if desired. Some cloud environments may\n    use this port when VPNs or direct connects are not in use and database instances are accessed\n    directly across the Internet."
    ],
    "from": "now-6m",
    "id": "f2dfc381-268c-4826-9143-9dbe9ff786ee",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "139c7458-566a-410c-a5cd-f80238d6a5cd",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "SQL Traffic to the Internet",
    "query": "network.transport: tcp and destination.port: (1433 or 1521 or 3336 or 5432) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.118Z",
    "updated_at": "2020-03-05T08:16:15.148Z",
    "created_by": "elastic",
    "description": "Identifies the native Windows tools regsvr32.exe and regsvr64.exe making a network connection.  This may be indicative of an attacker bypassing whitelisting or running arbitrary scripts via a signed Microsoft binary.",
    "enabled": false,
    "false_positives": [
      "Security testing may produce events like this. Activity of this kind performed by non-engineers and ordinary users is unusual."
    ],
    "from": "now-6m",
    "id": "776cce56-5dc9-4d2b-8317-91c480a3931b",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fb02b8d3-71ee-4af1-bacd-215d23f17efa",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Regsvr",
    "query": "(process.name:regsvr32.exe or process.name:regsvr64.exe) and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:169.254.169.254/32 and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1117",
            "name": "Regsvr32",
            "reference": "https://attack.mitre.org/techniques/T1117/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1117",
            "name": "Regsvr32",
            "reference": "https://attack.mitre.org/techniques/T1117/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.117Z",
    "updated_at": "2020-03-05T08:16:15.151Z",
    "created_by": "elastic",
    "description": "Windows contains accessibility features that may be launched with a key combination before a user has logged in. An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "f7ccded6-e1b6-44e7-9bd4-be836956bd97",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "7405ddf1-6c8e-41ce-818f-48bea6bcaed8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Potential Modification of Accessibility Binaries",
    "query": "event.code:1 and process.parent.name:winlogon.exe and (process.name:atbroker.exe or process.name:displayswitch.exe or process.name:magnify.exe or process.name:narrator.exe or process.name:osk.exe or process.name:sethc.exe or process.name:utilman.exe)",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1015",
            "name": "Accessibility Features",
            "reference": "https://attack.mitre.org/techniques/T1015/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1015",
            "name": "Accessibility Features",
            "reference": "https://attack.mitre.org/techniques/T1015/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.126Z",
    "updated_at": "2020-03-05T08:16:15.164Z",
    "created_by": "elastic",
    "description": "Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (hh.exe).",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "8ddb5ac0-a949-4242-811c-8d8a994b7425",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "b29ee2be-bf99-446c-ab1a-2dc0183394b8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Connection via Compiled HTML File",
    "query": "process.name:hh.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1223",
            "name": "Compiled HTML File",
            "reference": "https://attack.mitre.org/techniques/T1223/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.127Z",
    "updated_at": "2020-03-05T08:16:15.172Z",
    "created_by": "elastic",
    "description": "The Application Shim was created to allow for backward compatibility of software as the operating system codebase changes over time. This Windows functionality has been abused by attackers to stealthily gain persistence and arbitrary code execution in legitimate Windows processes.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "a95a1a64-7fa0-4390-ac1e-df18ceeaa9f9",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "fd4a992d-6130-4802-9ff8-829b89ae801f",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Potential Application Shimming via Sdbinst",
    "query": "event.code:1 and process.name:sdbinst.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1138",
            "name": "Application Shimming",
            "reference": "https://attack.mitre.org/techniques/T1138/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0004",
          "name": "Privilege Escalation",
          "reference": "https://attack.mitre.org/tactics/TA0004/"
        },
        "technique": [
          {
            "id": "T1138",
            "name": "Application Shimming",
            "reference": "https://attack.mitre.org/techniques/T1138/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.122Z",
    "updated_at": "2020-03-05T08:16:15.149Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RPC traffic\nto the Internet. RPC is commonly used by system administrators to remotely\ncontrol a system for maintenance or to use shared resources. It should almost\nnever be directly exposed to the Internet, as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "78f825c3-5117-4cfe-b1c0-4ec9342df940",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "32923416-763a-4531-bb35-f33b9232ecdb",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "RPC (Remote Procedure Call) to the Internet",
    "query": "network.transport: tcp and destination.port: 135 and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.123Z",
    "updated_at": "2020-03-05T08:16:15.157Z",
    "created_by": "elastic",
    "description": "This rule detects events that may describe SMTP traffic from internal\nhosts to a host across the Internet. In an enterprise network, there is typically\na dedicated internal host that performs this function. It is also\nfrequently abused by threat actors for command and control, or data exfiltration.\n",
    "enabled": false,
    "false_positives": [
      "NATed servers that process email traffic may false and should be excluded from this rule as this is expected behavior for them. Consumer and  personal devices may send email traffic to remote Internet destinations. In this case, such devices or networks can be excluded from this rule if this is expected behavior."
    ],
    "from": "now-6m",
    "id": "20d7581d-815d-495d-a612-25ac6d3b497b",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "67a9beba-830d-4035-bfe8-40b7e28f8ac4",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "SMTP to the Internet",
    "query": "network.transport: tcp and destination.port: (25 or 465 or 587) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.125Z",
    "updated_at": "2020-03-05T08:16:15.185Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of RDP traffic\nfrom the Internet. RDP is commonly used by system administrators to remotely\ncontrol a system for maintenance or to use shared resources. It should almost\nnever be directly exposed to the Internet, as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [
      "  Some network security policies allow RDP directly from the Internet but usage that is unfamiliar to\n  server or network owners can be unexpected and suspicious. RDP services may be exposed directly to the\n  Internet in some networks such as cloud environments. In such cases, only RDP gateways, bastions or jump\n  servers may be expected expose RDP directly to the Internet and can be exempted from this rule. RDP may\n  be required by some work-flows such as remote access and support for specialized software products and\n  servers. Such work-flows are usually known and not unexpected."
    ],
    "from": "now-6m",
    "id": "58dbe9fc-5c66-4e3e-bd87-ec2b14521667",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "8c1bdde8-4204-45c0-9e0c-c85ca3902488",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "RDP (Remote Desktop Protocol) from the Internet",
    "query": "network.transport: tcp and destination.port: 3389 and (\n    network.direction: inbound or (\n        not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n        and destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0008",
          "name": "Lateral Movement",
          "reference": "https://attack.mitre.org/tactics/TA0008/"
        },
        "technique": [
          {
            "id": "T1021",
            "name": "Remote Services",
            "reference": "https://attack.mitre.org/techniques/T1021/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.128Z",
    "updated_at": "2020-03-05T08:16:15.184Z",
    "created_by": "elastic",
    "description": "Windows services typically run as SYSTEM and can be used as a privilege escalation opportunity. Malware or penetration testers may run a shell as a service to gain SYSTEM permissions.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "cf505bb2-996f-4110-81f3-b4ec741a7ed7",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0022d47d-39c7-4f69-a232-4fe9dc7a3acd",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "System Shells via Services",
    "query": " event.action:\"Process Create (rule: ProcessCreate)\" and    process.parent.name:\"services.exe\" and    process.name:(\"cmd.exe\" or \"powershell.exe\")",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1050",
            "name": "New Service",
            "reference": "https://attack.mitre.org/techniques/T1050/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.129Z",
    "updated_at": "2020-03-05T08:16:15.177Z",
    "created_by": "elastic",
    "description": "Identifies a PowerShell process launched by either cscript.exe or wscript.exe. Observing Windows scripting processes executing a PowerShell script, may be indicative of malicious activity.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "24c49a85-a1d7-4de6-b3f4-3e6b55e4e429",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "f545ff26-3c94-4fd0-bd33-3c7f95a3a0fc",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Windows Script Executing PowerShell",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(\"wscript.exe\" or \"cscript.exe\") and process.name:\"powershell.exe\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.121Z",
    "updated_at": "2020-03-05T08:16:15.154Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of Windows\nfile sharing (also called SMB or CIFS) traffic to the Internet. SMB is commonly\nused within networks to share files, printers, and other system resources amongst\ntrusted systems. It should almost never be directly exposed to the Internet, as\nit is frequently targeted and exploited by threat actors as an initial access\nor back-door vector or for data exfiltration.\n",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "a2a19d1d-39df-41fc-822f-f70f959436a9",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "c82b2bd8-d701-420c-ba43-f11a155b681a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "SMB (Windows File Sharing) Activity to the Internet",
    "query": "network.transport: tcp and destination.port: (139 or 445) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0010/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.119Z",
    "updated_at": "2020-03-05T08:16:15.150Z",
    "created_by": "elastic",
    "description": "This rule detects events that could be describing IPSEC NAT Traversal traffic.\nIPSEC is a VPN technology that allows one system to talk to another using\nencrypted tunnels. NAT Traversal enables these tunnels to communicate over the\nInternet where one of the sides is behind a NAT router gateway. This may be\ncommon on your network, but this technique is also used by threat actors to\navoid detection.\n",
    "enabled": false,
    "false_positives": [
      "Some networks may utilize these protocols but usage that is unfamiliar to local network administrators can be unexpected and suspicious. Because this port is in the ephemeral range, this rule may false under certain conditions, such as when an application server with a public IP address replies to a client which has used a UDP port in the range by coincidence. This is uncommon but such servers can be excluded."
    ],
    "from": "now-6m",
    "id": "b75cab20-0904-4b8f-8800-c6df2ddf785e",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "a9cb3641-ff4b-4cdc-a063-b4b8d02a67c7",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "IPSEC NAT Traversal Port Activity",
    "query": "network.transport: udp and destination.port: 4500",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.124Z",
    "updated_at": "2020-03-05T08:16:15.161Z",
    "created_by": "elastic",
    "description": "The Tcpdump program ran on a Linux host. Tcpdump is a network monitoring or packet sniffing tool that can be used to capture insecure credentials or data in motion. Sniffing can also be used to discover details of network services as a prelude to lateral movement or defense evasion.",
    "enabled": false,
    "false_positives": [
      "Some normal use of this command may originate from server or network administrators engaged in network troubleshooting."
    ],
    "from": "now-6m",
    "id": "b5248b93-0556-46f1-84ae-d207aac9d45a",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "7a137d76-ce3d-48e2-947d-2747796a78c0",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Network Sniffing via Tcpdump",
    "query": "process.name: tcpdump and event.action:executed",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1040",
            "name": "Network Sniffing",
            "reference": "https://attack.mitre.org/techniques/T1040/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0007",
          "name": "Discovery",
          "reference": "https://attack.mitre.org/tactics/TA0007/"
        },
        "technique": [
          {
            "id": "T1040",
            "name": "Network Sniffing",
            "reference": "https://attack.mitre.org/techniques/T1040/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.127Z",
    "updated_at": "2020-03-05T08:16:15.167Z",
    "created_by": "elastic",
    "description": "This rule detects when an internal network client sends DNS traffic directly to the Internet.\nThis is atypical behavior for a managed network, and can be indicative of malware,\nexfiltration, command and control, or, simply, misconfiguration. This DNS activity also impacts your\norganization's ability to provide enterprise monitoring and logging of DNS, and opens\nyour network to a variety of abuses and malicious communications.\n",
    "enabled": false,
    "false_positives": [
      "Exclude DNS servers from this rule as this is expected behavior. Endpoints usually query local DNS servers defined in their DHCP scopes, but this may be overridden if a user configures their endpoint to use a remote DNS server. This is uncommon in managed enterprise networks because it could break intranet name resolution when split horizon DNS is utilized. Some consumer VPN services and browser plug-ins may send DNS traffic to remote Internet destinations. In that case, such devices or networks can be excluded from this rule when this is expected behavior."
    ],
    "from": "now-6m",
    "id": "3a333e55-5223-443a-9038-b13e3646f22d",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "6ea71ff0-9e95-475b-9506-2580d1ce6154",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "DNS Activity to the Internet",
    "query": "destination.port:53 and (\n    network.direction: outbound or (\n        source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip:( 169.254.169.254/32 or 127.0.0.53/32 or 10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or ff02\\:\\:fb or 255.255.255.255 )\n    )\n)\n",
    "references": [
      "https://www.us-cert.gov/ncas/alerts/TA15-240A",
      "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.124Z",
    "updated_at": "2020-03-05T08:16:15.158Z",
    "created_by": "elastic",
    "description": "This rule detects events that may describe network events of proxy use to the\nInternet. It includes popular HTTP proxy ports and SOCKS proxy ports. Typically,\nenvironments will use an internal IP address for a proxy server. It can also\nbe used to circumvent network controls and detection mechanisms.\n",
    "enabled": false,
    "false_positives": [
      "Some proxied applications may use these ports but this usually occurs in local traffic using private IPs\n    which this rule does not match. Proxies are widely used as a security technology but in enterprise environments\n    this is usually local traffic which this rule does not match. Internet proxy services using these ports can be\n    white-listed if desired. Some screen recording applications may use these ports. Proxy port activity involving\n    an unusual source or destination may be more suspicious. Some cloud environments may use this port when VPNs or\n    direct connects are not in use and cloud instances are accessed across the Internet. Because these ports are in\n    the ephemeral range, this rule may false under certain conditions such as when a NATed web server replies to a\n    client which has used a port in the range by coincidence. In this case, such servers can be excluded if desired."
    ],
    "from": "now-6m",
    "id": "e2265081-afaa-49fa-b423-5a1fc22e2ea8",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "ad0e5e75-dd89-4875-8d0a-dfdc1828b5f3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Proxy Port Activity to the Internet",
    "query": "network.transport: tcp and destination.port: (3128 or 8080 or 1080) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.129Z",
    "updated_at": "2020-03-05T08:16:15.179Z",
    "created_by": "elastic",
    "description": "A request to a web application server contained no identifying user agent string.",
    "enabled": false,
    "false_positives": [
      "Some normal applications and scripts may contain no user agent. Most legitimate web requests from the Internet contain a user agent string. Requests from web browsers almost always contain a user agent string. If the source is unexpected, the user unauthorized, or the request unusual, these may indicate suspicious or malicious activity."
    ],
    "filters": [
      {
        "$state": {
          "store": "appState"
        },
        "exists": {
          "field": "user_agent.original"
        },
        "meta": {
          "disabled": false,
          "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
          "key": "user_agent.original",
          "negate": true,
          "type": "exists",
          "value": "exists"
        }
      }
    ],
    "from": "now-6m",
    "id": "68abb611-d9aa-4105-b3c0-d3499bd944ae",
    "immutable": true,
    "index": [
      "apm-*-transaction*"
    ],
    "interval": "5m",
    "rule_id": "43303fd4-4839-4e48-b2b2-803ab060758d",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Web Application Suspicious Activity: No User Agent",
    "query": "url.path: *",
    "references": [
      "https://en.wikipedia.org/wiki/User_agent"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "APM"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.334Z",
    "updated_at": "2020-03-05T08:16:15.355Z",
    "created_by": "elastic",
    "description": "Identifies use of the wbadmin.exe to delete the backup catalog. Ransomware and other malware may do this to prevent system recovery.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "043de08b-660e-49ae-adea-7d9bcd08cab1",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "581add16-df76-42bb-af8e-c979bfb39a59",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Deleting Backup Catalogs with Wbadmin",
    "query": "event.action:\"Process Create (rule: ProcessCreate)\"  and process.name:\"wbadmin.exe\" and  process.args:(\"delete\" and \"catalog\")",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1107",
            "name": "File Deletion",
            "reference": "https://attack.mitre.org/techniques/T1107/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.336Z",
    "updated_at": "2020-03-05T08:16:15.357Z",
    "created_by": "elastic",
    "description": "This rule detects events that use common ports for Internet Relay Chat (IRC) to the Internet.\nIRC is a common protocol that can be used for chat and file transfers. This\nprotocol is also a good candidate for remote control of malware and data\ntransfers to and from a network.\n",
    "enabled": false,
    "false_positives": [
      "IRC activity may be normal behavior for developers and engineers but is unusual for non-engineering end users. IRC activity involving an unusual source or destination may be more suspicious. IRC activity involving a production server is often suspicious. Because these ports are in the ephemeral range, this rule may false under certain conditions, such as when a NAT-ed web server replies to a client which has used a port in the range by coincidence. In this case, these servers can be excluded. Some legacy applications may use these ports, but this is very uncommon and usually only appears in local traffic using private IPs, which does not match this rule's conditions."
    ],
    "from": "now-6m",
    "id": "317f378f-e296-4b86-8edc-01477139d877",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "c6474c34-4953-447a-903e-9fcb7b6661aa",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "IRC (Internet Relay Chat) Protocol Activity to the Internet",
    "query": "network.transport: tcp and destination.port:(6667 or 6697) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.335Z",
    "updated_at": "2020-03-05T08:16:15.356Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of VNC traffic\nfrom the Internet. VNC is commonly used by system administrators to remotely\ncontrol a system for maintenance or to use shared resources. It should almost\nnever be directly exposed to the Internet, as it is frequently targeted and\nexploited by threat actors as an initial access or back-door vector.\n",
    "enabled": false,
    "false_positives": [
      "VNC connections may be received directly to Linux cloud server instances but\n    such connections are usually made only by engineers. VNC is less common than SSH\n    or RDP but may be required by some work-flows such as remote access and support\n    for specialized software products or servers. Such work-flows are usually known\n    and not unexpected. Usage that is unfamiliar to server or network owners can be\n    unexpected and suspicious."
    ],
    "from": "now-6m",
    "id": "7930d555-5195-42e2-9393-4ad663e14d18",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "5700cb81-df44-46aa-a5d7-337798f53eb8",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 73,
    "name": "VNC (Virtual Network Computing) from the Internet",
    "query": "network.transport: tcp and (destination.port >= 5800 and destination.port <= 5810) and (\n    network.direction: inbound or (\n        not source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "high",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1219",
            "name": "Remote Access Tools",
            "reference": "https://attack.mitre.org/techniques/T1219/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0001",
          "name": "Initial Access",
          "reference": "https://attack.mitre.org/tactics/TA0001/"
        },
        "technique": [
          {
            "id": "T1190",
            "name": "Exploit Public-Facing Application",
            "reference": "https://attack.mitre.org/techniques/T1190/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.336Z",
    "updated_at": "2020-03-05T08:16:15.358Z",
    "created_by": "elastic",
    "description": "Identifies cmd.exe making a network connection. Adversaries could abuse cmd.exe to download or execute malware from a remote URL.",
    "enabled": false,
    "false_positives": [
      "Administrators may use the command prompt for regular administrative tasks. It's important to baseline your environment for network connections being made from the command prompt to determine any abnormal use of this tool."
    ],
    "from": "now-6m",
    "id": "6bca459d-afb6-4806-9027-a1ac12f7f4ab",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "89f9a4b0-9f8f-4ee0-8823-c4751a6d6696",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Command Prompt Network Connection",
    "query": "process.name:cmd.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1105",
            "name": "Remote File Copy",
            "reference": "https://attack.mitre.org/techniques/T1105/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.338Z",
    "updated_at": "2020-03-05T08:16:15.365Z",
    "created_by": "elastic",
    "description": "Elastic Endpoint prevented Process Injection. Click the Elastic Endpoint icon in the event.module column or the link in the rule.reference column in the External Alerts tab of the SIEM Detections page for additional information.",
    "enabled": false,
    "false_positives": [],
    "from": "now-660s",
    "id": "131e179d-2bc8-4314-a9a2-a8bd64e9d640",
    "immutable": true,
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "rule_id": "990838aa-a953-4f3e-b3cb-6ddf7584de9e",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Process Injection - Prevented - Elastic Endpoint",
    "query": "event.kind:alert and event.module:endgame and event.action:kernel_shellcode_event and endgame.metadata.type:prevention",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Endpoint"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.337Z",
    "updated_at": "2020-03-05T08:16:15.366Z",
    "created_by": "elastic",
    "description": "Identifies a suspicious parent child process relationship with cmd.exe descending from PowerShell.exe.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "0744af9f-09eb-44cb-abc0-db80241a336b",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "0f616aee-8161-4120-857e-742366f5eeb3",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "PowerShell spawning Cmd",
    "query": "process.parent.name:powershell.exe and process.name:cmd.exe",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1059",
            "name": "Command-Line Interface",
            "reference": "https://attack.mitre.org/techniques/T1059/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0002",
          "name": "Execution",
          "reference": "https://attack.mitre.org/tactics/TA0002/"
        },
        "technique": [
          {
            "id": "T1086",
            "name": "PowerShell",
            "reference": "https://attack.mitre.org/techniques/T1086/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.339Z",
    "updated_at": "2020-03-05T08:16:15.367Z",
    "created_by": "elastic",
    "description": "Adversaries can add the 'hidden' attribute to files to hide them from the user in an attempt to evade detection.",
    "enabled": false,
    "false_positives": [],
    "from": "now-6m",
    "id": "f5c6e6c0-8464-4c8a-8a70-8611868c6c2b",
    "immutable": true,
    "index": [
      "winlogbeat-*"
    ],
    "interval": "5m",
    "rule_id": "4630d948-40d4-4cef-ac69-4002e29bc3db",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Adding Hidden File Attribute via Attrib",
    "query": "    event.action:\"Process Create (rule: ProcessCreate)\" and process.name:\"attrib.exe\" and process.args:\"+h\"",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Windows"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0005",
          "name": "Defense Evasion",
          "reference": "https://attack.mitre.org/tactics/TA0005/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0003",
          "name": "Persistence",
          "reference": "https://attack.mitre.org/tactics/TA0003/"
        },
        "technique": [
          {
            "id": "T1158",
            "name": "Hidden Files and Directories",
            "reference": "https://attack.mitre.org/techniques/T1158/"
          }
        ]
      }
    ],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.340Z",
    "updated_at": "2020-03-05T08:16:15.368Z",
    "created_by": "elastic",
    "description": "This rule detects events that may indicate use of SMTP on TCP port 26. This\nport is commonly used by several popular mail transfer agents to deconflict\nwith the default SMTP port 25. This port has also been used by a malware family\ncalled BadPatch for command and control of Windows systems.\n",
    "enabled": false,
    "false_positives": [
      "Servers that process email traffic may cause false positives and should be excluded from this rule as this is expected behavior."
    ],
    "from": "now-6m",
    "id": "b1405251-9609-4265-9d07-90d14f22e9f0",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "d7e62693-aab9-4f66-a21a-3d79ecdd603d",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "SMTP on Port 26/TCP",
    "query": "network.transport: tcp and destination.port: 26\n",
    "references": [
      "https://unit42.paloaltonetworks.com/unit42-badpatch/",
      "https://isc.sans.edu/forums/diary/Next+up+whats+up+with+TCP+port+26/25564/"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0010",
          "name": "Exfiltration",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol",
            "reference": "https://attack.mitre.org/techniques/T1048/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.342Z",
    "updated_at": "2020-03-05T08:16:15.375Z",
    "created_by": "elastic",
    "description": "A Socat process is running on a Linux host. Socat is often used as a persistence mechanism by exporting a reverse shell, or by serving a shell on a listening port. Socat is also sometimes used for lateral movement.",
    "enabled": false,
    "false_positives": [
      "Socat is a dual-use tool that can be used for benign or malicious activity. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. Usage by web servers is more likely  to be suspicious."
    ],
    "from": "now-6m",
    "id": "81a8cafd-bbfa-4a92-b019-ff4a0b08c55d",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "cd4d5754-07e1-41d4-b9a5-ef4ea6a0a126",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Socat Process Activity",
    "query": "process.name:socat and not process.args:\"-V\" and event.action:executed",
    "references": [
      "https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat"
    ],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.340Z",
    "updated_at": "2020-03-05T08:16:15.376Z",
    "created_by": "elastic",
    "description": "TCP Port 8000 is commonly used for development environments of web server\nsoftware. It generally should not be exposed directly to the Internet. If you are\nrunning software like this on the Internet, you should consider placing it behind\na reverse proxy.\n",
    "enabled": false,
    "false_positives": [
      "Because this port is in the ephemeral range, this rule may false under certain conditions, such as when a NATed web server replies to a client which has used a port in the range by coincidence. In this case, such servers can be excluded. Some applications may use this port but this is very uncommon and usually appears in local traffic using private IPs, which this rule does not match. Some cloud environments, particularly development environments, may use this port when VPNs or direct connects are not in use and cloud instances are accessed across the Internet."
    ],
    "from": "now-6m",
    "id": "4026f887-8dd7-421d-a3b4-1776d88fac9a",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "08d5d7e2-740f-44d8-aeda-e41f4263efaf",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "TCP Port 8000 Activity to the Internet",
    "query": "network.transport: tcp and destination.port: 8000 and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.341Z",
    "updated_at": "2020-03-05T08:16:15.377Z",
    "created_by": "elastic",
    "description": "This rule detects network events that may indicate the use of Tor traffic\nto the Internet. Tor is a network protocol that sends traffic through a\nseries of encrypted tunnels used to conceal a user's location and usage.\nTor may be used by threat actors as an alternate communication pathway to\nconceal the actor's identity and avoid detection.\n",
    "enabled": false,
    "false_positives": [
      "Tor client activity is uncommon in managed enterprise networks but may be common\n    in unmanaged or public networks where few security policies apply. Because these ports\n    are in the ephemeral range, this rule may false under certain conditions such as when a\n    NATed web server replies to a client which has used one of these ports by coincidence.\n    In this case, such servers can be excluded if desired."
    ],
    "from": "now-6m",
    "id": "cbebc8fa-0095-4c20-9cff-a74486182578",
    "immutable": true,
    "index": [
      "filebeat-*"
    ],
    "interval": "5m",
    "rule_id": "7d2c38d7-ede7-4bdf-b140-445906e6c540",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Tor Activity to the Internet",
    "query": "network.transport: tcp and destination.port: (9001 or 9030) and (\n    network.direction: outbound or (\n        source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and\n        not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)\n    )\n)\n",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Network"
    ],
    "to": "now",
    "type": "query",
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1043",
            "name": "Commonly Used Port",
            "reference": "https://attack.mitre.org/techniques/T1043/"
          }
        ]
      },
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0011",
          "name": "Command and Control",
          "reference": "https://attack.mitre.org/tactics/TA0011/"
        },
        "technique": [
          {
            "id": "T1188",
            "name": "Multi-hop Proxy",
            "reference": "https://attack.mitre.org/techniques/T1188/"
          }
        ]
      }
    ],
    "version": 2
  },
  {
    "created_at": "2020-03-05T08:16:15.338Z",
    "updated_at": "2020-03-05T08:16:15.380Z",
    "created_by": "elastic",
    "description": "Strace runs in a privileged context and can be used to escape restrictive environments by instantiating a shell in order to elevate privileges or move laterally.",
    "enabled": false,
    "false_positives": [
      "Strace is a dual-use tool that can be used for benign or malicious activity. Some normal use of this command may originate from developers or SREs engaged in debugging or system call tracing."
    ],
    "from": "now-6m",
    "id": "9537d3f5-604c-43a9-b85f-0292fa74a852",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "d6450d4e-81c6-46a3-bd94-079886318ed5",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 21,
    "name": "Strace Process Activity",
    "query": "process.name: strace and event.action:executed",
    "references": [
      "https://en.wikipedia.org/wiki/Strace"
    ],
    "severity": "low",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  },
  {
    "created_at": "2020-03-05T08:16:15.122Z",
    "updated_at": "2020-03-05T08:16:15.171Z",
    "created_by": "elastic",
    "description": "Identifies processes running in a temporary folder. This is sometimes done by adversaries to hide malware.",
    "enabled": false,
    "false_positives": [
      "Build systems, like Jenkins, may start processes in the `/tmp` directory. These  can be exempted by name or by username."
    ],
    "from": "now-6m",
    "id": "df10cf93-0de4-49f5-b0a8-60fee44322e3",
    "immutable": true,
    "index": [
      "auditbeat-*"
    ],
    "interval": "5m",
    "rule_id": "df959768-b0c9-4d45-988c-5606a2be8e5a",
    "language": "kuery",
    "output_index": ".siem-signals-default",
    "max_signals": 100,
    "risk_score": 47,
    "name": "Unusual Process Execution - Temp",
    "query": "process.working_directory: /tmp and event.action:executed",
    "references": [],
    "severity": "medium",
    "updated_by": "elastic",
    "tags": [
      "Elastic",
      "Linux"
    ],
    "to": "now",
    "type": "query",
    "threat": [],
    "version": 1
  }
]