---
id: enSecurityDetectionsPermissionsSection
slug: /en/security/detections-permissions-section
title: Detections prerequisites and requirements
description: Description to be written
tags: []
---

<div id="detections-permissions-section"></div>

To use the <DocLink id="enSecurityDetectionEngineOverview">Detections feature</DocLink>, you first need to
configure a few settings. You also need the [appropriate license](https://www.elastic.co/subscriptions) to send
<DocLink id="enSecurityRulesUiCreate" section="set-up-alert-notifications-optional">notifications</DocLink> when detection alerts are generated.

<DocCallOut title="Important" color="warning">
Several steps are **only** required for **self-managed** ((stack))
deployments. If you're using an Elastic Cloud deployment, you only need to
<DocLink id="enSecurityDetectionsPermissionsSection" section="enable-and-access-detections">enable detections</DocLink>.
</DocCallOut>

Additionally, there are some <DocLink id="enSecurityDetectionsPermissionsSection" section="configure-list-upload-limits">advanced settings</DocLink> used to
configure ((kib)) <DocLink id="enSecurityValueListsExceptions">value list</DocLink> upload limits.

<div id="detections-on-prem-requirements"></div>

## Configure self-managed ((stack)) deployments

These steps are only required for **self-managed** deployments:

* HTTPS must be configured for communication between
    [((es)) and ((kib))](((kibana-ref))/configuring-tls.html#configuring-tls-kib-es).

* In the `elasticsearch.yml` configuration file, set the
    `xpack.security.enabled` setting to `true`. For more information, refer to
    [Configuring ((es))](((ref))/settings.html) and
    [Security settings in ((es))](((ref))/security-settings.html).

* In the `kibana.yml` [configuration file](((kibana-ref))/settings.html), add the
    `xpack.encryptedSavedObjects.encryptionKey` setting with any alphanumeric value
    of at least 32 characters. For example:

    `xpack.encryptedSavedObjects.encryptionKey: 'fhjskloppd678ehkdfdlliverpoolfcr'`

<DocCallOut title="Important" color="warning">
After changing the `xpack.encryptedSavedObjects.encryptionKey` value
and restarting ((kib)), you must restart all detection rules.
</DocCallOut>

<div id="enable-detections-ui"></div>

## Enable and access detections
To use the Detections feature, it must be enabled and your role must have access to rules and alerts. If your role does not have the cluster and index privileges needed to enable this feature, you can request someone who has these privileges to visit your Kibana space, which will turn it on for you. The following table describes the required privileges to access the Detections page, including rules and alerts.

<DocCallOut title="Note">
For instructions about using Machine Learning jobs and rules, refer to <DocLink id="enSecurityMlRequirements">Machine learning job and rule requirements</DocLink>.
</DocCallOut>

<DocCallOut title="Important" color="warning">
In ((stack)) version 8.0.0, the `.siem-signals-<space-id>` index was renamed to `.alerts-security.alerts-<space-id>`. Detection alert indices are created for each ((kib)) space. For the default space, the alerts index is
named `.alerts-security.alerts-default`. If you're upgrading to 8.0.0 or later, users should have privileges for the `.alerts-security.alerts-<space-id>` AND `.siem-signals-<space-id>` indices. If you're newly installing the ((stack)), then users do not need privileges for the `.siem-signals-<space-id>` index.
</DocCallOut>

<DocTable columns={[
  {
    "title": "Action",
    "width": "25%"
  },
  {
    "title": "Cluster Privileges",
    "width": "25%"
  },
  {
    "title": "Index Privileges",
    "width": "25%"
  },
  {
    "title": "Kibana Privileges",
    "width": "25%"
  }
]}>
  <DocRow>
    <DocCell>
      Enable the Detections feature in your Kibana space
      
    </DocCell>
    <DocCell>
      The `manage` privilege
      
    </DocCell>
    <DocCell>
      The `manage`, `write`,`read`, and `view_index_metadata` index privileges for the following system indices, where `<space-id>` is the ((kib)) space name:
      
      * `.alerts-security.alerts-<space-id>`
      * `.siem-signals-<space-id>` <sup>1</sup>
      * `.lists-<space-id>`
      * `.items-<space-id>`

      
      <sup>1</sup> **NOTE**: If you're upgrading to ((stack)) 8.0.0 or later, users should have privileges for the `.alerts-security.alerts-<space-id>` AND `.siem-signals-<space-id>` indices. If you're newly installing the ((stack)), then users do not need privileges for the `.siem-signals-<space-id>` index.
      
    </DocCell>
    <DocCell>
      ((kib)) space `All` privileges for the `Security` feature (refer to
      [Feature access based on user privileges](((kibana-ref))/xpack-spaces.html#spaces-control-user-access))
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>
      Enable the Detections feature in all Kibana spaces
      
      **NOTE**: To turn on the Detections feature, visit the Detections page for each appropriate Kibana space.
      
    </DocCell>
    <DocCell>
      The `manage` privilege
      
    </DocCell>
    <DocCell>
      The `manage`, `write`,`read`, and `view_index_metadata` index privileges for the following system indices:
      
      * `.alerts-security.alerts-<space-id>`
      * `.siem-signals-<space-id>` <sup>1</sup>
      * `.lists-<space-id>`
      * `.items-<space-id>`
      
      <sup>1</sup> **NOTE**: If you're upgrading to ((stack)) 8.0.0 or later, users should have privileges for the `.alerts-security.alerts-<space-id>` AND `.siem-signals-<space-id>` indices. If you're newly installing the ((stack)), then users do not need privileges for the `.siem-signals-<space-id>` index.
      
    </DocCell>
    <DocCell>
      ((kib)) space `All` privileges for the `Security` feature (refer to
      [Feature access based on user privileges](((kibana-ref))/xpack-spaces.html#spaces-control-user-access))
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>
      Preview rules
      
    </DocCell>
    <DocCell>
      N/A
      
    </DocCell>
    <DocCell>
      The `read` privilege for the following indices:
      
      * `.preview.alerts-security.alerts-<space-id>`
      * `.internal.preview.alerts-security.alerts-<space-id>-*`

      
      
    </DocCell>
    <DocCell>
      ((kib)) space `All` privileges for the `Security` feature (refer to
      [Feature access based on user privileges](((kibana-ref))/xpack-spaces.html#spaces-control-user-access))
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>
      Manage rules
      
    </DocCell>
    <DocCell>
      N/A
      
    </DocCell>
    <DocCell>
      The `manage`, `write`,`read`, and `view_index_metadata` index privileges for the following system indices, where `<space-id>` is the ((kib)) space name:
      
      * `.alerts-security.alerts-<space-id`
      * `.siem-signals-<space-id>`<sup>1</sup>
      * `.lists-<space-id>`
      * `.items-<space-id>`

      
      <sup>1</sup> **NOTE**: If you're upgrading to ((stack)) 8.0.0 or later, users should have privileges for the `.alerts-security.alerts-<space-id>` AND `.siem-signals-<space-id>` indices. If you're newly installing the ((stack)), then users do not need privileges for the `.siem-signals-<space-id>` index.
      
    </DocCell>
    <DocCell>
      ((kib)) space `All` privileges for the `Security` feature (refer to
      [Feature access based on user privileges](((kibana-ref))/xpack-spaces.html#spaces-control-user-access))
      
      **NOTE:** You need additional `Action and Connectors` feature privileges (**Management â†’ Action and Connectors**) to manage rules with actions and connectors:
      
      * To provide full access to rule actions and connectors, give your role `All` privileges. With `Read` privileges, you can edit rule actions, but will have limited capabilities to manage connectors. For example, `Read` privileges allow you to add or remove an existing connector from a rule, but does not allow you to create a new connector.

      
      * To import rules with actions, you need at least `Read` privileges for the `Action and Connectors` feature. To overwrite or add new connectors, you need `All` privileges for the `Actions and Connectors` feature. To import rules without actions,  you don't need `Actions and Connectors` privileges. 

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>
      Manage alerts
      
      **NOTE**: Allows you to manage alerts, but not modify rules.
      
    </DocCell>
    <DocCell>
      N/A
      
    </DocCell>
    <DocCell>
      The `maintenance`, `write`,`read`, and `view_index_metadata` index privileges for the following system indices, where `<space-id>` is the ((kib)) space name:
      
      * `.alerts-security.alerts-<space-id>`
      * `.internal.alerts-security.alerts-<space-id>-*`
      * `.siem-signals-<space-id>`<sup>1</sup>
      * `.lists-<space-id>`
      * `.items-<space-id>`

      
      <sup>1</sup> **NOTE**: If you're upgrading to ((stack)) 8.0.0 or later, users should have privileges for the `.alerts-security.alerts-<space-id>` AND `.siem-signals-<space-id>` indices. If you're newly installing the ((stack)), then users do not need privileges for the `.siem-signals-<space-id>` index.
      
    </DocCell>
    <DocCell>
      ((kib)) space `Read` privileges for the `Security` feature (refer to
      [Feature access based on user privileges](((kibana-ref))/xpack-spaces.html#spaces-control-user-access))
      
      
    </DocCell>
  </DocRow>
</DocTable>

Here is an example of a user who has the Detections feature enabled in all ((kib)) spaces:

![Shows user with the Detections feature enabled in all Kibana spaces](../images/detections-permissions-section/-getting-started-sec-admin-user.png)

<div id="alerting-auth-model"></div>

### Authorization

Rules, including all background detection and the actions they generate, are authorized using an [API key](((kibana-ref))/api-keys.html) associated with the last user to edit the rule. Upon creating or modifying a rule, an API key is generated for that user, capturing a snapshot of their privileges. The API key is then used to run all background tasks associated with the rule including detection checks and executing actions.

<DocCallOut title="Important" color="warning">

If a rule requires certain privileges to run, such as index privileges, keep in mind that if a user without those privileges updates the rule, the rule will no longer function.

</DocCallOut>

<div id="adv-list-settings"></div>

## Configure list upload limits

You can set limits to the number of bytes and the buffer size used to upload
<DocLink id="enSecurityValueListsExceptions">value lists</DocLink> to ((elastic-sec)).

To set the value:

1. Open `kibana.yml` [configuration file](((kibana-ref))/settings.html) or edit your
    ((kib)) cloud instance.

1. Add any of these settings and their required values:
* `xpack.lists.maxImportPayloadBytes`: Sets the number of bytes allowed for
    uploading ((elastic-sec)) value lists (default `9000000`, maximum
    `100000000`). For every 10 megabytes, it is recommended to have an additional 1
    gigabyte of RAM reserved for Kibana.

    For example, on a Kibana instance with 2 gigabytes of RAM, you can set this value up
    to 20000000 (20 megabytes).

* `xpack.lists.importBufferSize`: Sets the buffer size used for uploading
    ((elastic-sec)) value lists (default `1000`). Change the value if you're
    experiencing slow upload speeds or larger than wanted memory usage when
    uploading value lists. Set to a higher value to increase throughput at the
    expense of using more Kibana memory, or a lower value to decrease throughput and
    reduce memory usage.

<DocCallOut title="Note">
For information on how to configure Elastic Cloud deployments, refer to
[Add Kibana user settings](((cloud))/ec-manage-kibana-settings.html).
</DocCallOut>

